(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4844fb08"],{"0417":function(t,e,i){"use strict";var r=i("c2d3"),o=i("35a7"),n=i("3900"),s=i("480c"),a=i("3e6b"),c=i("97e6"),h=i("c810"),l=i("4787"),u=i("0af5"),p=i("6f9e"),d=function(t){t=t||{};var e,i=this;this.dcount=0,this.show_progress=t.show_progress,this.oninfo="function"==typeof t.oninfo?t.oninfo:null,this.onextent="function"==typeof t.onextent?t.onextent:null,this.hasextent=t.extent||t.onextent,this.hastrash=t.trash,this.reordering=!1!==t.reordering,this._layers=[],this._layerGroup=t.layerGroup&&t.layerGroup.getLayers?t.layerGroup:null,"function"===typeof t.displayInLayerSwitcher&&(this.displayInLayerSwitcher=t.displayInLayerSwitcher),t.target?e=p["a"].create("DIV",{className:t.switcherClass||"ol-layerswitcher"}):(e=p["a"].create("DIV",{className:(t.switcherClass||"ol-layerswitcher")+" ol-unselectable ol-control"}),!1!==t.collapsed?e.classList.add("ol-collapsed"):e.classList.add("ol-forceopen"),this.button=p["a"].create("BUTTON",{type:"button",parent:e}),this.button.addEventListener("touchstart",(function(t){e.classList.toggle("ol-collapsed"),i.dispatchEvent({type:"toggle",collapsed:e.classList.contains("ol-collapsed")}),t.preventDefault(),i.overflow()})),this.button.addEventListener("click",(function(){e.classList.toggle("ol-forceopen"),e.classList.add("ol-collapsed"),i.dispatchEvent({type:"toggle",collapsed:!e.classList.contains("ol-forceopen")}),i.overflow()})),t.mouseover&&(e.addEventListener("mouseleave",(function(){e.classList.add("ol-collapsed"),i.dispatchEvent({type:"toggle",collapsed:!0})})),e.addEventListener("mouseover",(function(){e.classList.remove("ol-collapsed"),i.dispatchEvent({type:"toggle",collapsed:!1})}))),t.noScroll||(this.topv=p["a"].create("DIV",{className:"ol-switchertopdiv",parent:e,click:function(){i.overflow("+50%")}}),this.botv=p["a"].create("DIV",{className:"ol-switcherbottomdiv",parent:e,click:function(){i.overflow("-50%")}})),this._noScroll=t.noScroll),this.panel_=p["a"].create("UL",{className:"panel",parent:e}),t.target||t.noScroll||p["a"].addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",(function(t){i.overflow(Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)))&&(t.stopPropagation(),t.preventDefault())})),this.header_=p["a"].create("LI",{className:"ol-header",parent:this.panel_}),n["a"].call(this,{element:e,target:t.target}),this.set("drawDelay",t.drawDelay||0),this.set("selection",t.selection)};Object(r["a"])(d,n["a"]),d.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"},d.prototype.displayInLayerSwitcher=function(t){return!1!==t.get("displayInLayerSwitcher")},d.prototype.setMap=function(t){if(n["a"].prototype.setMap.call(this,t),this.drawPanel(),this._listener)for(var e in this._listener)Object(o["b"])(this._listener[e]);this._listener=null,t&&(this._listener={moveend:t.on("moveend",this.viewChange.bind(this)),size:t.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=t.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))},d.prototype.show=function(){this.element.classList.add("ol-forceopen"),this.overflow()},d.prototype.hide=function(){this.element.classList.remove("ol-forceopen"),this.overflow()},d.prototype.toggle=function(){this.element.classList.toggle("ol-forceopen"),this.overflow()},d.prototype.isOpen=function(){return this.element.classList.contains("ol-forceopen")},d.prototype.setHeader=function(t){p["a"].setHTML(this.header_,t)},d.prototype.overflow=function(t){if(this.button&&!this._noScroll){if(p["a"].hidden(this.panel_))return void p["a"].setStyle(this.element,{height:"auto"});var e=p["a"].outerHeight(this.element),i=p["a"].outerHeight(this.panel_),r=this.button.offsetTop+p["a"].outerHeight(this.button),o=this.panel_.offsetTop-r;if(i>e-r){p["a"].setStyle(this.element,{height:"100%"});var n=2*p["a"].getStyle(this.panel_.querySelectorAll("li.visible .li-content")[0],"height");switch(t){case 1:o+=n;break;case-1:o-=n;break;case"+50%":o+=Math.round(e/2);break;case"-50%":o-=Math.round(e/2);break;default:break}return o+i<=e-3*r/2?(o=e-3*r/2-i,p["a"].hide(this.botv)):p["a"].show(this.botv),o>=0?(o=0,p["a"].hide(this.topv)):p["a"].show(this.topv),p["a"].setStyle(this.panel_,{top:o+"px"}),!0}return p["a"].setStyle(this.element,{height:"auto"}),p["a"].setStyle(this.panel_,{top:0}),p["a"].hide(this.botv),p["a"].hide(this.topv),!1}return!1},d.prototype._setLayerForLI=function(t,e){var i=[];e.getLayers&&i.push(e.getLayers().on("change:length",this.drawPanel.bind(this))),t&&(i.push(e.on("change:opacity",function(){this.setLayerOpacity(e,t)}.bind(this))),i.push(e.on("change:visible",function(){this.setLayerVisibility(e,t)}.bind(this)))),i.push(e.on("propertychange",function(t){"displayInLayerSwitcher"!==t.key&&"openInLayerSwitcher"!==t.key||this.drawPanel(t)}.bind(this))),this._layers.push({li:t,layer:e,listeners:i})},d.prototype.setLayerOpacity=function(t,e){var i=e.querySelector(".layerswitcher-opacity-cursor");i&&(i.style.left=100*t.getOpacity()+"%"),this.dispatchEvent({type:"layer:opacity",layer:t})},d.prototype.setLayerVisibility=function(t,e){var i=e.querySelector(".ol-visibility");i&&(i.checked=t.getVisible()),t.getVisible()?e.classList.add("ol-visible"):e.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:t})},d.prototype._clearLayerForLI=function(){this._layers.forEach((function(t){t.listeners.forEach((function(t){Object(o["b"])(t)}))})),this._layers=[]},d.prototype._getLayerForLI=function(t){for(var e,i=0;e=this._layers[i];i++)if(e.li===t)return e.layer;return null},d.prototype.viewChange=function(){this.panel_.querySelectorAll("li").forEach(function(t){var e=this._getLayerForLI(t);e&&(this.testLayerVisibility(e)?t.classList.remove("ol-layer-hidden"):t.classList.add("ol-layer-hidden"))}.bind(this))},d.prototype.getPanel=function(){return this.panel_},d.prototype.drawPanel=function(){if(this.getMap()){var t=this;this.dcount++,setTimeout((function(){t.drawPanel_()}),this.get("drawDelay")||0)}},d.prototype.drawPanel_=function(){--this.dcount||this.dragging_||(this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach(function(t){t.classList.contains("ol-header")||t.remove()}.bind(this)),this.drawList(this.panel_,this._layerGroup?this._layerGroup.getLayers():this.getMap().getLayers()))},d.prototype.switchLayerVisibility=function(t,e){t.get("baseLayer")?(t.getVisible()||t.setVisible(!0),e.forEach((function(e){t!==e&&e.get("baseLayer")&&e.getVisible()&&e.setVisible(!1)}))):t.setVisible(!t.getVisible())},d.prototype.testLayerVisibility=function(t){if(!this.getMap())return!0;var e=this.getMap().getView().getResolution(),i=this.getMap().getView().getZoom();if(t.getMaxResolution()<=e||t.getMinResolution()>=e)return!1;if(t.getMinZoom&&(t.getMinZoom()>=i||t.getMaxZoom()<i))return!1;var r=t.getExtent();if(r){var o=this.getMap().getView().calculateExtent(this.getMap().getSize());return Object(u["E"])(o,r)}return!0},d.prototype.dragOrdering_=function(t){t.stopPropagation(),t.preventDefault();var e,i,r,o,n,s=this,a=t.currentTarget.parentNode.parentNode,c=!0,h=this.panel_,l=t.pageY||t.touches&&t.touches.length&&t.touches[0].pageY||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageY;function u(){if(i){var t=o;if(t&&i){var e;e=n?n.getLayers():s._layerGroup?s._layerGroup.getLayers():s.getMap().getLayers();for(var c=e.getArray(),h=0;h<c.length;h++)if(c[h]==t){e.removeAt(h);break}for(var l=0;l<c.length;l++)if(c[l]==i){h>l?e.insertAt(l,t):e.insertAt(l+1,t);break}}s.dispatchEvent({type:"reorder-end",layer:t,group:n})}a.parentNode.querySelectorAll("li").forEach((function(t){t.classList.remove("dropover"),t.classList.remove("dropover-after"),t.classList.remove("dropover-before")})),a.classList.remove("drag"),a.parentNode.classList.remove("drag"),s.element.classList.remove("drag"),r&&r.remove(),p["a"].removeListener(document,"mousemove touchmove",d),p["a"].removeListener(document,"mouseup touchend touchcancel",u)}function d(t){if(e=t.pageY||t.touches&&t.touches.length&&t.touches[0].pageY||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageY,c&&Math.abs(l-e)>2&&(c=!1,a.classList.add("drag"),o=s._getLayerForLI(a),i=!1,n=s._getLayerForLI(a.parentNode.parentNode),r=p["a"].create("LI",{className:"ol-dragover",html:a.innerHTML,style:{position:"absolute","z-index":1e4,left:a.offsetLeft,opacity:.5,width:p["a"].outerWidth(a),height:p["a"].getStyle(a,"height")},parent:h}),s.element.classList.add("drag"),s.dispatchEvent({type:"reorder-start",layer:o,group:n})),!c){var u;t.preventDefault(),t.stopPropagation(),p["a"].setStyle(r,{top:e-p["a"].offsetRect(h).top+h.scrollTop+5}),u=t.touches?document.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY):t.target,u.classList.contains("ol-switcherbottomdiv")?s.overflow(-1):u.classList.contains("ol-switchertopdiv")&&s.overflow(1);while(u&&"LI"!==u.tagName)u=u.parentNode;u&&u.classList.contains("dropover")||a.parentNode.querySelectorAll("li").forEach((function(t){t.classList.remove("dropover"),t.classList.remove("dropover-after"),t.classList.remove("dropover-before")})),u&&u.parentNode.classList.contains("drag")&&u!==a?(i=s._getLayerForLI(u),i&&!i.get("allwaysOnTop")==!o.get("allwaysOnTop")?(u.classList.add("dropover"),u.classList.add(a.offsetTop<u.offsetTop?"dropover-after":"dropover-before")):i=!1,p["a"].show(r)):(i=!1,u===a?p["a"].hide(r):p["a"].show(r)),i?r.classList.remove("forbidden"):r.classList.add("forbidden")}}a.parentNode.classList.add("drag"),p["a"].addListener(document,"mousemove touchmove",d),p["a"].addListener(document,"mouseup touchend touchcancel",u)},d.prototype.dragOpacity_=function(t){t.stopPropagation(),t.preventDefault();var e=this,i=t.target,r=this._getLayerForLI(i.parentNode.parentNode.parentNode);if(r){var o=t.pageX||t.touches&&t.touches.length&&t.touches[0].pageX||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageX,n=p["a"].getStyle(i,"left")-o;e.dragging_=!0,p["a"].addListener(document,"mouseup touchend touchcancel",s),p["a"].addListener(document,"mousemove touchmove",a)}function s(){p["a"].removeListener(document,"mouseup touchend touchcancel",s),p["a"].removeListener(document,"mousemove touchmove",a),e.dragging_=!1}function a(t){var e=t.pageX||t.touches&&t.touches.length&&t.touches[0].pageX||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageX,o=(n+e)/p["a"].getStyle(i.parentNode,"width"),s=Math.max(0,Math.min(1,o));p["a"].setStyle(i,{left:100*s+"%"}),i.parentNode.nextElementSibling.innerHTML=Math.round(100*s),r.setOpacity(s)}},d.prototype.drawList=function(t,e){var i=this,r=e.getArray(),o=function(t){t.stopPropagation(),t.preventDefault();var r=i._getLayerForLI(this.parentNode.parentNode);i.switchLayerVisibility(r,e),i.get("selection")&&r.getVisible()&&i.selectLayer(r)};function n(t){t.stopPropagation(),t.preventDefault();var e=i._getLayerForLI(this.parentNode.parentNode);i.oninfo(e),i.dispatchEvent({type:"info",layer:e})}function a(t){t.stopPropagation(),t.preventDefault();var e=i._getLayerForLI(this.parentNode.parentNode);i.onextent?i.onextent(e):i.getMap().getView().fit(e.getExtent(),i.getMap().getSize()),i.dispatchEvent({type:"extent",layer:e})}function c(t){t.stopPropagation(),t.preventDefault();var e,r=this.parentNode.parentNode.parentNode.parentNode,o=i._getLayerForLI(r);o?(e=i._getLayerForLI(this.parentNode.parentNode),o.getLayers().remove(e),0!=o.getLayers().getLength()||o.get("noSwitcherDelete")||c.call(r.querySelectorAll(".layerTrash")[0],t)):(r=this.parentNode.parentNode,i.getMap().removeLayer(i._getLayerForLI(r)))}function h(e){if(this.displayInLayerSwitcher(e)){var h=p["a"].create("LI",{className:(e.getVisible()?"visible ":" ")+(e.get("baseLayer")?"baselayer":""),parent:t});this._setLayerForLI(h,e),this._selectedLayer===e&&h.classList.add("ol-layer-select");var u=p["a"].create("DIV",{className:"ol-layerswitcher-buttons",parent:h}),d=p["a"].create("DIV",{className:"li-content",parent:h});p["a"].create("INPUT",{type:e.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:e.getVisible(),click:o,parent:d});var f=p["a"].create("LABEL",{title:e.get("title")||e.get("name"),click:o,unselectable:"on",style:{userSelect:"none"},parent:d});if(f.addEventListener("selectstart",(function(){return!1})),p["a"].create("SPAN",{html:e.get("title")||e.get("name"),click:function(t){this.get("selection")&&(t.stopPropagation(),this.selectLayer(e))}.bind(this),parent:f}),this.reordering&&(l<r.length-1&&(e.get("allwaysOnTop")||!r[l+1].get("allwaysOnTop"))||l>0&&(!e.get("allwaysOnTop")||r[l-1].get("allwaysOnTop")))&&p["a"].create("DIV",{className:"layerup",title:this.tip.up,on:{"mousedown touchstart":function(t){i.dragOrdering_(t)}},parent:u}),e.getLayers){var g=0;e.getLayers().forEach((function(t){i.displayInLayerSwitcher(t)&&g++})),g&&p["a"].create("DIV",{className:e.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var t=i._getLayerForLI(this.parentNode.parentNode);t.set("openInLayerSwitcher",!t.get("openInLayerSwitcher"))},parent:u})}if(this.oninfo&&p["a"].create("DIV",{className:"layerInfo",title:this.tip.info,click:n,parent:u}),this.hastrash&&!e.get("noSwitcherDelete")&&p["a"].create("DIV",{className:"layerTrash",title:this.tip.trash,click:c,parent:u}),this.hasextent&&r[l].getExtent()){var y=r[l].getExtent();4==y.length&&y[0]<y[2]&&y[1]<y[3]&&p["a"].create("DIV",{className:"layerExtent",title:this.tip.extent,click:a,parent:u})}if(this.show_progress&&e instanceof s["a"]){var _=p["a"].create("DIV",{className:"layerswitcher-progress",parent:d});this.setprogress_(e),e.layerswitcher_progress=p["a"].create("DIV",{parent:_})}var v=p["a"].create("DIV",{className:"layerswitcher-opacity",click:function(t){if(t.target===this){t.stopPropagation(),t.preventDefault();var e=Math.max(0,Math.min(1,t.offsetX/p["a"].getStyle(this,"width")));i._getLayerForLI(this.parentNode.parentNode).setOpacity(e)}},parent:d});if(p["a"].create("DIV",{className:"layerswitcher-opacity-cursor",style:{left:100*e.getOpacity()+"%"},on:{"mousedown touchstart":function(t){i.dragOpacity_(t)}},parent:v}),p["a"].create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(100*e.getOpacity()),parent:d}),e.getLayers&&(h.classList.add("ol-layer-group"),!0===e.get("openInLayerSwitcher"))){var m=p["a"].create("UL",{parent:h});this.drawList(m,e.getLayers())}h.classList.add(this.getLayerClass(e)),this.dispatchEvent({type:"drawlist",layer:e,li:h})}else this._setLayerForLI(null,e)}for(var l=r.length-1;l>=0;l--)h.call(this,r[l]);this.viewChange(),t===this.panel_&&this.overflow()},d.prototype.getLayerClass=function(t){return t?t.getLayers?"ol-layer-group":t instanceof a["a"]?"ol-layer-vector":t instanceof c["a"]?"ol-layer-vectortile":t instanceof s["a"]?"ol-layer-tile":t instanceof h["a"]?"ol-layer-image":t instanceof l["a"]?"ol-layer-heatmap":t.getFeatures?"ol-layer-vectorimage":"unknown":"none"},d.prototype.selectLayer=function(t,e){if(!t){if(!this.getMap())return;t=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=t,this.drawPanel(),e||this.dispatchEvent({type:"select",layer:t})},d.prototype.getSelection=function(){return this._selectedLayer},d.prototype.setprogress_=function(t){if(!t.layerswitcher_progress){var e=0,i=0,r=function(){i===e?(i=e=0,p["a"].setStyle(t.layerswitcher_progress,{width:0})):p["a"].setStyle(t.layerswitcher_progress,{width:(e/i*100).toFixed(1)+"%"})};t.getSource().on("tileloadstart",(function(){i++,r()})),t.getSource().on("tileloadend",(function(){e++,r()})),t.getSource().on("tileloaderror",(function(){e++,r()}))}},e["a"]=d},1399:function(t,e,i){},"159a":function(t,e,i){},"183a":function(t,e,i){"use strict";e["a"]={ADD:"add",REMOVE:"remove"}},"4cdf":function(t,e,i){"use strict";var r=i("e269"),o=i("01d4"),n=i("92fa"),s=i("1e8d"),a=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),c=function(t){function e(e){var i=t.call(this)||this;if(i.on,i.once,i.un,i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addChangeListener(i.geometryName_,i.handleGeometryChanged_),e)if("function"===typeof e.getSimplifiedGeometry){var r=e;i.setGeometry(r)}else{var o=e;i.setProperties(o)}return i}return a(e,t),e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Object(s["c"])(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Object(s["a"])(t,o["a"].CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?h(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(r["a"]);function h(t){if("function"===typeof t)return t;var e;if(Array.isArray(t))e=t;else{Object(n["a"])("function"===typeof t.getZIndex,41);var i=t;e=[i]}return function(){return e}}e["a"]=c},"6f9e":function(t,e,i){"use strict";var r=i("c2d3"),o=i("e269");window.ol&&(ol.ext.input={});var n=function(t){t=t||{},o["a"].call(this);var e=this.input=t.input||f.create("INPUT",{type:t.type,min:t.min,max:t.max,step:t.step,parent:t.parent});t.disabled&&(e.disabled=!0),void 0!==t.checked&&(e.checked=!!t.checked),void 0!==t.val&&(e.value=t.val)};Object(r["a"])(n,o["a"]),n.prototype._listenDrag=function(t,e){var i=function(i){this.moving=!0;var r=function(i){"pointerup"===i.type&&(document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",r),document.removeEventListener("pointercancel",r),setTimeout(function(){this.moving=!1}.bind(this))),i.target===t&&e(i),i.stopPropagation(),i.preventDefault()}.bind(this);document.addEventListener("pointermove",r,!1),document.addEventListener("pointerup",r,!1),document.addEventListener("pointercancel",r,!1),i.stopPropagation(),i.preventDefault()}.bind(this);t.addEventListener("mousedown",i,!1),t.addEventListener("touchstart",i,!1)},n.prototype.setValue=function(t){void 0!==t&&(this.input.value=t),this.input.dispatchEvent(new Event("change"))},n.prototype.getValue=function(){return this.input.value},n.prototype.getInputElement=function(){return this.input};var s=n,a=function(t){t=t||{},s.call(this,t);var e=this.element=f.create("LABEL",{html:t.html,className:("ol-ext-check ol-ext-checkbox"+(t.className||"")).trim()});this.input.parentNode&&this.input.parentNode.insertBefore(e,this.input),e.appendChild(this.input),f.create("SPAN",{parent:e}),t.after&&e.appendChild(document.createTextNode(t.after)),this.input.addEventListener("change",function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}.bind(this))};Object(r["a"])(a,s),a.prototype.isChecked=function(){return this.input.checked};var c=a,h=function(t){t=t||{},c.call(this,t),this.element.className=("ol-ext-toggle-switch "+(t.className||"")).trim()};Object(r["a"])(h,c);var l=h,u=function(t,e){e=e||{},c.call(this,t,e),this.element.className=("ol-ext-check ol-ext-radio"+(e.className||"")).trim()};Object(r["a"])(u,c);var p=u,d={create:function(t,e){var i;if(e=e||{},"TEXT"===t)i=document.createTextNode(e.html||""),e.parent&&e.parent.appendChild(i);else for(var r in i=document.createElement(t),/button/i.test(t)&&i.setAttribute("type","button"),e)switch(r){case"className":e.className&&e.className.trim&&i.setAttribute("class",e.className.trim());break;case"html":e.html instanceof Element?i.appendChild(e.html):void 0!==e.html&&(i.innerHTML=e.html);break;case"parent":e.parent&&e.parent.appendChild(i);break;case"options":if(console.log("options",e.options),/select/i.test(t))for(var o in e.options)d.create("OPTION",{html:o,value:e.options[o],parent:i});break;case"style":this.setStyle(i,e.style);break;case"change":case"click":d.addListener(i,r,e[r]);break;case"on":for(var n in e.on)d.addListener(i,n,e.on[n]);break;case"checked":i.checked=!!e.checked;break;default:i.setAttribute(r,e[r]);break}return i},createSwitch:function(t){var e=d.create("INPUT",{type:"checkbox",on:t.on,parent:t.parent}),i=Object.assign({input:e},t||{});return new l(i),e},createCheck:function(t){var e=d.create("INPUT",{name:t.name,type:"radio"===t.type?"radio":"checkbox",on:t.on,parent:t.parent});console.log(e);var i=Object.assign({input:e},t||{});return"radio"===t.type?new p(i):new c(i),e},setHTML:function(t,e){e instanceof Element?t.appendChild(e):void 0!==e&&(t.innerHTML=e)},appendText:function(t,e){t.appendChild(document.createTextNode(e||""))},addListener:function(t,e,i,r){"string"===typeof e&&(e=e.split(" ")),e.forEach((function(e){t.addEventListener(e,i,r)}))},removeListener:function(t,e,i){"string"===typeof e&&(e=e.split(" ")),e.forEach((function(e){t.removeEventListener(e,i)}))},show:function(t){t.style.display=""},hide:function(t){t.style.display="none"},hidden:function(t){return"none"===d.getStyle(t,"display")},toggle:function(t){t.style.display="none"===t.style.display?"":"none"},setStyle:function(t,e){for(var i in e)switch(i){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":"number"===typeof e[i]?t.style[i]=e[i]+"px":t.style[i]=e[i];break;default:t.style[i]=e[i]}},getStyle:function(t,e){var i,r=(t.ownerDocument||document).defaultView;if(r&&r.getComputedStyle)e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),i=r.getComputedStyle(t,null).getPropertyValue(e);else if(t.currentStyle&&(e=e.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()})),i=t.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(i)))return function(e){var i=t.style.left,r=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft+"px",t.style.left=i,t.runtimeStyle.left=r,e}(i);return/px$/.test(i)?parseInt(i):i},outerHeight:function(t){return t.offsetHeight+d.getStyle(t,"marginBottom")},outerWidth:function(t){return t.offsetWidth+d.getStyle(t,"marginLeft")},offsetRect:function(t){var e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:e.height||e.bottom-e.top,width:e.width||e.right-e.left}},scrollDiv:function(t,e){var i,r=!1,o=0,n=0,s="function"===typeof e.onmove?e.onmove:function(){},a=e.vertical?"pageY":"pageX",c=e.vertical?"scrollTop":"scrollLeft",h=!1;t.querySelectorAll("img").forEach((function(t){t.ondragstart=function(){return!1}})),t.style["touch-action"]="none",d.addListener(t,["pointerdown"],(function(e){h=!1,r=e[a],n=new Date,t.classList.add("ol-move")})),d.addListener(window,["pointermove"],(function(e){if(h=!0,!1!==r){var l=r-e[a];t[c]+=l,i=new Date,i-n&&(o=(o+l/(i-n))/2),r=e[a],n=i,l&&s(!0)}}));var l=function(e){var i=e>0?Math.min(100,e/2):Math.max(-100,e/2);e-=i,t[c]+=i,-1<e&&e<1?(h?setTimeout((function(){t.classList.remove("ol-move")})):t.classList.remove("ol-move"),h=!1,s(!1)):setTimeout((function(){l(e)}),40)};d.addListener(window,["pointerup","pointercancel"],(function(t){n=new Date-n,n>100?o=0:n>0&&(o=((o||0)+(r-t[a])/n)/2),l(!1===e.animate?0:200*o),r=!1,o=0,n=0})),e.mousewheel&&d.addListener(t,["mousewheel","DOMMouseScroll","onmousewheel"],(function(e){var i=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));return t.classList.add("ol-move"),t[c]-=30*i,t.classList.remove("ol-move"),!1}))},dispatchEvent:function(t,e){var i;try{i=new CustomEvent(t)}catch(r){i=document.createEvent("CustomEvent"),i.initCustomEvent(t,!0,!0,{})}e.dispatchEvent(i)}},f=e["a"]=d},"835b":function(t,e,i){"use strict";var r=i("1300"),o=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),n=function(t){function e(e){var i=this,o="latest"===r["a"]?r["a"]:"v"+r["a"].split("-")[0],n="Assertion failed. See https://openlayers.org/en/"+o+"/doc/errors/#"+e+" for details.";return i=t.call(this,n)||this,i.code=e,i.name="AssertionError",i.message=n,i}return o(e,t),e}(Error);e["a"]=n},c2d3:function(t,e,i){"use strict";window.ol&&!ol.ext&&(ol.ext={});var r=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t};window.ol&&(ol.inherits||(ol.inherits=r)),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.Element&&!Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),e["a"]=r},c516:function(t,e,i){"use strict";var r=i("c2d3"),o=i("06f8"),n=i("ac29"),s=i("7a09"),a=i("5bc3"),c=i("2ce2"),h=i("f087"),l=i("e887"),u=function(t){t=t||{};var e=this;this.interaction_=t.interaction,this.interaction_&&(this.interaction_.setActive(t.active),this.interaction_.on("change:active",(function(){e.setActive(e.interaction_.getActive())}))),t.toggleFn&&(t.onToggle=t.toggleFn),t.handleClick=function(){e.toggle(),t.onToggle&&t.onToggle.call(e,e.getActive())},t.className=(t.className||"")+" ol-toggle",l["a"].call(this,t),this.set("title",t.title),this.set("autoActivate",t.autoActivate),t.bar&&this.setSubBar(t.bar),this.setActive(t.active),this.setDisable(t.disable)};Object(r["a"])(u,l["a"]),u.prototype.setMap=function(t){!t&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),l["a"].prototype.setMap.call(this,t),t&&(this.interaction_&&t.addInteraction(this.interaction_),this.subbar_&&t.addControl(this.subbar_))},u.prototype.getSubBar=function(){return this.subbar_},u.prototype.setSubBar=function(t){var e=this.getMap();e&&this.subbar_&&e.removeControl(this.subbar_),this.subbar_=t,t&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),e&&e.addControl(this.subbar_))},u.prototype.getDisable=function(){var t=this.element.querySelector("button");return t&&t.disabled},u.prototype.setDisable=function(t){this.getDisable()!=t&&(this.element.querySelector("button").disabled=t,t&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!t,disable:t}))},u.prototype.getActive=function(){return this.element.classList.contains("ol-active")},u.prototype.toggle=function(){this.getActive()?this.setActive(!1):this.setActive(!0)},u.prototype.setActive=function(t){this.interaction_&&this.interaction_.setActive(t),this.subbar_&&this.subbar_.setActive(t),this.getActive()!==t&&(t?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!t,active:t}))},u.prototype.setInteraction=function(t){this.interaction_=t},u.prototype.getInteraction=function(){return this.interaction_};var p=u,d=function(t){t=t||{},t.className=(t.className||"")+" ol-text-button",l["a"].call(this,t)};Object(r["a"])(d,l["a"]);var f=d,g=i("5831"),y=function(t){c["a"].call(this,t),this.on("select",function(t){this.getFeatures().clear(),this.delete(t.selected)}.bind(this))};Object(r["a"])(y,c["a"]),y.prototype._getSources=function(t){if(!this.getMap())return[];t||(t=this.getMap().getLayers());var e=[];return t.forEach(function(t){t.getLayers?e=e.concat(this._getSources(t.getLayers())):t.getSource&&t.getSource()instanceof g["a"]&&e.push(t.getSource())}.bind(this)),e},y.prototype.delete=function(t){if(t&&(t.length||t.getLength())){this.dispatchEvent({type:"deletestart",features:t});var e=[];this._getSources().forEach((function(i){try{t.forEach((function(t){i.removeFeature(t),e.push(t)}))}catch(r){}})),this.dispatchEvent({type:"deleteend",features:e})}};var _,v=y,m=i("6f9e"),w=i("4105"),b=i("049d"),L=(i("47e4"),i("9a440"),i("88da")),E=i("f403"),S=i("f822"),C=i("0af5"),k=function(t,e){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)},M=function(t,e){return t[0]==e[0]&&t[1]==e[1]},x=function(t,e){var i,r,o,n,s,a,c,h,l,u,p,d,f,g=[],y=t.length-1,_=y,v=M(t[0],t[y]);v||(p=t[0],d=t[1],f=[p[0]+(d[1]-p[1])/k(p,d)*e,p[1]-(d[0]-p[0])/k(p,d)*e],g.push(f),t.push(t[y]),y++,_--);for(var m=0;m<_;m++)p=t[m],d=t[(m+1)%y],f=t[(m+2)%y],i=(d[1]-p[1])/(d[0]-p[0]),r=(f[1]-d[1])/(f[0]-d[0]),Math.abs(i-r)>1e-10&&(o=Math.sqrt((d[0]-p[0])*(d[0]-p[0])+(d[1]-p[1])*(d[1]-p[1])),n=Math.sqrt((f[0]-d[0])*(f[0]-d[0])+(f[1]-d[1])*(f[1]-d[1])),s=p[0]+e*(d[1]-p[1])/o,a=d[0]+e*(f[1]-d[1])/n,c=p[1]-e*(d[0]-p[0])/o,h=d[1]-e*(f[0]-d[0])/n,l=(r*a-i*s+c-h)/(r-i),u=(i*r*(a-s)+r*c-i*h)/(r-i),d[0]-p[0]==0&&(l=d[0]+e*(d[1]-p[1])/Math.abs(d[1]-p[1]),u=r*l-r*a+h),f[0]-d[0]==0&&(l=f[0]+e*(f[1]-d[1])/Math.abs(f[1]-d[1]),u=i*l-i*s+c),g.push([l,u]));return v?g.push(g[0]):(t.pop(),p=t[t.length-1],d=t[t.length-2],f=[p[0]-(d[1]-p[1])/k(p,d)*e,p[1]+(d[0]-p[0])/k(p,d)*e],g.push(f)),g},T=function(t,e){for(var i=0;i<e.length-1;i++){var r=e[i],o=e[i+1];if(M(t,r)||M(t,o))return{index:1,segment:[r,o]};var n=k(r,o),s=[(o[0]-r[0])/n,(o[1]-r[1])/n],a=k(r,t),c=[(t[0]-r[0])/a,(t[1]-r[1])/a];if(Math.abs(s[0]*c[1]-s[1]*c[0])<1e-10)return{index:1,segment:[r,o]}}return{index:-1}};(function(){function t(t,e){var i;for(let r=t.length-1;r>0;r--)(t[r][0]>e&&t[r-1][0]<e||t[r][0]<e&&t[r-1][0]>e)&&(i=[e,(e-t[r][0])/(t[r-1][0]-t[r][0])*(t[r-1][1]-t[r][1])+t[r][1]],t.splice(r,0,i))}function e(t,e){var i;for(let r=t.length-1;r>0;r--)(t[r][1]>e&&t[r-1][1]<e||t[r][1]<e&&t[r-1][1]>e)&&(i=[(e-t[r][1])/(t[r-1][1]-t[r][1])*(t[r-1][0]-t[r][0])+t[r][0],e],t.splice(r,0,i))}_=function(i,r){var o="Polygon"===r.getType();if(!o&&"MultiPolygon"!==r.getType())return null;var n=r.getCoordinates();return o&&(n=[n]),n.forEach((function(r){r.forEach((function(r){t(r,i[0]),t(r,i[2]),e(r,i[1]),e(r,i[3])}))})),n.forEach((function(t){t.forEach((function(t){t.forEach((function(t){t[0]<i[0]?t[0]=i[0]:t[0]>i[2]&&(t[0]=i[2]),t[1]<i[1]?t[1]=i[1]:t[1]>i[3]&&(t[1]=i[3])}))}))})),o?new a["a"](n[0]):new L["a"](n)}})();var D=function(t,e,i,r){var o=[];!1!==r&&o.push(t);var n=k(t,e);if(n){var s=Math.round(n/i);if(s>1)for(var a=(e[0]-t[0])/s,c=(e[1]-t[1])/s,h=1;h<s;h++)o.push([t[0]+a*h,t[1]+c*h])}return o.push(e),o};a["a"].prototype.sampleAt=function(t){var e=this.getCoordinates(),i=[];return e.forEach((function(e){for(var r=[],o=1;o<e.length;o++)r=r.concat(D(e[o-1],e[o],t,1===o));i.push(r)})),new a["a"](i)},L["a"].prototype.sampleAt=function(t){var e=this.getCoordinates(),i=[];return e.forEach((function(e){var r=[];i.push(r),e.forEach((function(e){for(var i=[],o=1;o<e.length;o++)i=i.concat(D(e[o-1],e[o],t,1===o));r.push(i)}))})),new L["a"](i)},S["a"].prototype.intersection=function(t,e){if(t.sampleAt){var i=Object(C["c"])(this.getCenter().concat(this.getCenter()),this.getRadius());t=_(i,t),t=t.simplify(e);var r=this.getCenter(),o=this.getRadius(),n=t.sampleAt(e).getCoordinates();switch(t.getType()){case"Polygon":n=[n];case"MultiPolygon":var s=!1,c=[];return n.forEach((function(t){var e=[];c.push(e),t.forEach((function(t){var i=[];e.push(i),t.forEach((function(t){var e=k(r,t);e>o?(s=!0,i.push([r[0]+o/e*(t[0]-r[0]),r[1]+o/e*(t[1]-r[1])])):i.push(t)}))}))})),s?"Polygon"===t.getType()?new a["a"](c[0]):new L["a"](c):t}}else console.warn("[ol/geom/Circle~intersection] Unsupported geometry type: "+t.getType());return t};var A,P=i("6c77"),I=i("ce2c"),N=i("8682"),F=i("83a6");(function(){var t=[255,255,255,1],e=[0,153,255,1],i=3,r=[new P["c"]({stroke:new N["a"]({color:t,width:i+2})}),new P["c"]({image:new I["a"]({radius:2*i,fill:new F["a"]({color:e}),stroke:new N["a"]({color:t,width:i/2})}),stroke:new N["a"]({color:e,width:i}),fill:new F["a"]({color:[255,255,255,.5]})})];A=function(t){if(!0===t)return r;t=t||{};var e=new F["a"]({color:t.fillColor||"rgba(255,255,255,0.4)"}),i=new N["a"]({color:t.color||"#3399CC",width:1.25}),o=new P["c"]({image:new I["a"]({fill:e,stroke:i,radius:5}),fill:e,stroke:i});return[o]}})();var O=A,G=function(t){t||(t={}),w["b"].call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=t.features,this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this.set("duplicate",t.duplicate),this.source_=t.source,this._style="function"===typeof t.style?t.style:function(){return t.style?t.style:O(!0)},this.previousCursor_=!1};Object(r["a"])(G,w["b"]),G.prototype.setMap=function(t){w["b"].prototype.setMap.call(this,t)},G.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t.pixel,(function(i,r){var o;if(e.layers_){for(var n=0;n<e.layers_.length;n++)if(e.layers_[n]===r){o=i;break}}else e.features_?e.features_.forEach((function(t){t===i&&(o=i)})):o=i;var s=o.getGeometry().getType();if(o&&/Polygon|LineString/.test(s)){if("Polygon"===s&&o.getGeometry().getCoordinates().length>1)return!1;var a=o.getGeometry().getClosestPoint(t.coordinate),c=a[0]-t.coordinate[0],h=a[1]-t.coordinate[1],l=Math.sqrt(c*c+h*h)/t.frameState.viewState.resolution;return l<5&&{feature:o,hit:a,coordinates:o.getGeometry().getCoordinates(),geom:o.getGeometry().clone(),geomType:s}}return!1}),{hitTolerance:5})},G.prototype.handleDownEvent_=function(t){return this.current_=this.getFeatureAtPixel_(t),!!this.current_&&(this.currentStyle_=this.current_.feature.getStyle(),this.source_&&(this.get("duplicate")||t.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.current_.feature.setStyle(this._style(this.current_.feature)),this.source_.addFeature(this.current_.feature)):(this.current_.feature.setStyle(this._style(this.current_.feature)),this._modifystart=!0),this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0)},G.prototype.handleDragEvent_=function(t){this._modifystart&&(this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),this._modifystart=!1);var e,i,r,o,n=this.current_.geom.getClosestPoint(t.coordinate),c=k(n,t.coordinate);switch(this.current_.geomType){case"Polygon":if(e=T(n,this.current_.coordinates[0]).segment,e){i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],r=[t.coordinate[0]-n[0],t.coordinate[1]-n[1]],i[0]*r[1]-i[1]*r[0]>0&&(c=-c),o=[];for(var h=0;h<this.current_.coordinates.length;h++)o.push(x(this.current_.coordinates[h],0==h?c:-c));this.current_.feature.setGeometry(new a["a"](o))}break;case"LineString":e=T(n,this.current_.coordinates).segment,e&&(i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],r=[t.coordinate[0]-n[0],t.coordinate[1]-n[1]],i[0]*r[1]-i[1]*r[0]>0&&(c=-c),o=x(this.current_.coordinates,c),this.current_.feature.setGeometry(new s["a"](o)));break;default:break}this.dispatchEvent({type:"offsetting",feature:this.current_.feature,offset:c,segment:[n,t.coordinate],coordinate:t.coordinate})},G.prototype.handleUpEvent_=function(t){this._modifystart||this.dispatchEvent({type:"offsetend",feature:this.current_.feature,coordinate:t.coordinate}),this.current_.feature.setStyle(this.currentStyle_),this.current_=!1},G.prototype.handleMoveEvent_=function(t){var e=this.getFeatureAtPixel_(t);e?(!1===this.previousCursor_&&(this.previousCursor_=t.map.getTargetElement().style.cursor),t.map.getTargetElement().style.cursor="pointer"):(t.map.getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=!1)};var V=G,R=i("4334"),j=i("3e6b"),q=i("4cdf");s["a"].prototype.splitAt=function(t,e){var i;if(!t)return[this];if(e||(e=1e-10),t.length&&t[0].length){var r=[this];for(i=0;i<t.length;i++){for(var o=[],n=0;n<r.length;n++){var a=r[n].splitAt(t[i],e);o=o.concat(a)}r=o}return r}if(M(t,this.getFirstCoordinate())||M(t,this.getLastCoordinate()))return[this];var c=this.getCoordinates(),h=[c[0]],l=[];for(i=0;i<c.length-1;i++)if(!M(c[i],c[i+1])){if(M(t,c[i+1]))h.push(c[i+1]),l.push(new s["a"](h)),h=[];else if(!M(t,c[i])){var u,p,d=!1;c[i][0]==c[i+1][0]?(u=(c[i][1]-t[1])/(c[i][1]-c[i+1][1]),d=c[i][0]==t[0]&&0<u&&u<=1):c[i][1]==c[i+1][1]?(u=(c[i][0]-t[0])/(c[i][0]-c[i+1][0]),d=c[i][1]==t[1]&&0<u&&u<=1):(u=(c[i][0]-t[0])/(c[i][0]-c[i+1][0]),p=(c[i][1]-t[1])/(c[i][1]-c[i+1][1]),d=Math.abs(u-p)<=e&&0<u&&u<=1),d&&(h.push(t),l.push(new s["a"](h)),h=[t])}h.push(c[i+1])}return h.length>1&&l.push(new s["a"](h)),l.length?l:[this]};var U=function(t){t||(t={}),R["a"].call(this,{handleEvent:function(t){switch(t.type){case"singleclick":return this.handleDownEvent(t);case"pointermove":return this.handleMoveEvent(t);default:return!0}}}),this.snapDistance_=t.snapDistance||25,this.tolerance_=t.tolerance||1e-10,this.cursor_=t.cursor,this.sources_=t.sources?t.sources instanceof Array?t.sources:[t.sources]:[],t.features&&this.sources_.push(new g["a"]({features:t.features})),this.filterSplit_=t.filter||function(){return!0};var e=[255,255,255,1],i=[0,153,255,1],r=3,o=new F["a"]({color:"rgba(255,255,255,0.4)"}),n=new N["a"]({color:"#3399CC",width:1.25}),s=[new P["c"]({image:new I["a"]({fill:o,stroke:n,radius:5}),fill:o,stroke:n})],a=[new P["c"]({stroke:new N["a"]({color:e,width:r+2})}),new P["c"]({image:new I["a"]({radius:2*r,fill:new F["a"]({color:i}),stroke:new N["a"]({color:e,width:r/2})}),stroke:new N["a"]({color:i,width:r})})];t.sketchStyle&&(s=t.sketchStyle instanceof Array?t.sketchStyle:[t.sketchStyle]),t.featureStyle&&(a=t.featureStyle instanceof Array?t.featureStyle:[t.featureStyle]),this.overlayLayer_=new j["a"]({source:new g["a"]({useSpatialIndex:!1}),name:"Split overlay",displayInLayerSwitcher:!1,style:function(t){return t._sketch_?s:a}})};Object(r["a"])(U,R["a"]),U.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),R["a"].prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},U.prototype.getClosestFeature=function(t){var e,i,r,o,n=this.snapDistance_+1;if(this.sources_.forEach((function(a){var c=a.getClosestFeatureToCoordinate(t.coordinate);if(c&&c.getGeometry().splitAt){var h=c.getGeometry().getClosestPoint(t.coordinate),l=new s["a"]([t.coordinate,h]),u=l.getLength()/t.frameState.viewState.resolution;u<n&&(e=a,n=u,i=c,o=l,r=h)}})),n>this.snapDistance_)return!1;var a=this.getNearestCoord(r,i.getGeometry().getCoordinates()),c=this.getMap().getPixelFromCoordinate(a);return k(t.pixel,c)<this.snapDistance_&&(r=a),{source:e,feature:i,coord:r,link:o}},U.prototype.getNearestCoord=function(t,e){for(var i,r,o=Number.MAX_VALUE,n=0;n<e.length;n++)i=k(t,e[n]),i<o&&(o=i,r=e[n]);return r},U.prototype.handleDownEvent=function(t){var e=this.getClosestFeature(t);if(e){var i=this;i.overlayLayer_.getSource().clear();var r,o=e.feature.getGeometry().splitAt(e.coord,this.tolerance_);if(o.length>1){var n=[];for(r=0;r<o.length;r++){var s=e.feature.clone();s.setGeometry(o[r]),n.push(s)}for(i.dispatchEvent({type:"beforesplit",original:e.feature,features:n}),e.source.dispatchEvent({type:"beforesplit",original:e.feature,features:n}),e.source.removeFeature(e.feature),r=0;r<n.length;r++)e.source.addFeature(n[r]);i.dispatchEvent({type:"aftersplit",original:e.feature,features:n}),e.source.dispatchEvent({type:"aftersplit",original:e.feature,features:n})}}return!1},U.prototype.handleMoveEvent=function(t){var e=t.map;this.overlayLayer_.getSource().clear();var i,r,o=this.getClosestFeature(t);o&&this.filterSplit_(o.feature)?(this.overlayLayer_.getSource().addFeature(o.feature),i=new q["a"](new E["a"](o.coord)),i._sketch_=!0,this.overlayLayer_.getSource().addFeature(i),r=new q["a"](o.link),r._sketch_=!0,this.overlayLayer_.getSource().addFeature(r),this.dispatchEvent({type:"pointermove",coordinate:t.coordinate,frameState:t.frameState,originalEvent:t.originalEvent,map:t.map,pixel:t.pixel,feature:o.feature,linkGeometry:o.link})):this.dispatchEvent(t);var n=e.getTargetElement();this.cursor_&&(o?n.style.cursor!=this.cursor_&&(this.previousCursor_=n.style.cursor,n.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0))};var H=U,X=i("e300"),z=i("35d8"),B=i("35a7"),K=function(t){t||(t={});var e=this;this.selection_=new X["a"],this.handles_=new X["a"],this.overlayLayer_=new j["a"]({source:new g["a"]({features:this.handles_,useSpatialIndex:!1,wrapX:!1}),name:"Transform overlay",displayInLayerSwitcher:!1,style:function(t){return e.style[(t.get("handle")||"default")+(t.get("constraint")||"")+(t.get("option")||"")]}}),w["b"].call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=t.features,"function"===typeof t.filter&&(this._filter=t.filter),this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this._handleEvent=t.condition||function(){return!0},this.addFn_=t.addCondition||function(){return!1},this.set("translateFeature",!1!==t.translateFeature),this.set("translate",!1!==t.translate),this.set("translateBBox",!0===t.translateBBox),this.set("stretch",!1!==t.stretch),this.set("scale",!1!==t.scale),this.set("rotate",!1!==t.rotate),this.set("keepAspectRatio",t.keepAspectRatio||function(t){return t.originalEvent.shiftKey}),this.set("modifyCenter",t.modifyCenter||function(t){return t.originalEvent.metaKey||t.originalEvent.ctrlKey}),this.set("noFlip",t.noFlip||!1),this.set("selection",!1!==t.selection),this.set("hitTolerance",t.hitTolerance||0),this.set("enableRotatedTransform",t.enableRotatedTransform||!1),this.on("propertychange",(function(){this.drawSketch_()})),this.setDefaultStyle()};Object(r["a"])(K,w["b"]),K.prototype.Cursors={default:"auto",select:"pointer",translate:"move",rotate:"move",rotate0:"move",scale:"nesw-resize",scale1:"nwse-resize",scale2:"nesw-resize",scale3:"nwse-resize",scalev:"ew-resize",scaleh1:"ns-resize",scalev2:"ew-resize",scaleh3:"ns-resize"},K.prototype.setMap=function(t){var e=this.getMap();if(e){var i=e.getTargetElement();e.removeLayer(this.overlayLayer_),this.previousCursor_&&i&&(i.style.cursor=this.previousCursor_),this.previousCursor_=void 0}w["b"].prototype.setMap.call(this,t),this.overlayLayer_.setMap(t),null===t&&this.select(null),null!==t&&(this.isTouch=/touch/.test(t.getViewport().className),this.setDefaultStyle())},K.prototype.setActive=function(t){this.select(null),this.overlayLayer_.setVisible(t),w["b"].prototype.setActive.call(this,t)},K.prototype.setDefaultStyle=function(t){t=t||{};var e=t.pointStroke||new N["a"]({color:[255,0,0,1],width:1}),i=t.stroke||new N["a"]({color:[255,0,0,1],width:1,lineDash:[4,4]}),r=t.fill||new F["a"]({color:[255,0,0,.01]}),o=t.pointFill||new F["a"]({color:[255,255,255,.8]}),n=new z["a"]({fill:o,stroke:e,radius:this.isTouch?12:6,points:15});n.getAnchor()[0]=this.isTouch?-10:-5;var s=new z["a"]({fill:o,stroke:e,radius:this.isTouch?16:8,points:4,angle:Math.PI/4}),a=new z["a"]({fill:o,stroke:e,radius:this.isTouch?12:6,points:4,angle:Math.PI/4});function c(t,e,i){return[new P["c"]({image:t,stroke:e,fill:i})]}this.style={default:c(s,i,r),translate:c(s,e,o),rotate:c(n,e,o),rotate0:c(s,e,o),scale:c(s,e,o),scale1:c(s,e,o),scale2:c(s,e,o),scale3:c(s,e,o),scalev:c(a,e,o),scaleh1:c(a,e,o),scalev2:c(a,e,o),scaleh3:c(a,e,o)},this.drawSketch_()},K.prototype.setStyle=function(t,e){if(e){this.style[t]=e instanceof Array?e:[e];for(var i=0;i<this.style[t].length;i++){var r=this.style[t][i].getImage();r&&("rotate"==t&&(r.getAnchor()[0]=-5),this.isTouch&&r.setScale(1.8));var o=this.style[t][i].getText();o&&("rotate"==t&&o.setOffsetX(this.isTouch?14:7),this.isTouch&&o.setScale(1.8))}this.drawSketch_()}},K.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t,(function(t,i){var r=!1;if(!i){if(t===e.bbox_)return!!e.get("translateBBox")&&{feature:t,handle:"translate",constraint:"",option:""};if(e.handles_.forEach((function(e){e===t&&(r=!0)})),r)return{feature:t,handle:t.get("handle"),constraint:t.get("constraint"),option:t.get("option")}}if(!e.get("selection"))return e.selection_.getArray().some((function(e){return t===e}))?{feature:t}:null;if(e._filter)return e._filter(t,i)?{feature:t}:null;if(e.layers_){for(var o=0;o<e.layers_.length;o++)if(e.layers_[o]===i)return{feature:t};return null}return e.features_?(e.features_.forEach((function(e){e===t&&(r=!0)})),r?{feature:t}:null):{feature:t}}),{hitTolerance:this.get("hitTolerance")})||{}},K.prototype.getGeometryRotateToZero_=function(t,e){var i=t.getGeometry(),r=this.getMap().getView().getRotation();if(0===r||!this.get("enableRotatedTransform"))return e?i.clone():i;var o=i.clone();return o.rotate(-1*r,this.getMap().getView().getCenter()),o},K.prototype.drawSketch_=function(t){var e,i,r;if(this.overlayLayer_.getSource().clear(),this.selection_.getLength()){var o=this.getMap().getView().getRotation(),n=this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();if(n=Object(C["c"])(n,0),this.selection_.forEach(function(t){var e=this.getGeometryRotateToZero_(t).getExtent();Object(C["p"])(n,e)}.bind(this)),!0===t)this.ispt_||(this.overlayLayer_.getSource().addFeature(new q["a"]({geometry:new E["a"](this.center_),handle:"rotate0"})),r=Object(a["c"])(n),this.get("enableRotatedTransform")&&0!==o&&r.rotate(o,this.getMap().getView().getCenter()),i=this.bbox_=new q["a"](r),this.overlayLayer_.getSource().addFeature(i));else{if(this.ispt_){var s=this.getMap().getPixelFromCoordinate([n[0],n[1]]);n=Object(C["b"])([this.getMap().getCoordinateFromPixel([s[0]-10,s[1]-10]),this.getMap().getCoordinateFromPixel([s[0]+10,s[1]+10])])}r=Object(a["c"])(n),this.get("enableRotatedTransform")&&0!==o&&r.rotate(o,this.getMap().getView().getCenter()),i=this.bbox_=new q["a"](r);var c=[],h=r.getCoordinates()[0];if(!this.ispt_){if(c.push(i),!this.iscircle_&&this.get("stretch")&&this.get("scale"))for(e=0;e<h.length-1;e++)i=new q["a"]({geometry:new E["a"]([(h[e][0]+h[e+1][0])/2,(h[e][1]+h[e+1][1])/2]),handle:"scale",constraint:e%2?"h":"v",option:e}),c.push(i);if(this.get("scale"))for(e=0;e<h.length-1;e++)i=new q["a"]({geometry:new E["a"](h[e]),handle:"scale",option:e}),c.push(i);this.get("translate")&&!this.get("translateFeature")&&(i=new q["a"]({geometry:new E["a"]([(h[0][0]+h[2][0])/2,(h[0][1]+h[2][1])/2]),handle:"translate"}),c.push(i))}!this.iscircle_&&this.get("rotate")&&(i=new q["a"]({geometry:new E["a"](h[3]),handle:"rotate"}),c.push(i)),this.overlayLayer_.getSource().addFeatures(c)}}},K.prototype.select=function(t,e){if(!t)return this.selection_.clear(),void this.drawSketch_();if(t.getGeometry&&t.getGeometry()){if(e)this.selection_.push(t);else{var i=this.selection_.getArray().indexOf(t);this.selection_.removeAt(i)}this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:t,features:this.selection_})}},K.prototype.setSelection=function(t){this.selection_.clear(),t.forEach(function(t){this.selection_.push(t)}.bind(this)),this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",features:this.selection_})},K.prototype.watchFeatures_=function(){this._featureListeners&&this._featureListeners.forEach((function(t){Object(B["b"])(t)})),this._featureListeners=[],this.selection_.forEach(function(t){this._featureListeners.push(t.on("change",function(){this.isUpdating_||this.drawSketch_()}.bind(this)))}.bind(this))},K.prototype.handleDownEvent_=function(t){if(this._handleEvent(t,this.selection_)){var e=this.getFeatureAtPixel_(t.pixel),i=e.feature;if(this.selection_.getLength()&&this.selection_.getArray().indexOf(i)>=0&&(this.ispt_&&this.get("translate")||this.get("translateFeature"))&&(e.handle="translate"),e.handle){this.mode_=e.handle,this.opt_=e.option,this.constraint_=e.constraint;var r=this.getMap().getView().getRotation();this.coordinate_=t.coordinate,this.pixel_=t.pixel,this.geoms_=[],this.rotatedGeoms_=[];for(var o,n=Object(C["j"])(),s=Object(C["j"])(),c=0;o=this.selection_.item(c);c++)if(this.geoms_.push(o.getGeometry().clone()),n=Object(C["p"])(n,o.getGeometry().getExtent()),this.get("enableRotatedTransform")&&0!==r){var h=this.getGeometryRotateToZero_(o,!0);this.rotatedGeoms_.push(h),s=Object(C["p"])(s,h.getExtent())}if(this.extent_=Object(a["c"])(n).getCoordinates()[0],this.get("enableRotatedTransform")&&0!==r&&(this.rotatedExtent_=Object(a["c"])(s).getCoordinates()[0]),"rotate"===this.mode_){this.center_=this.getCenter()||Object(C["w"])(n);var l=t.map.getTargetElement();l.style.cursor=this.Cursors.rotate0,this.previousCursor_=l.style.cursor}else this.center_=Object(C["w"])(n);return this.angle_=Math.atan2(this.center_[1]-t.coordinate[1],this.center_[0]-t.coordinate[0]),this.dispatchEvent({type:this.mode_+"start",feature:this.selection_.item(0),features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!0}if(this.get("selection")){if(i){this.addFn_(t)||this.selection_.clear();var u=this.selection_.getArray().indexOf(i);u<0?this.selection_.push(i):this.selection_.removeAt(u)}else this.selection_.clear();return this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:i,features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!1}}},K.prototype.getFeatures=function(){return this.selection_},K.prototype.getCenter=function(){return this.get("center")},K.prototype.setCenter=function(t){return this.set("center",t)},K.prototype.handleDragEvent_=function(t){if(this._handleEvent(t,this.features_)){var e,i,r,o=this.getMap().getView().getRotation(),n=[this.coordinate_[0],this.coordinate_[1]],s=[t.coordinate[0],t.coordinate[1]];switch(this.isUpdating_=!0,this.mode_){case"rotate":var a=Math.atan2(this.center_[1]-s[1],this.center_[0]-s[0]);if(!this.ispt)for(e=0,i;i=this.selection_.item(e);e++)r=this.geoms_[e].clone(),r.rotate(a-this.angle_,this.center_),"Circle"==r.getType()&&r.setCenterAndRadius(r.getCenter(),r.getRadius()),i.setGeometry(r);this.drawSketch_(!0),this.dispatchEvent({type:"rotating",feature:this.selection_.item(0),features:this.selection_,angle:a-this.angle_,pixel:t.pixel,coordinate:t.coordinate});break;case"translate":var c=s[0]-n[0],h=s[1]-n[1];for(e=0,i;i=this.selection_.item(e);e++)i.getGeometry().translate(c,h);this.handles_.forEach((function(t){t.getGeometry().translate(c,h)})),this.coordinate_=t.coordinate,this.dispatchEvent({type:"translating",feature:this.selection_.item(0),features:this.selection_,delta:[c,h],pixel:t.pixel,coordinate:t.coordinate});break;case"scale":var l=this.center_;if(this.get("modifyCenter")(t)){var u=this.extent_;this.get("enableRotatedTransform")&&0!==o&&(u=this.rotatedExtent_),l=u[(Number(this.opt_)+2)%4]}var p=this.coordinate_,d=t.coordinate;if(this.get("enableRotatedTransform")&&0!==o){var f=new E["a"](this.coordinate_);f.rotate(-1*o,l),p=f.getCoordinates();var g=new E["a"](t.coordinate);g.rotate(-1*o,l),d=g.getCoordinates()}var y=(d[0]-l[0])/(p[0]-l[0]),_=(d[1]-l[1])/(p[1]-l[1]);if(this.get("enableRotatedTransform")&&0!==o){var v=new E["a"](l);v.rotate(-1*o,this.getMap().getView().getCenter()),l=v.getCoordinates()}for(this.get("noFlip")&&(y<0&&(y=-y),_<0&&(_=-_)),this.constraint_?"h"==this.constraint_?y=1:_=1:this.get("keepAspectRatio")(t)&&(y=_=Math.min(y,_)),e=0,i;i=this.selection_.item(e);e++)r=0!==o&&this.get("enableRotatedTransform")?this.rotatedGeoms_[e].clone():this.geoms_[e].clone(),r.applyTransform((function(t,e,i){if(i<2)return e;for(var o=0;o<t.length;o+=i)1!=y&&(e[o]=l[0]+(t[o]-l[0])*y),1!=_&&(e[o+1]=l[1]+(t[o+1]-l[1])*_);return"Circle"==r.getType()&&r.setCenterAndRadius(r.getCenter(),r.getRadius()),e})),this.get("enableRotatedTransform")&&0!==o&&r.rotate(o,this.getMap().getView().getCenter()),i.setGeometry(r);this.drawSketch_(),this.dispatchEvent({type:"scaling",feature:this.selection_.item(0),features:this.selection_,scale:[y,_],pixel:t.pixel,coordinate:t.coordinate});break;default:break}this.isUpdating_=!1}},K.prototype.handleMoveEvent_=function(t){if(this._handleEvent(t,this.features_)&&!this.mode_){var e=this.getFeatureAtPixel_(t.pixel),i=t.map.getTargetElement();if(e.feature){var r=e.handle?this.Cursors[(e.handle||"default")+(e.constraint||"")+(e.option||"")]:this.Cursors.select;void 0===this.previousCursor_&&(this.previousCursor_=i.style.cursor),i.style.cursor=r}else void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_),this.previousCursor_=void 0}},K.prototype.handleUpEvent_=function(t){if("rotate"===this.mode_){var e=t.map.getTargetElement();e.style.cursor=this.Cursors.default,this.previousCursor_=void 0}return this.dispatchEvent({type:this.mode_+"end",feature:this.selection_.item(0),features:this.selection_,oldgeom:this.geoms_[0],oldgeoms:this.geoms_}),this.drawSketch_(),this.mode_=null,!1},K.prototype.getFeatures=function(){return this.selection_};var Y=K,Z=function(t){var e,i;t||(t={}),w["b"].call(this,{handleEvent:function(t){switch(t.type){case"pointerdown":return e=this.handleDownEvent(t),i=e||this._deleteCondition(t),!e;case"pointerup":return e=!1,this.handleUpEvent(t);case"pointerdrag":return!e||this.handleDragEvent(t);case"pointermove":return!!e||this.handleMoveEvent(t);case"singleclick":case"click":return!i;default:return!0}}}),this.snapDistance_=t.pixelTolerance||10,this.tolerance_=1e-10,this.cursor_=t.cursor,this.sources_=t.sources?t.sources instanceof Array?t.sources:[t.sources]:[],t.source&&this.sources_.push(t.source),t.features&&this.sources_.push(new g["a"]({features:t.features})),this.filterSplit_=t.filter||function(){return!0},this._condition=t.condition||o["k"],this._deleteCondition=t.deleteCondition||o["b"],this._insertVertexCondition=t.insertVertexCondition||o["d"];var r=function(){return[new P["c"]({image:new I["a"]({radius:6,fill:new F["a"]({color:[0,153,255,1]}),stroke:new N["a"]({color:"#FFF",width:1.25})})})]};t.style&&(r="function"===typeof t.style?t.style:function(){return t.style}),this.overlayLayer_=new j["a"]({source:new g["a"]({useSpatialIndex:!1}),name:"Modify overlay",displayInLayerSwitcher:!1,style:r,wrapX:t.wrapX})};Object(r["a"])(Z,w["b"]),Z.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),R["a"].prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},Z.prototype.setActive=function(t){R["a"].prototype.setActive.call(this,t),this.overlayLayer_&&this.overlayLayer_.getSource().clear()},Z.prototype.getClosestFeature=function(t){for(var e,i,r=this.snapDistance_+1,o=0;o<this.sources_.length;o++){var n=this.sources_[o];if(e=n.getClosestFeatureToCoordinate(t.coordinate),e&&this.filterSplit_(e)){var s=e.getGeometry().getClosestPoint(t.coordinate),a=k(t.coordinate,s)/t.frameState.viewState.resolution;a<r&&(r=a,i=s);break}}if(r>this.snapDistance_)return this.currentFeature&&this.dispatchEvent({type:"select",selected:[],deselected:[this.currentFeature]}),this.currentFeature=null,!1;var c=this.getNearestCoord(i,e.getGeometry());if(c){c=c.coord;var h=this.getMap().getPixelFromCoordinate(c);return k(t.pixel,h)<this.snapDistance_&&(i=c),this.currentFeature!==e&&this.dispatchEvent({type:"select",selected:[e],deselected:[this.currentFeature]}),this.currentFeature=e,{source:n,feature:e,coord:i}}},Z.prototype.getNearestCoord=function(t,e){var i,r,o,n,a;switch(e.getType()){case"Point":return{coord:e.getCoordinates(),dist:k(e.getCoordinates(),t)};case"MultiPoint":return this.getNearestCoord(t,new s["a"](e.getCoordinates()));case"LineString":case"LinearRing":var c;a=Number.MAX_VALUE;var h=e.getCoordinates();for(i=0;i<h.length;i++)c=k(t,h[i]),c<a&&(a=c,n=h[i]);return{coord:n,dist:a};case"MultiLineString":var l=e.getLineStrings();for(n=!1,a=Number.MAX_VALUE,i=0;r=l[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<a&&(n=o,a=o.dist,n.ring=i);return n;case"Polygon":var u=e.getLinearRings();for(n=!1,a=Number.MAX_VALUE,i=0;r=u[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<a&&(n=o,a=o.dist,n.ring=i);return n;case"MultiPolygon":var p=e.getPolygons();for(n=!1,a=Number.MAX_VALUE,i=0;r=p[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<a&&(n=o,a=o.dist,n.poly=i);return n;case"GeometryCollection":var d=e.getGeometries();for(n=!1,a=Number.MAX_VALUE,i=0;r=d[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<a&&(n=o,a=o.dist,n.geom=i);return n;default:return!1}},Z.prototype.getArcs=function(t,e){var i,r,o,n,a,c=!1;switch(t.getType()){case"Point":M(e,t.getCoordinates())&&(c={geom:t,type:t.getType(),coord1:[],coord2:[],node:!0});break;case"MultiPoint":for(i=t.getCoordinates(),r=0;r<i.length;r++)if(M(e,i[r])){c={geom:t,type:t.getType(),index:r,coord1:[],coord2:[],node:!0};break}break;case"LinearRing":case"LineString":var h=t.getClosestPoint(e);if(k(h,e)<1.5*this.tolerance_){var l;if("LinearRing"===t.getType()?(a=new s["a"](t.getCoordinates()),l=a.splitAt(e,this.tolerance_)):l=t.splitAt(e,this.tolerance_),l.length>2){for(i=l[1].getCoordinates(),r=2;o=l[r];r++){var u=o.getCoordinates();u.shift(),i=i.concat(u)}l=[l[0],new s["a"](i)]}if(2===l.length){var p=l[0].getCoordinates(),d=l[1].getCoordinates(),f=p.length+d.length-1;p.pop(),d.shift(),c={geom:t,type:t.getType(),coord1:p,coord2:d,node:t.getCoordinates().length===f,closed:!1}}else if(1===l.length){o=l[0].getCoordinates();var g=M(o[0],e),y=M(o[o.length-1],e);g?(o.shift(),y&&o.pop(),c={geom:t,type:t.getType(),coord1:[],coord2:o,node:!0,closed:y}):y&&(o.pop(),c={geom:t,type:t.getType(),coord1:o,coord2:[],node:!0,closed:!1})}}break;case"MultiLineString":var _=t.getLineStrings();for(r=0;n=_[r];r++)if(c=this.getArcs(n,e),c){c.geom=t,c.type=t.getType(),c.lstring=r;break}break;case"Polygon":var v=t.getLinearRings();for(r=0;n=v[r];r++)if(c=this.getArcs(n,e),c){c.geom=t,c.type=t.getType(),c.index=r;break}break;case"MultiPolygon":var m=t.getPolygons();for(r=0;n=m[r];r++)if(c=this.getArcs(n,e),c){c.geom=t,c.type=t.getType(),c.poly=r;break}break;case"GeometryCollection":for(a=t.getGeometries(),r=0;n=a[r];r++)if(c=this.getArcs(n,e),c){c.geom=t,c.g=r,c.typeg=c.type,c.type=t.getType();break}break;default:console.error("ol/interaction/ModifyFeature "+t.getType()+" not supported!");break}return c},Z.prototype.handleDownEvent=function(t){if(!this.getActive())return!1;var e=this.getClosestFeature(t);if(e&&(this._condition(t)||this._deleteCondition(t))){var i=[];return this.arcs=[],this.sources_.forEach(function(t){var r=Object(C["c"])(Object(C["b"])([e.coord]),this.tolerance_);i=i.concat(i,t.getFeaturesInExtent(r))}.bind(this)),this._modifiedFeatures=[],i.forEach(function(i){var r=this.getArcs(i.getGeometry(),e.coord);r&&(this._insertVertexCondition(t)||r.node)&&(r.feature=i,this._modifiedFeatures.push(i),this.arcs.push(r))}.bind(this)),!this._modifiedFeatures.length||(this._deleteCondition(t)?!this._removePoint(e,t):(this.dispatchEvent({type:"modifystart",coordinate:e.coord,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.handleDragEvent({coordinate:e.coord,originalEvent:t.originalEvent}),!0))}return!1},Z.prototype.getModifiedFeatures=function(){return this._modifiedFeatures||[]},Z.prototype.removePoint=function(){this._removePoint({},{})},Z.prototype._getModification=function(t){var e=t.coord1.concat(t.coord2);switch(t.type){case"LineString":if(t.closed&&e.push(e[0]),e.length>1&&t.geom.getCoordinates().length!=e.length)return t.coords=e,!0;break;case"MultiLineString":if(t.closed&&e.push(e[0]),e.length>1){var i=t.geom.getCoordinates();if(i[t.lstring].length!=e.length)return i[t.lstring]=e,t.coords=i,!0}break;case"Polygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates(),i[t.index].length!=e.length))return i[t.index]=e,t.coords=i,!0;break;case"MultiPolygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates(),i[t.poly][t.index].length!=e.length))return i[t.poly][t.index]=e,t.coords=i,!0;break;case"GeometryCollection":t.type=t.typeg;var r=t.geom,o=r.getGeometries();t.geom=o[t.g];var n=this._getModification(t);return r.setGeometries(o),t.geom=r,t.type="GeometryCollection",n;default:break}return!1},Z.prototype._removePoint=function(t,e){if(!this.arcs)return!1;this.overlayLayer_.getSource().clear();var i=!1;return this.arcs.forEach(function(t){i=i||this._getModification(t)}.bind(this)),i&&(this.dispatchEvent({type:"modifystart",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures}),this.arcs.forEach(function(t){if("GeometryCollection"===t.geom.getType()){if(t.coords){var e=t.geom.getGeometries();e[t.g].setCoordinates(t.coords),t.geom.setGeometries(e)}}else t.coords&&t.geom.setCoordinates(t.coords)}.bind(this)),this.dispatchEvent({type:"modifyend",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures})),this.arcs=[],i},Z.prototype.handleUpEvent=function(t){return!!this.getActive()&&(!this.arcs||!this.arcs.length||(this.overlayLayer_.getSource().clear(),this.dispatchEvent({type:"modifyend",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.arcs=[],!0))},Z.prototype.setArcCoordinates=function(t,e){var i;switch(t.type){case"Point":t.geom.setCoordinates(e[0]);break;case"MultiPoint":i=t.geom.getCoordinates(),i[t.index]=e[0],t.geom.setCoordinates(i);break;case"LineString":t.geom.setCoordinates(e);break;case"MultiLineString":i=t.geom.getCoordinates(),i[t.lstring]=e,t.geom.setCoordinates(i);break;case"Polygon":i=t.geom.getCoordinates(),i[t.index]=e,t.geom.setCoordinates(i);break;case"MultiPolygon":i=t.geom.getCoordinates(),i[t.poly][t.index]=e,t.geom.setCoordinates(i);break;case"GeometryCollection":t.type=t.typeg;var r=t.geom,o=r.getGeometries();t.geom=o[t.g],this.setArcCoordinates(t,e),r.setGeometries(o),t.geom=r,t.type="GeometryCollection";break}},Z.prototype.handleDragEvent=function(t){if(!this.getActive())return!1;if(!this.arcs)return!0;this.overlayLayer_.getSource().clear();var e=new q["a"](new E["a"](t.coordinate));return this.overlayLayer_.getSource().addFeature(e),!this.arcs.length||(this.arcs.forEach(function(e){var i=e.coord1.concat([t.coordinate],e.coord2);e.closed&&i.push(t.coordinate),this.setArcCoordinates(e,i)}.bind(this)),this.dispatchEvent({type:"modifying",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),!0)},Z.prototype.handleMoveEvent=function(t){if(!this.getActive())return!1;this.overlayLayer_.getSource().clear();var e=this.getClosestFeature(t);if(e){var i=new q["a"](new E["a"](e.coord));this.overlayLayer_.getSource().addFeature(i)}var r=t.map.getTargetElement();this.cursor_&&(e?r.style.cursor!=this.cursor_&&(this.previousCursor_=r.style.cursor,r.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(r.style.cursor=this.previousCursor_,this.previousCursor_=void 0))},Z.prototype.getCurrentFeature=function(){return this.currentFeature};var W=Z,$=function(t){t||(t={}),this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.maxCircleCoordinates_=t.maxCircleCoordinates||100,this.features_=t.features,this.source_=t.source,this.squareFn_=t.squareCondition,this.centeredFn_=t.centerCondition,this.canRotate_=!1!==t.canRotate,this.geometryName_=t.geometryName,this.setSides(t.sides);var e=O(!0);this.sketch_=new X["a"],this.overlayLayer_=new j["a"]({source:new g["a"]({features:this.sketch_,useSpatialIndex:!1}),name:"DrawRegular overlay",displayInLayerSwitcher:!1,style:t.style||e}),R["a"].call(this,{handleEvent:this.handleEvent_})};Object(r["a"])($,R["a"]),$.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),R["a"].prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},$.prototype.setActive=function(t){this.reset(),R["a"].prototype.setActive.call(this,t)},$.prototype.reset=function(){this.overlayLayer_.getSource().clear(),this.started_=!1},$.prototype.setSides=function(t){t=parseInt(t),this.sides_=t>2?t:0},$.prototype.canRotate=function(t){return!0!==t&&!1!==t||(this.canRotate_=t),this.canRotate_},$.prototype.getSides=function(){return this.sides_},$.prototype.startAngle={default:Math.PI/2,3:-Math.PI/2,4:Math.PI/4},$.prototype.getGeom_=function(){if(this.overlayLayer_.getSource().clear(),!this.center_)return!1;var t;if(this.coord_){var e,i,r,o,n,s=this.center_,c=this.coord_;if(!this.sides_&&this.square_&&!this.centered_)return s=[(c[0]+s[0])/2,(c[1]+s[1])/2],e=[c[0]-s[0],c[1]-s[1]],r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=new S["a"](s,r,"XY"),n=this.getMap().getPixelFromCoordinate(s),i=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),i=Math.min(this.maxCircleCoordinates_,Math.round(i/3)),Object(a["b"])(o,i,0);var h=this.canRotate_&&this.centered_&&this.square_;if(e=[c[0]-s[0],c[1]-s[1]],this.square_&&!h){var l=Math.max(Math.abs(e[0]),Math.abs(e[1]));c=[s[0]+(e[0]>0?l:-l),s[1]+(e[1]>0?l:-l)]}if(r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),r>0){var u;if(o=new S["a"](s,r,"XY"),u=h?Math.atan2(e[1],e[0]):this.startAngle[this.sides_]||this.startAngle["default"],this.sides_?t=Object(a["b"])(o,this.sides_,u):(n=this.getMap().getPixelFromCoordinate(this.center_),i=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),i=Math.min(this.maxCircleCoordinates_,Math.round(i/(this.centered_?3:5))),t=Object(a["b"])(o,i,0)),h)return t;var p=t.getExtent();s=this.centered_?[2*this.center_[0]-this.coord_[0],2*this.center_[1]-this.coord_[1]]:this.center_;var d=(s[0]-c[0])/(p[0]-p[2]),f=(s[1]-c[1])/(p[1]-p[3]);if(this.square_){var g=Math.min(Math.abs(d),Math.abs(f));d=Math.sign(d)*g,f=Math.sign(f)*g}var y=[s[0]-p[0]*d,s[1]-p[1]*f];return t.applyTransform((function(t,e,i){for(var r=0;r<t.length;r+=i)e[r]=t[r]*d+y[0],e[r+1]=t[r+1]*f+y[1];return e})),t}}return new E["a"](this.center_)},$.prototype.drawSketch_=function(t){if(this.overlayLayer_.getSource().clear(),t){this.square_=this.squareFn_?this.squareFn_(t):t.originalEvent.shiftKey,this.centered_=this.centeredFn_?this.centeredFn_(t):t.originalEvent.metaKey||t.originalEvent.ctrlKey;var e=this.getGeom_();if(e){var i=this.feature_;return this.geometryName_&&i.setGeometryName(this.geometryName_),"Polygon"===e.getType()&&i.getGeometry().setCoordinates(e.getCoordinates()),this.overlayLayer_.getSource().addFeature(i),this.coord_&&this.square_&&(this.canRotate_&&this.centered_&&this.coord_||!this.sides_&&!this.centered_)&&this.overlayLayer_.getSource().addFeature(new q["a"](new s["a"]([this.center_,this.coord_]))),i}}},$.prototype.drawPoint_=function(t,e){e||this.overlayLayer_.getSource().clear(),this.overlayLayer_.getSource().addFeature(new q["a"](new E["a"](t)))},$.prototype.handleEvent_=function(t){var e,i;switch(this._eventTime=new Date,t.type){case"pointerdown":this.downPx_=t.pixel,this.start_(t);var r=500;this._longTouch=!1,setTimeout(function(){this._longTouch=new Date-this._eventTime>.9*r,this._longTouch&&this.handleMoveEvent_(t)}.bind(this),r);break;case"pointerup":this.started_&&this.coord_&&(e=this.downPx_[0]-t.pixel[0],i=this.downPx_[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_&&("pointermove"==this.lastEvent||"keydown"==this.lastEvent?this.end_(t):(e=this.upPx_[0]-t.pixel[0],i=this.upPx_[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_?this.end_(t):(this.handleMoveEvent_(t),this.drawPoint_(t.coordinate,!0))))),this.upPx_=t.pixel;break;case"pointerdrag":if(this.started_){var o=this.getMap().getPixelFromCoordinate(this.center_);e=o[0]-t.pixel[0],i=o[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_&&this.reset()}return!this._longTouch;case"pointermove":this.started_&&(e=this.downPx_[0]-t.pixel[0],i=this.downPx_[1]-t.pixel[1],e*e+i*i>this.squaredClickTolerance_&&(this.handleMoveEvent_(t),this.lastEvent=t.type));break;default:if(this.lastEvent=t.type,this.started_&&"dblclick"===t.type)return!1;break}return!0},$.prototype.finishDrawing=function(){this.started_&&this.coord_&&this.end_({pixel:this.upPx_,coordinate:this.coord_})},$.prototype.handleMoveEvent_=function(t){if(this.started_){this.coord_=t.coordinate,this.coordPx_=t.pixel;var e=this.drawSketch_(t);this.dispatchEvent({type:"drawing",feature:e,pixel:t.pixel,startCoordinate:this.center_,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}else this.drawPoint_(t.coordinate)},$.prototype.start_=function(t){if(this.started_)this.coord_=t.coordinate;else{this.started_=!0,this.center_=t.coordinate,this.coord_=null;var e=new a["a"]([[t.coordinate,t.coordinate,t.coordinate]]),i=this.feature_=new q["a"](e);this.drawSketch_(t),this.dispatchEvent({type:"drawstart",feature:i,pixel:t.pixel,coordinate:t.coordinate})}},$.prototype.end_=function(t){if(this.coord_=t.coordinate,this.started_=!1,!this.coord_||this.center_[0]===this.coord_[0]&&this.center_[1]===this.coord_[1])this.dispatchEvent({type:"drawcancel",feature:null,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_});else{var e=this.feature_;this.geometryName_&&e.setGeometryName(this.geometryName_),e.setGeometry(this.getGeom_()),this.source_?this.source_.addFeature(e):this.features_&&this.features_.push(e),this.dispatchEvent({type:"drawend",feature:e,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}this.center_=this.coord_=null,this.drawSketch_()};var J=$,Q=function(t){t||(t={});var e=this;this._select=new c["a"]({style:t.style}),this._select.setActive(!1);var i,r=t.geometryFunction;if(i=r?function(t,i){return i=e._geometryFn(t,i),r(t,i)}:function(t,i){return e._geometryFn(t,i)},t.type="Polygon",t.geometryFunction=i,n["a"].call(this,t),t.layers&&("function"===typeof t.layers?this.layers_=t.layers:t.layers.indexOf&&(this.layers_=function(e){return t.layers.indexOf(e)>=0})),"function"===typeof t.features)this._features=t.features;else if(t.features){var o=t.features;this._features=function(t){return o.indexOf?!!o[o.indexOf(t)]:!!o.item(o.getArray().indexOf(t))}}else this._features=function(){return!0};this.on("drawstart",this._startDrawing.bind(this)),this.on("drawend",this._finishDrawing.bind(this))};Object(r["a"])(Q,n["a"]),Q.prototype.setMap=function(t){this.getMap()&&this.getMap().removeInteraction(this._select),t&&t.addInteraction(this._select),n["a"].prototype.setMap.call(this,t)},Q.prototype.setActive=function(t){this._select.getFeatures().clear(),n["a"].prototype.setActive.call(this,t)},Q.prototype.removeLastPoint=function(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&n["a"].prototype.removeLastPoint.call(this)},Q.prototype.getPolygon=function(){return this._polygon},Q.prototype._startDrawing=function(t){var e=this.getMap();this._feature=t.feature;var i=t.feature.getGeometry().getCoordinates()[0][0];this._current=null,e.forEachFeatureAtPixel(e.getPixelFromCoordinate(i),function(t,e){if(this._features(t,e)){var r=t.getGeometry();if("Polygon"===r.getType()&&r.intersectsCoordinate(i))this._polygonIndex=!1,this._polygon=r,this._current=t;else if("MultiPolygon"===r.getType()&&r.intersectsCoordinate(i))for(var o,n=0;o=r.getPolygon(n);n++)if(o.intersectsCoordinate(i)){this._polygonIndex=n,this._polygon=o,this._current=t;break}}}.bind(this),{layerFilter:this.layers_}),this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))},Q.prototype._finishDrawing=function(t){t.hole=t.feature,t.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var e=t.hole.getGeometry().getCoordinates()[0];if(e.length>3)if(!1!==this._polygonIndex){for(var i,r=t.feature.getGeometry(),o=new L["a"]([]),n=0;i=r.getPolygon(n);n++)n===this._polygonIndex?(i.appendLinearRing(new b["a"](e)),o.appendPolygon(i)):o.appendPolygon(i);t.feature.setGeometry(o)}else this.getPolygon().appendLinearRing(new b["a"](e));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()},Q.prototype._geometryFn=function(t,e){var i=t[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(i)||(this.lastOKCoord=[i[0],i[1]]),t[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),e?e.setCoordinates([t[0].concat([t[0][0]])]):e=new a["a"](t),e};var tt=Q,et=function(t){t=t||{},t.interactions=t.interactions||{},h["a"].call(this,{className:(t.className?t.className+" ":"")+"ol-editbar",toggleOne:!0,target:t.target}),this._source=t.source,this._interactions={},this._setSelectInteraction(t),!1!==t.edition&&this._setEditInteraction(t),this._setModifyInteraction(t)};Object(r["a"])(et,h["a"]),et.prototype.setMap=function(t){this.getMap()&&(this._interactions.Delete&&this.getMap().removeInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().removeInteraction(this._interactions.ModifySelect)),h["a"].prototype.setMap.call(this,t),this.getMap()&&(this._interactions.Delete&&this.getMap().addInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().addInteraction(this._interactions.ModifySelect))},et.prototype.getInteraction=function(t){return this._interactions[t]},et.prototype._getTitle=function(t){return t&&t.title?t.title:t},et.prototype._setSelectInteraction=function(t){var e,i=this,r=new h["a"];if(!1!==t.interactions.Delete){t.interactions.Delete instanceof v?this._interactions.Delete=t.interactions.Delete:this._interactions.Delete=new v;var n=this._interactions.Delete;n.setActive(!1),this.getMap()&&this.getMap().addInteraction(n),r.addControl(new l["a"]({className:"ol-delete",title:this._getTitle(t.interactions.Delete)||"Delete",name:"Delete",handleClick:function(t){n.delete(e.getInteraction().getFeatures());var i={type:"select",selected:[],deselected:e.getInteraction().getFeatures().getArray().slice(),mapBrowserEvent:t.mapBrowserEvent};e.getInteraction().getFeatures().clear(),e.getInteraction().dispatchEvent(i)}}))}if(!1!==t.interactions.Info&&r.addControl(new l["a"]({className:"ol-info",name:"Info",title:this._getTitle(t.interactions.Info)||"Show informations",handleClick:function(){i.dispatchEvent({type:"info",features:e.getInteraction().getFeatures()})}})),!1!==t.interactions.Select){t.interactions.Select instanceof c["a"]?this._interactions.Select=t.interactions.Select:this._interactions.Select=new c["a"]({condition:o["e"]});var s=this._interactions.Select;e=new p({className:"ol-selection",name:"Select",title:this._getTitle(t.interactions.Select)||"Select",interaction:s,bar:r.getControls().length?r:void 0,autoActivate:!0,active:!0}),this.addControl(e),s.on("change:active",(function(){s.getFeatures().clear()}))}},et.prototype._setEditInteraction=function(t){if(!1!==t.interactions.DrawPoint){t.interactions.DrawPoint instanceof n["a"]?this._interactions.DrawPoint=t.interactions.DrawPoint:this._interactions.DrawPoint=new n["a"]({type:"Point",source:this._source});var e=new p({className:"ol-drawpoint",name:"DrawPoint",title:this._getTitle(t.interactions.DrawPoint)||"Point",interaction:this._interactions.DrawPoint});this.addControl(e)}if(!1!==t.interactions.DrawLine){t.interactions.DrawLine instanceof n["a"]?this._interactions.DrawLine=t.interactions.DrawLine:this._interactions.DrawLine=new n["a"]({type:"LineString",source:this._source,geometryFunction:function(t,e){return e?e.setCoordinates(t):e=new s["a"](t),this.nbpts=e.getCoordinates().length,e}});var i=new p({className:"ol-drawline",title:this._getTitle(t.interactions.DrawLine)||"LineString",name:"DrawLine",interaction:this._interactions.DrawLine,bar:new h["a"]({controls:[new f({html:this._getTitle(t.interactions.UndoDraw)||"undo",title:this._getTitle(t.interactions.UndoDraw)||"delete last point",handleClick:function(){i.getInteraction().nbpts>1&&i.getInteraction().removeLastPoint()}}),new f({html:this._getTitle(t.interactions.FinishDraw)||"finish",title:this._getTitle(t.interactions.FinishDraw)||"finish",handleClick:function(){i.getInteraction().nbpts>2&&i.getInteraction().finishDrawing()}})]})});this.addControl(i)}if(!1!==t.interactions.DrawPolygon&&(t.interactions.DrawPolygon instanceof n["a"]?this._interactions.DrawPolygon=t.interactions.DrawPolygon:this._interactions.DrawPolygon=new n["a"]({type:"Polygon",source:this._source,geometryFunction:function(t,e){return this.nbpts=t[0].length,e?e.setCoordinates([t[0].concat([t[0][0]])]):e=new a["a"](t),e}}),this._setDrawPolygon("ol-drawpolygon",this._interactions.DrawPolygon,this._getTitle(t.interactions.DrawPolygon)||"Polygon","DrawPolygon",t)),!1!==t.interactions.DrawHole&&(t.interactions.DrawHole instanceof tt?this._interactions.DrawHole=t.interactions.DrawHole:this._interactions.DrawHole=new tt,this._setDrawPolygon("ol-drawhole",this._interactions.DrawHole,this._getTitle(t.interactions.DrawHole)||"Hole","DrawHole",t)),!1!==t.interactions.DrawRegular){t.interactions.DrawRegular instanceof J?this._interactions.DrawRegular=t.interactions.DrawRegular:this._interactions.DrawRegular=new J({source:this._source,sides:4});var r=this._interactions.DrawRegular,o=document.createElement("DIV"),c=m["a"].create("DIV",{parent:o});m["a"].addListener(c,["click","touchstart"],function(){var t=r.getSides()-1;t<2&&(t=2),r.setSides(t),l.textContent=t>2?t+" pts":"circle"}.bind(this));var l=m["a"].create("TEXT",{html:"4 pts",parent:o}),u=m["a"].create("DIV",{parent:o});m["a"].addListener(u,["click","touchstart"],function(){var t=r.getSides()+1;t<3&&(t=3),r.setSides(t),l.textContent=t+" pts"}.bind(this));var d=new p({className:"ol-drawregular",title:this._getTitle(t.interactions.DrawRegular)||"Regular",name:"DrawRegular",interaction:this._interactions.DrawRegular,bar:new h["a"]({controls:[new f({html:o})]})});this.addControl(d)}},et.prototype._setDrawPolygon=function(t,e,i,r,o){var n=new p({className:t,name:r,title:i,interaction:e,bar:new h["a"]({controls:[new f({html:this._getTitle(o.interactions.UndoDraw)||"undo",title:this._getTitle(o.interactions.UndoDraw)||"undo last point",handleClick:function(){n.getInteraction().nbpts>1&&n.getInteraction().removeLastPoint()}}),new f({html:this._getTitle(o.interactions.FinishDraw)||"finish",title:this._getTitle(o.interactions.FinishDraw)||"finish",handleClick:function(){n.getInteraction().nbpts>3&&n.getInteraction().finishDrawing()}})]})});return this.addControl(n),n},et.prototype._setModifyInteraction=function(t){if(!1!==t.interactions.ModifySelect&&!1!==t.interactions.Select&&(t.interactions.ModifySelect instanceof W?this._interactions.ModifySelect=t.interactions.ModifySelect:this._interactions.ModifySelect=new W({features:this.getInteraction("Select").getFeatures()}),this.getMap()&&this.getMap().addInteraction(this._interactions.ModifySelect),this._interactions.ModifySelect.setActive(this._interactions.Select.getActive()),this._interactions.Select.on("change:active",function(){this._interactions.ModifySelect.setActive(this._interactions.Select.getActive())}.bind(this))),!1!==t.interactions.Transform){t.interactions.Transform instanceof Y?this._interactions.Transform=t.interactions.Transform:this._interactions.Transform=new Y({addCondition:o["l"]});var e=new p({html:"<i></i>",className:"ol-transform",title:this._getTitle(t.interactions.Transform)||"Transform",name:"Transform",interaction:this._interactions.Transform});this.addControl(e)}if(!1!==t.interactions.Split){t.interactions.Split instanceof H?this._interactions.Split=t.interactions.Split:this._interactions.Split=new H({sources:this._source});var i=new p({className:"ol-split",title:this._getTitle(t.interactions.Split)||"Split",name:"Split",interaction:this._interactions.Split});this.addControl(i)}if(!1!==t.interactions.Offset){t.interactions.Offset instanceof V?this._interactions.Offset=t.interactions.Offset:this._interactions.Offset=new V({source:this._source});var r=new p({html:"<i></i>",className:"ol-offset",title:this._getTitle(t.interactions.Offset)||"Offset",name:"Offset",interaction:this._interactions.Offset});this.addControl(r)}};e["a"]=et},d803:function(t,e,i){"use strict";var r=i("c2d3"),o=i("e300"),n=i("4334"),s=i("3e6b"),a=i("35a7"),c=i("5831");(function(){var t=c["a"].prototype.clear;c["a"].prototype.clear=function(e){this.dispatchEvent({type:"clearstart"}),t.call(this,e),this.dispatchEvent({type:"clearend"})}})();var h=function(t){t||(t={}),n["a"].call(this,{handleEvent:function(){return!0}}),this._undoStack=new o["a"],this._redoStack=new o["a"],this._undo=[],this._redo=[],this._undoStack.on("add",function(t){void 0===t.element.level?(t.element.level=this._level,t.element.level||(t.element.view={center:this.getMap().getView().getCenter(),zoom:this.getMap().getView().getZoom()},this._undo.push(t.element))):t.element.level||this._undo.push(this._redo.shift()),t.element.level||this.dispatchEvent({type:"stack:add",action:t.element}),this._reduce()}.bind(this)),this._undoStack.on("remove",function(t){t.element.level||(this._doShift?this._undo.shift():this._undo.length&&this._redo.push(this._undo.pop()),this._doClear||this.dispatchEvent({type:"stack:remove",action:t.element,shift:this._doShift}))}.bind(this)),this._block=0,this._level=0,this._doShift=!1,this._record=!0,this._defs={}};Object(r["a"])(h,n["a"]),h.prototype.define=function(t,e,i){this._defs[t]={undo:e,redo:i}},h.prototype.length=function(t){return"redo"===t?this._redo.length:this._undo.length},h.prototype.setMaxLength=function(t){t=parseInt(t),t&&t<0&&(t=0),this.set("maxLength",t),this._reduce()},h.prototype.size=function(t){return"redo"===t?this._redoStack.getLength():this._undoStack.getLength()},h.prototype.setMaxSize=function(t){t=parseInt(t),t&&t<0&&(t=0),this.set("maxSize",t),this._reduce()},h.prototype._reduce=function(){if(this.get("maxLength"))while(this.length()>this.get("maxLength"))this.shift();if(this.get("maxSize"))while(this.length()>1&&this.size()>this.get("maxSize"))this.shift()},h.prototype.getStack=function(t){return"redo"===t?this._redo:this._undo},h.prototype.push=function(t,e,i){return this._defs[t]?(this._undoStack.push({type:t,name:i,custom:!0,prop:e}),!0):(console.warn('[UndoRedoInteraction]: "'+t+'" is not defined.'),!1)},h.prototype.shift=function(){this._doShift=!0;var t=this._undoStack.removeAt(0);if(this._doShift=!1,"blockstart"===t.type){t=this._undoStack.item(0);while(this._undoStack.getLength()&&t.level>0)this._undoStack.removeAt(0),t=this._undoStack.item(0)}},h.prototype.setActive=function(t){n["a"].prototype.setActive.call(this,t),this._record=t},h.prototype.setMap=function(t){this._mapListener&&this._mapListener.forEach((function(t){Object(a["b"])(t)})),this._mapListener=[],n["a"].prototype.setMap.call(this,t),t&&(this._mapListener.push(t.on("undoblockstart",this.blockStart.bind(this))),this._mapListener.push(t.on("undoblockend",this.blockEnd.bind(this)))),this._watchSources(),this._watchInteractions()},h.prototype._watchSources=function(){var t=this.getMap();function e(t,i){return i||(i=[]),t.forEach((function(t){t instanceof s["a"]?i.push(t):t.getLayers&&e(t.getLayers(),i)})),i}if(this._sourceListener&&this._sourceListener.forEach((function(t){Object(a["b"])(t)})),this._sourceListener=[],t){var i=e(t.getLayers());i.forEach(function(t){var e=t.getSource();this._sourceListener.push(e.on(["addfeature","removefeature"],this._onAddRemove.bind(this))),this._sourceListener.push(e.on("clearstart",function(){this.blockStart("clear")}.bind(this))),this._sourceListener.push(e.on("clearend",this.blockEnd.bind(this)))}.bind(this)),this._sourceListener.push(t.getLayers().on(["add","remove"],this._watchSources.bind(this)))}},h.prototype._watchInteractions=function(){var t=this.getMap();this._interactionListener&&this._interactionListener.forEach((function(t){Object(a["b"])(t)})),this._interactionListener=[],t&&(t.getInteractions().forEach(function(t){this._interactionListener.push(t.on(["setattributestart","modifystart","rotatestart","translatestart","scalestart","deletestart","deleteend","beforesplit","aftersplit"],this._onInteraction.bind(this)))}.bind(this)),this._interactionListener.push(t.getInteractions().on(["add","remove"],this._watchInteractions.bind(this))))},h.prototype._onAddRemove=function(t){this._record&&(this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:t.type,source:t.target,feature:t.feature}))},h.prototype._onInteraction=function(t){var e=this._onInteraction[t.type];e&&e.call(this,t)},h.prototype._onInteraction.setattributestart=function(t){this.blockStart(t.target.get("name")||"setattribute");var e=Object.assign({},t.properties);t.features.forEach(function(t){var i={};for(var r in e)i[r]=t.get(r);this._undoStack.push({type:"changeattribute",feature:t,newProperties:e,oldProperties:i})}.bind(this)),this.blockEnd()},h.prototype._onInteraction.rotatestart=h.prototype._onInteraction.translatestart=h.prototype._onInteraction.scalestart=h.prototype._onInteraction.modifystart=function(t){this.blockStart(t.type.replace(/start$/,"")),t.features.forEach(function(t){this._undoStack.push({type:"changegeometry",feature:t,oldGeom:t.getGeometry().clone()})}.bind(this)),this.blockEnd()},h.prototype.blockStart=function(t){this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:"blockstart",name:t}),this._level++},h.prototype._onInteraction.beforesplit=function(){this.blockStart("split")},h.prototype._onInteraction.deletestart=function(){this.blockStart("delete")},h.prototype.blockEnd=function(){this._undoStack.push({type:"blockend"}),this._level--},h.prototype._onInteraction.aftersplit=h.prototype._onInteraction.deleteend=h.prototype.blockEnd,h.prototype._handleDo=function(t,e){if(this.getActive()){if(this._record=!1,t.custom)this._defs[t.type]?e?this._defs[t.type].undo(t.prop):this._defs[t.type].redo(t.prop):console.warn('[UndoRedoInteraction]: "'+t.type+'" is not defined.');else switch(t.type){case"addfeature":e?t.source.removeFeature(t.feature):t.source.addFeature(t.feature);break;case"removefeature":e?t.source.addFeature(t.feature):t.source.removeFeature(t.feature);break;case"changegeometry":var i=t.feature.getGeometry();t.feature.setGeometry(t.oldGeom),t.oldGeom=i;break;case"changeattribute":var r=t.newProperties,o=t.oldProperties;for(var n in o)void 0===o?t.feature.unset(n):t.feature.set(n,o[n]);t.oldProperties=r,t.newProperties=o;break;case"blockstart":this._block+=e?-1:1;break;case"blockend":this._block+=e?1:-1;break;default:console.warn('[UndoRedoInteraction]: "'+t.type+'" is not defined.')}this._block<0&&(this._block=0),this._block&&(e?this.undo():this.redo()),this._record=!0,this.dispatchEvent({type:e?"undo":"redo",action:t})}},h.prototype.undo=function(){var t=this._undoStack.item(this._undoStack.getLength()-1);t&&(this._redoStack.push(t),this._undoStack.pop(),this._handleDo(t,!0))},h.prototype.redo=function(){var t=this._redoStack.item(this._redoStack.getLength()-1);t&&(this._undoStack.push(t),this._redoStack.pop(),this._handleDo(t,!1))},h.prototype.clear=function(){this._doClear=!0,this._undo.length=this._redo.length=0,this._undoStack.clear(),this._redoStack.clear(),this._doClear=!1,this.dispatchEvent({type:"stack:clear"})},h.prototype.hasUndo=function(){return this._undoStack.getLength()},h.prototype.hasRedo=function(){return this._redoStack.getLength()};e["a"]=h},da5c:function(t,e,i){"use strict";var r=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();e["a"]=r},e300:function(t,e,i){"use strict";var r=i("835b"),o=i("e269"),n=i("183a"),s=i("cef7"),a=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),c={LENGTH:"length"},h=function(t){function e(e,i,r){var o=t.call(this,e)||this;return o.element=i,o.index=r,o}return a(e,t),e}(s["a"]),l=function(t){function e(e,i){var r=t.call(this)||this;r.on,r.once,r.un;var o=i||{};if(r.unique_=!!o.unique,r.array_=e||[],r.unique_)for(var n=0,s=r.array_.length;n<s;++n)r.assertUnique_(r.array_[n],n);return r.updateLength_(),r}return a(e,t),e.prototype.clear=function(){while(this.getLength()>0)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,r=e.length;i<r;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(c.LENGTH)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new h(n["a"].ADD,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new h(n["a"].REMOVE,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new h(n["a"].REMOVE,r,t)),this.dispatchEvent(new h(n["a"].ADD,e,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(c.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,o=this.array_.length;i<o;++i)if(this.array_[i]===t&&i!==e)throw new r["a"](58)},e}(o["a"]);e["a"]=l},e887:function(t,e,i){"use strict";var r=i("c2d3"),o=i("3900"),n=i("6f9e"),s=function(t){t=t||{};var e=document.createElement("div");e.className=(t.className||"")+" ol-button ol-unselectable ol-control";var i=this,r=this.button_=document.createElement(/ol-text-button/.test(t.className)?"div":"button");r.type="button",t.title&&(r.title=t.title),t.name&&(r.name=t.name),t.html instanceof Element?r.appendChild(t.html):r.innerHTML=t.html||"";var n=function(e){e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),t.handleClick&&t.handleClick.call(i,e)};r.addEventListener("click",n),r.addEventListener("touchstart",n),e.appendChild(r),!t.title&&r.firstElementChild&&(r.title=r.firstElementChild.title),o["a"].call(this,{element:e,target:t.target}),t.title&&this.set("title",t.title),t.title&&this.set("title",t.title),t.name&&this.set("name",t.name)};Object(r["a"])(s,o["a"]),s.prototype.setVisible=function(t){t?n["a"].show(this.element):n["a"].hide(this.element)},s.prototype.setTitle=function(t){this.button_.setAttribute("title",t)},s.prototype.setHtml=function(t){n["a"].setHTML(this.button_,t)},s.prototype.getButtonElement=function(){return this.button_},e["a"]=s},f087:function(t,e,i){"use strict";var r=i("c2d3"),o=i("3900"),n=function(t){t||(t={});var e=document.createElement("div");if(e.classList.add("ol-unselectable","ol-control","ol-bar"),t.className){var i=t.className.split(" ").filter((function(t){return t.length>0}));e.classList.add.apply(e.classList,i)}if(t.group&&e.classList.add("ol-group"),o["a"].call(this,{element:e,target:t.target}),this.set("toggleOne",t.toggleOne),this.set("autoDeactivate",t.autoDeactivate),this.controls_=[],t.controls instanceof Array)for(var r=0;r<t.controls.length;r++)this.addControl(t.controls[r])};Object(r["a"])(n,o["a"]),n.prototype.setVisible=function(t){this.element.style.display=t?"":"none"},n.prototype.getVisible=function(){return"none"!=this.element.style.display},n.prototype.setMap=function(t){o["a"].prototype.setMap.call(this,t);for(var e=0;e<this.controls_.length;e++){var i=this.controls_[e];i.setMap(t)}},n.prototype.getControls=function(){return this.controls_},n.prototype.setPosition=function(t){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right"),t=t.split("-");for(var e=0;e<t.length;e++)switch(t[e]){case"top":case"left":case"bottom":case"right":this.element.classList.add("ol-"+t[e]);break;default:break}},n.prototype.addControl=function(t){this.controls_.push(t),t.setTarget(this.element),this.getMap()&&this.getMap().addControl(t),t.on("change:active",function(e){this.onActivateControl_(e,t)}.bind(this)),t.getActive&&this.onActivateControl_({target:t,active:t.getActive()},t)},n.prototype.deactivateControls=function(t){for(var e=0;e<this.controls_.length;e++)this.controls_[e]!==t&&this.controls_[e].setActive&&this.controls_[e].setActive(!1)},n.prototype.getActiveControls=function(){for(var t,e=[],i=0;t=this.controls_[i];i++)t.getActive&&t.getActive()&&e.push(t);return e},n.prototype.setActive=function(t){if(!t&&this.get("autoDeactivate")&&this.deactivateControls(),t)for(var e,i=this.getControls(),r=0;e=i[r];r++)e.get("autoActivate")&&e.setActive(!0)},n.prototype.onActivateControl_=function(t,e){if(this.get("toggleOne"))if(t.active){var i;for(i=0;i<this.controls_.length;i++)if(this.controls_[i]===e)break;if(i==this.controls_.length)return;this.deactivateControls(this.controls_[i])}else if(!this.getActiveControls().length)for(var r,o=0;r=this.controls_[o];o++)if(r.get("autoActivate")){r.setActive(!0);break}},n.prototype.getControlsByName=function(t){var e=this.getControls();return e.filter((function(e){return e.get("name")===t}))},e["a"]=n},faaa:function(t,e,i){}}]);
//# sourceMappingURL=chunk-4844fb08.bdcc4190.js.map