(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61a8701a"],{"0c2b":function(e,t,a){"use strict";a("787d")},"0f29":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"textEditor",class:e.languageString},[a("div",{staticClass:"sourceHeader"},[e.title?a("strong",[e._v(e._s(e.title))]):e._e(),a("div",{staticClass:"sourceToolbar"},[a("span",{staticClass:"sepr"},[e.editable?a("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:e.confirmClear}},[a("i",{staticClass:"fas fa-file"})]):e._e(),e._t("file-toolbar")],2),e.editable?a("span",{staticClass:"sepr"},[a("button",{attrs:{type:"button",disabled:!e.canUndo,title:"Revert last change"},on:{click:function(t){return e.editor.undo()}}},[a("i",{staticClass:"fas fa-undo-alt"})]),a("button",{attrs:{type:"button",disabled:!e.canRedo,title:"Redo last reverted change"},on:{click:function(t){return e.editor.redo()}}},[a("i",{staticClass:"fas fa-redo-alt"})]),e._t("edit-toolbar")],2):e._e(),a("FullscreenButton",{attrs:{element:e.element}}),e._t("toolbar")],2)]),a("div",{staticClass:"sourceCodeEditor",attrs:{id:e.id}})])},i=[],r=a("025e"),n=a("5472"),o=a("a76e"),l=a("56b3"),u=a.n(l),c=(a("a7be"),a("f9d4"),a("959b"),a("ced6"),a("db91"),a("903e"),a("d7d5"),a("8c33"),a("10b2"),a("0dd0"),a("8822"),a("d2de"),a("4ebc")),d=a.n(c);window.jsonlint=d.a;var p={name:"TextEditor",components:{FullscreenButton:n["a"]},props:{id:String,editable:{type:Boolean,default:!0},value:{required:!0},language:{type:String,default:null},placeholder:{type:String,default:""},title:{type:String}},computed:{...r["a"].mapGetters(["processes"]),languageString(){return"string"===typeof this.language?this.language.toLowerCase():""},editorOptions(){let e={indentUnit:2,lineNumbers:!0,indentWithTabs:!0,matchBrackets:!0,autoCloseBrackets:!0,readOnly:!this.editable,placeholder:this.placeholder};switch(this.languageString){case"r":e.mode="text/x-rsrc";break;case"python":e.mode="text/x-python";break;case"math":e.mode="text/x-mathematica";break;case"markdown":e.mode="text/x-markdown",e.lineWrapping=!0;break;case"javascript":e.mode="text/javascript";break;case"json":case"processgraph":e.mode="application/json",e.gutters=["CodeMirror-lint-markers"],e.lint=!0;break}return e}},data(){return{canUndo:!1,canRedo:!1,editor:null,emitValue:this.value,element:null}},watch:{async value(){this.emitValue!==this.value&&(this.updateContent(),this.editor.clearHistory())},editorOptions(){for(var e in this.editorOptions)this.editor.setOption(e,this.editorOptions[e]);this.updateContent()}},mounted(){this.editor=u()(document.getElementById(this.id),this.editorOptions),this.editor.setSize(null,"100%"),"processgraph"===this.languageString&&this.editor.on("change",()=>this.updateState()),this.updateContent(),this.editor.on("changes",(e,t)=>{try{0===Object.values(t).filter(e=>"setValue"===e.origin).length&&this.commit()}catch(a){this.$emit("error",a)}}),this.element=this.$el},methods:{confirmClear(){var e=confirm("Do you really want to clear the existing code?");e&&(this.insert(""),this.emit(null))},updateState(){this.editor.setOption("lint",!!this.editor.getValue().trim());let e=this.editor.getDoc().historySize();this.canUndo=e.undo>0,this.canRedo=e.redo>0,this.editor.refresh(),this.element=this.$el},commit(){var e=this.editor.getValue();switch(this.languageString){case"math":return this.emit(e.replace(/[\r\n\t]+/," "));case"processgraph":if(e){var t=JSON.parse(e);if(r["a"].size(t)>0){var a=new o["ProcessGraph"](t,this.processes);return a.allowEmpty(),a.parse(),this.emit(t)}}return this.emit(null);case"json":return e?this.emit(JSON.parse(e)):this.emit(null);default:return this.emit(e)}},emit(e){this.emitValue=e,this.$emit("input",e)},insert(e,t=!0){if("string"!==typeof e&&(e=String(e)),t){const t=this.editor.getValue();if(e!==t){const t=this.editor.getScrollInfo();this.editor.setValue(e),this.editor.scrollTo(t.left,t.top)}}else this.editor.replaceSelection(e)},updateContent(){if(this.value)switch(this.languageString){case"processgraph":r["a"].isObject(this.value)?this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit)):this.insert("");break;case"json":this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit));break;default:this.insert(this.value)}else this.insert("");this.editor.getDoc().clearHistory(),this.updateState()},insertProcess(e){try{this.insert(JSON.stringify(e,null,2),!1)}catch(t){r["a"].exception(this,t)}}}},m=p,h=(a("4f8c"),a("ccbe"),a("2877")),f=Object(h["a"])(m,s,i,!1,null,"100002bb",null);t["a"]=f.exports},"206d":function(e,t,a){},3916:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.selectedSchema?a("div",{staticClass:"fieldContainer"},[e.showDataTypeChooser?a("div",{staticClass:"dataTypeChooser"},[a("select",{attrs:{name:"dataType",disabled:!e.editable},domProps:{value:e.selectedType},on:{input:e.onSelectType}},[e.selectableTypes.length>1?e._l(e.selectableTypes,(function(t){return a("optgroup",{key:t.name,attrs:{label:t.name}},e._l(t.types,(function(t){return a("option",{key:t.dataType(),domProps:{value:t.dataType()}},[e._v(e._s(e._f("dataTypeTitle")(t)))])})),0)})):e._l(e.selectableTypes[0].types,(function(t){return a("option",{key:t.dataType(),domProps:{value:t.dataType()}},[e._v(e._s(e._f("dataTypeTitle")(t)))])}))],2)]):e._e(),!e.isItem&&e.selectedSchema.description()?a("div",{staticClass:"description"},[a("i",{staticClass:"fas fa-info-circle"}),a("Description",{attrs:{description:e.selectedSchema.description(),compact:!0}})],1):e._e(),a("ParameterDataType",{attrs:{editable:e.editable,parameter:e.parameter,schema:e.selectedSchema,context:e.context,parent:e.parent},on:{changeType:e.setSelected},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1):e._e()},i=[],r=a("025e"),n=a("a76e"),o=a("783b"),l=a.n(o),u=a("fbda"),c=null;class d extends n["JsonSchemaValidator"]{static create(e){return null===c&&(c=new d(e)),c}constructor(e){super(),this.store=e,this.setFileFormats(this.store.getters.fileFormats)}async validateBandName(e){return e.length>0}async validateEpsgCode(e){if(await this.store.dispatch("editor/loadEpsgCodes"),this.store.state.editor.epsgCodes[e])return!0;throw new l.a.ValidationError([{message:"Invalid EPSG code '"+e+"' specified."}])}async validateCollectionId(e){if(this.store.state.collections.filter(t=>t.id===e).length>0)return!0;throw new l.a.ValidationError([{message:"Collection with id '"+e+"' doesn't exist."}])}async validateFilePath(e){if(this.store.getters["files/getById"](e))return!0;throw new l.a.ValidationError([{message:"File at '"+e+"' doesn't exist."}])}async validateInputFormatOptions(e){throw"Not supported"}async validateOutputFormatOptions(e){throw"Not supported"}async validateJobId(e){if(this.store.getters["jobs/getById"](e))return!0;throw new l.a.ValidationError([{message:"Job with id '"+e+"' doesn't exist."}])}async validateUri(e){if(e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/))return!0;throw new l.a.ValidationError([{message:"URI is invalid"}])}async validateUdfCode(e){if(e.match(/(\r|\n)/))return!0;throw new l.a.ValidationError([{message:"UDF Code is invalid"}])}async validateUdfRuntime(e){if(e in this.store.state.udfRuntimes)return!0;throw new l.a.ValidationError([{message:"UDF runtime '"+e+"' is not supported."}])}async validateUdfRuntimeVersion(e){if(u["Versions"].validate(e))return!0;throw new l.a.ValidationError([{message:"UDF runtime version '"+e+"' is not a valid version number."}])}}var p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fieldEditorContainer"},[e.isResult?[a("div",{staticClass:"fieldValue externalData fromNode"},[a("span",[e._v("Output of "),a("tt",[e._v("#"+e._s(e.state.from_node))])],1)]),"array"===e.nativeParameterType?a("button",{attrs:{type:"button"},on:{click:function(t){return e.convertToArray()}}},[a("i",{staticClass:"fas fa-list"}),e._v(" Convert to array")]):e._e()]:"raster-cube"===e.type||"vector-cube"===e.type?a("div",{staticClass:"fieldValue description"},[a("i",{staticClass:"fas fa-exclamation-circle"}),a("p",[e._v('This parameter can only be set by creating a connection between an "Output" / "Result" and this parameter in the Visual Model.')])]):e.isPgParameter?[a("div",{staticClass:"fieldValue externalData fromArgument"},[a("span",[e._v("Value of process parameter "),a("tt",[e._v(e._s(e.state.from_parameter))])],1)]),"array"===e.nativeParameterType?a("button",{attrs:{type:"button"},on:{click:function(t){return e.convertToArray()}}},[a("i",{staticClass:"fas fa-list"}),e._v(" Convert to array")]):e._e()]:"undefined"===e.type?a("div",{staticClass:"description"},[a("i",{staticClass:"fas fa-info-circle"}),a("p",[e._v("No value is set.")])]):"null"===e.type?a("div",{staticClass:"description"},[a("i",{staticClass:"fas fa-info-circle"}),a("p",[e._v("This is set to "),a("strong",[a("tt",[e._v("null")])],1),e._v(", which is usually used as placeholder for no-data values or a default value.")])]):e.isSelection?a("SelectBox",{key:e.type,attrs:{type:e.type,editable:e.editable,schema:e.schema,context:e.dependency},on:{onDetails:e.onSelectDetails},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):e.isTemporal?a("TemporalPicker",{key:e.type,attrs:{type:e.type,editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"bounding-box"===e.type?a("MapAreaSelect",{key:e.type,staticClass:"areaSelector",attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"geojson"===e.type?a("GeoJsonEditor",{key:e.type,staticClass:"geoJsonEditor",attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"process-graph"===e.type?a("Editor",{staticClass:"callbackEditor",attrs:{editable:e.editable,parent:e.parent,parentSchema:e.schema,showDiscoveryToolbar:!0,defaultValue:e.editorDefaultValue},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"output-format-options"===e.type||"input-format-options"===e.type?a("FileFormatOptionsEditor",{ref:"fileFormatOptionsEditor",attrs:{type:e.type,format:e.dependency},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"budget"===e.type?a("Budget",{attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"duration"===e.type?a("Duration",{attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"kernel"===e.type?a("Kernel",{attrs:{editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"udf-code"===e.type?a("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:e.dependency},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"commonmark"===e.type?a("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:"markdown"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"wkt2-definition"===e.type||"proj-definition"===e.type?a("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"json"==e.type?a("TextEditor",{staticClass:"fieldValue textarea",attrs:{id:e.name,editable:e.editable,language:"json"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):"boolean"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"checkbox",name:e.name,disabled:!e.editable},domProps:{checked:Array.isArray(e.state)?e._i(e.state,null)>-1:e.state},on:{change:function(t){var a=e.state,s=t.target,i=!!s.checked;if(Array.isArray(a)){var r=null,n=e._i(a,r);s.checked?n<0&&(e.state=a.concat([r])):n>-1&&(e.state=a.slice(0,n).concat(a.slice(n+1)))}else e.state=i}}}):"integer"===e.type||"number"===e.type?a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.state,expression:"state",modifiers:{number:!0}}],staticClass:"fieldValue",attrs:{type:"number",min:e.numericMin,max:e.numericMax,step:e.numericStep,name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}):"url"===e.type||"uri"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"url",name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=t.target.value)}}}):"object"===e.nativeType||"array"===e.nativeType?a("ObjectEditor",{attrs:{editable:e.editable,parameter:e.parameter,schema:e.schema,isObject:"object"===e.nativeType,context:e.context},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.state,expression:"state"}],staticClass:"fieldValue",attrs:{type:"text",name:e.name,disabled:!e.editable},domProps:{value:e.state},on:{input:function(t){t.target.composing||(e.state=t.target.value)}}})],2)},m=[],h=a("3115"),f=function(){var e=this,t=this,a=t.$createElement,s=t._self._c||a;return s("div",{class:{editor:!0,array:!t.isObject,object:t.isObject}},[s("div",{staticClass:"buttons"},[t.editable?s("button",{staticClass:"addBtn",attrs:{type:"button",disabled:t.count>=t.maxCount},on:{click:function(e){return t.add()}}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Add")]):t._e(),s("FullscreenButton",{attrs:{element:function(){return e.$el}}})],1),t.elements.length?s("draggable",{attrs:{handle:".mover"},model:{value:t.elements,callback:function(e){t.elements=e},expression:"elements"}},t._l(t.elements,(function(e,a){return s("div",{key:e.id,staticClass:"fieldValue element"},[s("div",{staticClass:"row"},[s("label",{staticClass:"fieldLabel"},[t.isObject&&(e.prop.title||e.prop.required)?[t._v(t._s(e.prop.title||e.key))]:t.isObject?s("input",{directives:[{name:"model",rawName:"v-model",value:e.key,expression:"e.key"}],attrs:{type:"text",disabled:!t.editable},domProps:{value:e.key},on:{input:function(a){a.target.composing||t.$set(e,"key",a.target.value)}}}):[t._v(t._s(a+1))]],2),s("ParameterDataTypes",{attrs:{editable:t.editable,parameter:t.elementSchema(a,e.key),isItem:!0,context:t.context},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"e.value"}}),t.editable&&!e.prop.required?s("button",{staticClass:"deleteBtn",attrs:{disabled:t.count<=t.minCount,type:"button"},on:{click:function(e){return t.remove(a)}}},[s("i",{staticClass:"fas fa-trash"})]):t._e(),s("button",{directives:[{name:"show",rawName:"v-show",value:t.editable&&!t.isObject,expression:"editable && !isObject"}],staticClass:"mover",attrs:{type:"button"}},[s("i",{staticClass:"fas fa-arrows-alt"})])],1),e.prop.description?s("div",{staticClass:"row"},[s("div",{staticClass:"description"},[s("i",{staticClass:"fas fa-info-circle"}),s("Description",{attrs:{description:e.prop.description,compact:!0}})],1)]):t._e()])})),0):s("div",{staticClass:"empty description"},[s("i",{staticClass:"fas fa-info-circle"}),t.isObject?[t._v(" Object is empty")]:[t._v(" Array is empty")]],2)],1)},y=[],b=a("b76a"),g=a.n(b),v=a("8088"),x=a("5472"),w={name:"ObjectEditor",components:{draggable:g.a,Description:v["default"],FullscreenButton:x["a"],ParameterDataTypes:()=>Promise.resolve().then(a.bind(null,"3916"))},props:{parameter:Object,editable:{type:Boolean,default:!0},schema:Object,value:{},isObject:{type:Boolean,default:!1},context:{}},data(){return{elements:[]}},computed:{count(){return r["a"].size(this.elements)},maxCount(){return(this.isObject?this.schema.schema.maxProperties:this.schema.schema.maxItems)||Number.MAX_VALUE},minCount(){return(this.isObject?this.schema.schema.minProperties:this.schema.schema.minItems)||0},prefill(){let e=this.schema.schema;if(this.isObject&&r["a"].isObject(e.properties)){let t=[];for(let a in e.properties){let s=!1;Array.isArray(e.required)&&e.required.includes(a)&&(s=!0),t.push(Object.assign({name:a,required:s},e.properties[a]))}return t}return!this.isObject&&this.minCount>0?[...Array(this.minCount).keys()].map(e=>({name:e})):[]},newValue(){if(this.isObject){let e={};for(let t of this.elements)e[t.key]=t.value;return e}return this.elements.map(e=>e.value)}},watch:{newValue:{deep:!0,handler(e){this.$emit("input",e)}},value:{immediate:!0,handler(e){if(this.newValue!==e)if(this.elements=[],0===r["a"].size(e)&&this.prefill.length>0)for(let t of this.prefill)this.add(t.name,void 0,t);else if(e&&"object"===typeof e)for(let t in e)this.add(t,e[t])}}},methods:{elementSchema(e,t=null){let a=u["ProcessUtils"].getElementJsonSchema(this.schema.schema,t||e),s=new u["ProcessSchema"](a);return this.schema.parent instanceof u["ProcessSchema"]&&(s.refs=this.schema.parent.refs||[]),s},add(e=null,t,a={}){let s={id:String(this.elements.length),value:t};this.isObject&&(s.key=e||"unnamed"+this.elements.length),s.prop=a,"undefined"===typeof s.value&&("undefined"!==typeof a.default?s.value=a.default:s.value=this.elementSchema(this.elements.length,s.key).default),this.elements.push(s)},remove(e){this.elements.splice(e,1)}}},T=w,S=(a("92e6"),a("2877")),C=Object(S["a"])(T,f,y,!1,null,"4763cdea",null),j=C.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"datatypeEditor budget"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.hasBudget,expression:"hasBudget"}],attrs:{type:"checkbox",disabled:!e.editable},domProps:{checked:Array.isArray(e.hasBudget)?e._i(e.hasBudget,null)>-1:e.hasBudget},on:{change:function(t){var a=e.hasBudget,s=t.target,i=!!s.checked;if(Array.isArray(a)){var r=null,n=e._i(a,r);s.checked?n<0&&(e.hasBudget=a.concat([r])):n>-1&&(e.hasBudget=a.slice(0,n).concat(a.slice(n+1)))}else e.hasBudget=i}}}),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.amount,expression:"amount",modifiers:{number:!0}}],attrs:{type:"number",min:"0.00",max:e.max,step:"0.01",disabled:!e.hasBudget||!e.editable},domProps:{value:e.amount},on:{input:function(t){t.target.composing||(e.amount=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e._v(" "+e._s(e.capabilities.currency())+" ")])},O=[],k={name:"Budget",computed:{...r["a"].mapState(["userInfo"]),...r["a"].mapGetters(["capabilities"]),max(){return this.userInfo.budget>0?this.userInfo.budget:Number.MAX_VALUE}},props:{value:{type:Number,default:null},editable:{type:Boolean,default:!0}},data(){return{hasBudget:"number"===typeof this.value,amount:this.value}},watch:{hasBudget(){this.updateData()},amount(){this.updateData()}},methods:{updateData(){this.$emit("input",this.hasBudget&&!Number.isNaN(this.amount)?this.amount:null)}}},E=k,F=Object(S["a"])(E,_,O,!1,null,null,null),P=F.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:e.id}},[a("ProgressControl",{ref:"progress",attrs:{map:e.map}}),a("TextControl",{attrs:{text:e.help,map:e.map}})],1)},D=[],B=a("4bc5"),N=a("eb48"),A=a("256f"),I=a("0af5"),R=a("6c77"),$=a("4749"),M={name:"MapAreaSelect",mixins:[B["a"]],components:{TextControl:$["a"]},props:{value:{type:[Object,Array],default:()=>null}},data(){let e=null;return r["a"].isObject(this.value)&&"west"in this.value&&"south"in this.value&&"east"in this.value&&"north"in this.value?e=[this.value.west,this.value.south,this.value.east,this.value.north]:Array.isArray(this.value)&&value.length>=4&&(e=this.value),{interaction:null,extent:e}},computed:{returnAsObject(){return!Array.isArray(this.value)},projectedExtent(){return this.extent?Object(A["w"])(this.extent,"EPSG:4326",this.map.getView().getProjection()):null},bbox(){return r["a"].extentToBBox(this.extent)},help(){return this.extent?"Click inside the bounding box to remove it.":"Click on the map to add a bounding box."}},methods:{update(e){e.extent?this.extent=Object(A["w"])(e.extent,this.map.getView().getProjection(),"EPSG:4326"):this.extent=null,this.$emit("input",this.returnAsObject?this.bbox:this.extent)},ensureValidExtent(e){return e?[Math.max(e[0],-180),Math.max(e[1],-90),Math.min(e[2],180),Math.min(e[3],90)]:e},async renderMap(){let e=!1!==r["a"].isBboxInWebMercator(this.bbox);await this.createMap(e?"EPSG:3857":"EPSG:4326"),this.addBasemaps();let t=e=>{if(!this.editable)return!1;if("singleclick"===e.type){if(!this.extent){let t=this.map.getSize().map(e=>.2*e),a=this.map.getView().calculateExtent(t),s=[a[2]-a[0],a[3]-a[1]],i=[e.coordinate[0]-s[0],e.coordinate[1]-s[1],e.coordinate[0]+s[0],e.coordinate[1]+s[1]];return this.interaction.setExtent(i),!1}Object(I["h"])(this.projectedExtent,...e.coordinate)&&(this.interaction.setExtent(null),this.interaction.vertexOverlay_.getSource().clear(),this.interaction.vertexFeature_=null)}else if(this.interaction.handlingDownUpSequence||this.interaction.snapToVertex_(e.pixel,e.map))return!0;return!1};if(this.interaction=new N["a"]({extent:this.projectedExtent,condition:t,boxStyle:Object(R["a"])(),pixelTolerance:15}),this.editable&&this.interaction.on("extentchanged",this.update),this.map.addInteraction(this.interaction),this.projectedExtent){var a=this.getFitOptions(this.editable?10:33);this.map.getView().fit(this.projectedExtent,a)}}}},U=M,J=(a("63a9"),Object(S["a"])(U,V,D,!1,null,null,null)),G=J.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Tabs",{ref:"tabs",staticClass:"geojson-editor",attrs:{id:"geojson-tabs",position:"bottom"}},[a("Tab",{attrs:{id:"map",name:"Map",icon:"fa-map",selected:!0},on:{show:e.showMap}},[a("GeoJsonMapEditor",{ref:"map",attrs:{editable:e.editable,value:e.value},on:{input:e.commit}})],1),a("Tab",{attrs:{id:"source",name:"Code",icon:"fa-code"},on:{show:e.showCode}},[a("TextEditor",{ref:"sourceEditor",attrs:{editable:e.editable,value:e.value,id:"geojson-texteditor",language:"json"},on:{input:e.commit}})],1)],1)},q=[],L=a("e7ea"),Y=a("bdb2"),Z=a("26e7"),W=a("0f29"),H={name:"GeoJsonEditor",components:{GeoJsonMapEditor:Z["a"],Tab:Y["default"],Tabs:L["default"],TextEditor:W["a"]},props:{editable:{type:Boolean,default:!0},value:{type:Object,default:null}},data(){return{}},methods:{showMap(){this.$refs.map.renderMap()},showCode(){this.$refs.sourceEditor.updateState()},commit(e){this.$emit("input",e)}}},K=H,X=Object(S["a"])(K,z,q,!1,null,null,null),Q=X.exports,ee={name:"ParameterDataType",mixins:[h["a"]],components:{ObjectEditor:j,Budget:P,MapAreaSelect:G,GeoJsonEditor:Q,TextEditor:W["a"],Editor:()=>a.e("chunk-c8785be4").then(a.bind(null,"ceb0")),FileFormatOptionsEditor:()=>a.e("chunk-6896d764").then(a.bind(null,"eeea")),ParameterDataTypes:()=>Promise.resolve().then(a.bind(null,"3916")),Duration:()=>a.e("chunk-2d17c1ef").then(a.bind(null,"0924")),Kernel:()=>a.e("chunk-5981a7e2").then(a.bind(null,"17bb")),SelectBox:()=>a.e("chunk-160cff8a").then(a.bind(null,"3e57")),TemporalPicker:()=>a.e("chunk-68669eba").then(a.bind(null,"cca6"))},props:{parameter:Object,editable:{type:Boolean,default:!0},schema:Object,value:{},context:{},parent:{}},data(){return{state:this.value}},computed:{type(){return this.schema.dataType()},nativeType(){return this.schema.nativeDataType()},nativeParameterType(){return this.parameter.nativeDataType()},editorDefaultValue(){if("process-graph"===this.type){if("undefined"!==typeof this.parameter.default)return this.parameter.default;if(this.parameter.nullable())return null}},isTemporal(){return"date"===this.type||"time"===this.type||"date-time"===this.type||"temporal-interval"===this.type||"year"===this.type},isSelection(){switch(this.type){case"collection-id":case"job-id":case"file-path":case"file-paths":case"epsg-code":case"input-format":case"openeo-datatype":case"output-format":case"service-type":case"billing-plan":case"udf-runtime":case"udf-runtime-version":return!0;case"band-name":return!!this.dependency;default:return this.schema.isEnum()}},name(){return this.parameter.name+(Array.isArray(this.parameter.value)?"[]":"")},isResult(){return Boolean(r["a"].isObject(this.state)&&this.state.from_node&&1===r["a"].size(this.state)&&this.schema.schema.isRef)},isPgParameter(){return Boolean(r["a"].isObject(this.state)&&this.state.from_parameter&&1===r["a"].size(this.state)&&this.schema.schema.isRef)},numericMin(){return"number"===typeof this.schema.minimum?this.schema.minimum:""},numericMax(){return"number"===typeof this.schema.maximum?this.schema.maximum:""},numericStep(){return"number"===typeof this.schema.multipleOf?this.schema.multipleOf:"integer"===this.type?1:"any"},newValue(){if("number"===this.type){var e=Number.parseFloat(this.state);return Number.isNaN(e)?null:e}if("integer"===this.type){e=Number.parseInt(this.state);return Number.isNaN(e)?null:e}if("null"===this.type)return null;if("string"===typeof this.state&&this.state.length>0&&("any"===this.type||"mixed"===this.type)){e=Number(this.state);return Number.isNaN(e)?this.state:e}return this.state},dependency(){switch(this.type){case"output-format-options":case"input-format-options":return this.getValueFromOtherParameterByDataType(this.type.replace("-options",""));case"udf-runtime-version":case"udf-code":return this.getValueFromOtherParameterByDataType("udf-runtime");case"band-name":return this.getValueFromOtherParameterByDataType("collection-id");default:return}}},watch:{value(e){e!==this.newValue&&(this.state=this.value)},newValue(e){this.$emit("input",e)}},methods:{getValueFromOtherParameterByDataType(e){if(r["a"].isObject(this.context)&&r["a"].isObject(this.context.schemas)&&r["a"].isObject(this.context.values))for(let t in this.context.schemas){let a=this.context.schemas[t];if(r["a"].isObject(a)&&a.dataType()===e)return this.context.values[t]}},convertToArray(){this.state=[this.state],this.$emit("input",this.state),this.$emit("changeType","array")},onSelectDetails(){"collection-id"===this.type&&this.emit("showCollection",this.state)}}},te=ee,ae=(a("0c2b"),Object(S["a"])(te,p,m,!1,null,"54c8dfc2",null)),se=ae.exports,ie=a("ab90");const re=["Basics","References","Spatial","Temporal","File and Folders","Resources","CRS","UDF","Other"],ne=e=>e&&"object"===typeof e?r["a"].deepClone(e):e,oe=()=>(new Date).toISOString().replace(/\.\d+/,""),le=[{subtype:"undefined",title:"No Value",const:void 0,group:"Basics"},{type:"null",const:null,group:"Basics"},{type:"string",default:"",group:"Basics"},{type:"integer",default:0,group:"Basics"},{type:"number",default:0,group:"Basics"},{type:"boolean",default:!1,group:"Basics"},{type:"array",default:[],group:"Basics"},{type:"object",default:{},group:"Basics",properties:{from_node:{not:{}},from_parameter:{not:{}}}},{type:"string",subtype:"date-time",format:"date-time",title:"Date and Time",group:"Temporal",default:()=>oe()},{type:"string",subtype:"date",format:"date",title:"Date only",group:"Temporal",default:()=>oe().substring(0,10)},{type:"string",subtype:"time",format:"time",title:"Time only",group:"Temporal",default:()=>oe().substring(11)},{type:"string",subtype:"year",title:"Year only",group:"Temporal"},{type:"array",subtype:"temporal-interval",title:"Temporal interval",group:"Temporal"},{type:"array",subtype:"temporal-intervals",title:"Temporal intervals (multiple)",group:"Temporal",default:[]},{type:"object",subtype:"geojson",title:"GeoJSON",group:"Spatial"},{type:"object",subtype:"bounding-box",title:"Bounding Box",group:"Spatial"},{type:"string",subtype:"band-name",title:"Band",group:"Resources"},{type:"string",subtype:"collection-id",title:"Collection",group:"Resources"},{type:"string",subtype:"job-id",title:"Batch Job",group:"Resources"},{type:"string",subtype:"udf-code",title:"UDF Source Code",group:"UDF",default:""},{type:"string",subtype:"udf-runtime",title:"UDF Runtime",group:"UDF"},{type:"string",subtype:"udf-runtime-version",title:"UDF Runtime Version",group:"UDF",any:!1},{type:"integer",subtype:"epsg-code",title:"EPSG Code (CRS)",group:"CRS"},{type:"string",subtype:"proj-definition",title:"PROJ defintiion (CRS)",group:"CRS",default:""},{type:"string",subtype:"wkt2-definition",title:"WKT2 defintiion (CRS)",group:"CRS",default:""},{type:"array",subtype:"file-path",title:"File path",group:"File and Folders"},{type:"array",subtype:"file-paths",title:"File paths (multiple)",group:"File and Folders",default:[]},{type:"string",subtype:"uri",format:"uri",title:"URI / URL",group:"File and Folders"},{type:"string",subtype:"output-format",title:"Export file format",group:"File and Folders"},{type:"object",subtype:"output-format-options",title:"Export file format parameters",group:"File and Folders",any:!1},{type:"string",subtype:"input-format",title:"Import file format",group:"File and Folders"},{type:"object",subtype:"input-format-options",title:"Import file format parameters",group:"File and Folders",any:!1},{type:"object",subtype:"process-graph",title:"Custom Process"},{tyoe:"object",subtype:"json-schema",title:"Data Type (JSON Schema)",any:!1},{subtype:"json",title:"JSON",noAutoDetect:!0}],ue={type:"object",additionalProperties:!1,properties:{from_node:{type:"string"},from_parameter:{type:"string"}}};var ce={name:"ParameterDataTypes",mixins:[h["a"]],components:{Description:v["default"],ParameterDataType:se},props:{parameter:{type:Object,default:()=>new u["ProcessParameter"]({})},editable:{type:Boolean,default:!0},value:{},isItem:{type:Boolean,default:!1},context:{},parent:{}},data(){return{state:"undefined"===typeof this.value?ne(this.parameter.default):this.value,selectedType:null,selectedNativeType:null,selectedSchema:null,jsonSchemaValidator:d.create(this.$store)}},filters:{dataTypeTitle(e){if(e.schema&&!e.schema.title){let t=le.find(t=>t.subtype===e.schema.subtype||t.type===e.schema.type);if(t&&t.title)return t.title}return e.title()}},async created(){await this.detectType()},computed:{refSchemas(){if(!Array.isArray(this.parameter.refs))return{};let e={};for(let t of this.parameter.refs){let a;t.from_node?(a="from_node:"+t.from_node,e[a]=new u["ProcessDataType"]({type:"object",group:"References",subtype:a,isRef:"from_node",from_node:t.from_node,title:"Output of #"+t.from_node,required:["from_node"],properties:{from_node:{type:"string",const:t.from_node}},default:t,additionalProperties:!1})):t.from_parameter&&(a="from_parameter:"+t.from_parameter,e[a]=new u["ProcessDataType"]({type:"object",group:"References",subtype:a,isRef:"from_parameter",from_parameter:t.from_parameter,title:'Value of process parameter "'+t.from_parameter+'"',required:["from_parameter"],properties:{from_parameter:{type:"string",const:t.from_parameter}},default:t,additionalProperties:!1}))}return e},showDataTypeChooser(){return r["a"].size(this.allowedTypes)>1},allowedTypes(){let e={};if("any"===this.parameter.dataType())Object.assign(e,this.supportedTypes);else for(let t of this.parameter.schemas){let a=t.dataType();e[a]=t}return Object.assign(e,this.refSchemas),e},supportedTypes(){let e={};for(let t of le){if(!1===t.any)continue;let a=t.subtype||t.type,s=Object.assign({},ie["API_TYPES"][a],t);e[a]=new u["ProcessDataType"](s,this.parameter)}return e},selectableTypes(){let e={};for(let a in this.allowedTypes){let t=this.allowedTypes[a],s=t.group();Array.isArray(e[s])?e[s].push(t):e[s]=[t]}let t=re.map(t=>({name:t,types:e[t]||[]})).filter(e=>0!==e.types.length);return t}},watch:{value(e){e!==this.state&&(this.state=e)},state:{deep:!0,handler(e){this.$emit("input",e)}},selectedType(e){this.$emit("schemaSelected",this.supportedTypes[e])}},methods:{async isValueInvalid(e,t){let a=r["a"].deepClone(t);"array"===a.type&&r["a"].isObject(a.items)&&(a.items={oneOf:[a.items,ue]});let s=await this.jsonSchemaValidator.validateValue(e,a);return s.length>0},async getTypeForValue(e,t){var a=[];for(var s of e)try{if(await this.isValueInvalid(t,s.schema))continue;a.push(s.dataType())}catch(i){}return a},async detectType(){let e=Object.keys(this.allowedTypes),t="undefined"===typeof this.state;if(0===e.length)await this.setSelected("json");else if(1===e.length)await this.setSelected(e[0],t);else if(t){let t=e.filter(e=>"null"!==e);await this.setSelected(t[0],!0)}else{let e=Object.values(this.allowedTypes).filter(e=>!e.schema.noAutoDetect),t=await this.getTypeForValue(e,this.state);if(0===t.length)await this.setSelected("json");else if(1===t.length)await this.setSelected(t[0]);else{t.includes("integer")&&t.includes("number")&&(t=t.filter(e=>"integer"!==e)),!r["a"].isRef(this.state)&&t.length>1&&console.warn("A parameter is ambiguous. Potential types: "+t.join(", ")+". Value: "+JSON.stringify(this.state));let e=t.findIndex(e=>ie["NATIVE_TYPES"].includes(e));-1===e&&(e=0),await this.setSelected(t[e])}}},async onSelectType(e){await this.setSelected(e.target.value,!0)},async setSelected(e,t=!1){let a=e;if(e instanceof u["ProcessDataType"]?(this.selectedSchema=e,this.selectedType=e.dataType(),a=e.nativeDataType()):(this.selectedSchema=this.allowedTypes[e]?this.allowedTypes[e]:this.supportedTypes[e],this.selectedType=e),t){if("number"===typeof this.state&&"string"===a)this.state=String(this.state);else if("string"===typeof this.state&&"integer"===a){if(this.state.match(/^([+-]?\d+)$/)){let e=Number.parseInt(this.state,10);Number.isNaN(e)||(this.state=e)}}else if("string"===typeof this.state&&"number"===a){let e=Number.parseFloat(this.state);Number.isNaN(e)||(this.state=e)}if(this.selectedSchema.isNull())this.state=null;else if("undefined"!==typeof this.selectedSchema.const)this.state=this.selectedSchema.const;else if(this.selectedSchema.isEnum()&&1===this.selectedSchema.getEnumChoices().length)this.state=this.selectedSchema.getEnumChoices()[0];else{let e=ne(this.selectedSchema.default());try{("undefined"===typeof this.state||await this.isValueInvalid(this.state,this.selectedSchema))&&(this.state=e)}catch(s){this.state=e}}}}}},de=ce,pe=(a("5577"),Object(S["a"])(de,s,i,!1,null,null,null));t["default"]=pe.exports},4525:function(e,t,a){},"4f8c":function(e,t,a){"use strict";a("65f5")},5472:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{directives:[{name:"show",rawName:"v-show",value:e.element,expression:"element"}],attrs:{type:"button",title:e.isFullscreen?"Close fullscreen":"Show fullscreen"},on:{click:e.toggleFullscreen}},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.isFullscreen,expression:"isFullscreen"}]},[a("i",{staticClass:"fas fa-compress"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isFullscreen,expression:"!isFullscreen"}]},[a("i",{staticClass:"fas fa-expand"})])])},i=[],r=a("3115"),n=a("025e"),o={name:"FullscreenButton",mixins:[r["a"]],props:{element:{required:!0}},data(){return{isFullscreen:!1,keyDownFn:null,oldZIndex:"auto"}},mounted(){this.keyDownFn=this.onkeyDown.bind(this);let e=this.getElement();e&&e.addEventListener("keydown",this.keyDownFn)},beforeDestroy(){let e=this.getElement();e&&e.removeEventListener("keydown",this.keyDownFn)},computed:{...n["a"].mapState("editor",["hightestModalZIndex"])},methods:{...n["a"].mapMutations("editor",["openModal","closeModal"]),onkeyDown(e){!this.isFullscreen||"F11"!==e.key&&"Escape"!==e.key||(this.toggleFullscreen(),e.preventDefault(),e.stopPropagation())},getElement(){return"string"===typeof this.element?document.querySelector(this.element):"function"===typeof this.element?this.element():this.element},toggleFullscreen(){let e=this.getElement();this.isFullscreen?(this.isFullscreen=!1,e.classList.remove("fullscreen"),e.style.zIndex=this.oldZIndex,this.closeModal()):(this.isFullscreen=!0,e.classList.add("fullscreen"),this.openModal(),this.oldZIndex=e.style.zIndex,e.style.zIndex=this.hightestModalZIndex),this.$emit("changed",this.isFullscreen),this.emit("stopTour")}}},l=o,u=(a("90f4"),a("2877")),c=Object(u["a"])(l,s,i,!1,null,null,null);t["a"]=c.exports},5577:function(e,t,a){"use strict";a("a4f1")},"65f5":function(e,t,a){},"787d":function(e,t,a){},"90f4":function(e,t,a){"use strict";a("206d")},"92e6":function(e,t,a){"use strict";a("e946")},a4f1:function(e,t,a){},ab90:function(e,t,a){"use strict";a.r(t),a.d(t,"API_TYPES",(function(){return i})),a.d(t,"NATIVE_TYPES",(function(){return r}));var s=a("025e");const i=s["a"].resolveJsonRefs(a("ff6c")).definitions,r=["string","integer","number","boolean","array","object"]},ccbe:function(e,t,a){"use strict";a("4525")},e946:function(e,t,a){}}]);
//# sourceMappingURL=chunk-61a8701a.d00b0905.js.map