(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-545f4342"],{"0791":function(e,t,s){"use strict";s("c240")},"0921":function(e,t,s){"use strict";var i=s("3115"),a=s("025e"),r=(s("5bc0"),s("c320")),o=s("9d47"),n=s("21bc"),l=s("0af5"),c=s("a2e1"),u=s("5eee"),d=s("a2c7"),h=s("256f"),p=s("480c"),m=s("3e6b"),f=s("5831"),g=s("d0e9"),b=(s("1399"),s("0417")),w=s("3900");class v{constructor(){this.createHtml(),this.loading=0,this.loaded=0}addLoading(){this.loading++,this.update()}addLoaded(){this.loaded++,this.update()}update(){var e=(this.loaded/this.loading*100).toFixed(1)+"%";this.label.innerText="Loading Tiles ("+e+")",this.progressBarInner.style.width=e,this.loading===this.loaded&&(this.loading=0,this.loaded=0),this.el.style.opacity=this.show()?1:0}show(){return this.loading>0&&this.loaded<=this.loading}createHtml(){this.el=document.createElement("div"),this.el.className="ol-unselectable ol-progress-control",this.progressBar=document.createElement("div"),this.progressBar.className="progress-bar",this.progressBarInner=document.createElement("div"),this.progressBarInner.className="progress-bar-inner",this.progressBar.appendChild(this.progressBarInner),this.label=document.createElement("div"),this.label.className="progress-label",this.el.appendChild(this.progressBar),this.el.appendChild(this.label)}getControl(){var e=new w["a"]({element:this.el});return e}}var y,S,C={mixins:[i["a"]],props:{id:{type:String,required:!0},center:{type:Array,default:()=>[0,0]},zoom:{type:Number,default:1},show:{type:Boolean,default:!0},editable:{type:Boolean,default:!0},removableLayers:{type:Boolean,default:!1}},data(){return{map:null,baseLayer:null,osm:null,progress:null,fitOptions:{padding:[30,30,30,30]}}},watch:{show(){this.showMap()}},mounted(){this.showMap()},methods:{showMap(){this.show&&this.$nextTick(()=>this.renderMap())},createMap(e=!1,t="EPSG:3857"){if(null!==this.map)return this.map.updateSize(),void this.map.render();this.progress=new v,this.osm=new g["a"],this.baseLayer=new p["a"]({source:this.trackTileProgress(this.osm),baseLayer:!0,title:"OpenStreetMap",noSwitcherDelete:!0});var s=[new r["a"],new o["a"],this.progress.getControl()];e&&s.push(new b["a"]({trash:this.removableLayers}));let i=[this.center[1],this.center[0]];var a={target:this.id,layers:[this.baseLayer],view:new d["a"]({center:"EPSG:3857"===t?Object(h["d"])(i):i,zoom:this.zoom,showFullExtent:!0,projection:t})};this.editable?a.controls=Object(n["a"])().extend(s):(a.interactions=[],a.controls=s),this.map=new u["a"](a),this.listen("windowResized",this.updateMapSize)},fromLonLat(e){return this.map&&"EPSG:3857"===this.map.getView().getProjection().getCode()?Object(h["d"])(e):e},onShow(){this.listen("windowResized",this.updateMapSize)},onHide(){this.unlisten("windowResized")},renderMap(){this.createMap()},async updateMapSize(){this.map&&(await this.$nextTick(),this.map.updateSize())},getVisibleLayers(){let e=[],t=this.map.getLayers().getArray();for(let s of t)s.get("userLayer")&&s.getVisible()&&e.push(s);return e},addGeoJson(e){var t={};a["a"].detectGeoJson(e)&&(t.features=(new c["a"]).readFeatures(e,{featureProjection:this.osm.getProjection()}));var s=new f["a"](t),i=new m["a"]({title:"GeoJSON",source:s});this.map.addLayer(i);var r=s.getExtent();return Object(l["G"])(r)||this.map.getView().fit(r,this.fitOptions),i},trackTileProgress(e){return e.on("tileloadstart",()=>{this.progress.addLoading()}),e.on("tileloadend",()=>{this.progress.addLoaded()}),e.on("tileloaderror",()=>{this.progress.addLoaded()}),e}}},k=C,x=s("2877"),P=Object(x["a"])(k,y,S,!1,null,null,null);t["a"]=P.exports},"0f29":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textEditor",class:e.languageString},[s("div",{staticClass:"sourceHeader"},[e.title?s("strong",[e._v(e._s(e.title))]):e._e(),s("div",{staticClass:"sourceToolbar"},[s("span",{staticClass:"sepr"},[e.editable?s("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:e.confirmClear}},[s("i",{staticClass:"fas fa-file"})]):e._e(),e._t("file-toolbar")],2),e.editable?s("span",{staticClass:"sepr"},[s("button",{attrs:{type:"button",disabled:!e.canUndo,title:"Revert last change"},on:{click:function(t){return e.editor.undo()}}},[s("i",{staticClass:"fas fa-undo-alt"})]),s("button",{attrs:{type:"button",disabled:!e.canRedo,title:"Redo last reverted change"},on:{click:function(t){return e.editor.redo()}}},[s("i",{staticClass:"fas fa-redo-alt"})]),e._t("edit-toolbar")],2):e._e(),s("FullscreenButton",{attrs:{element:e.element}}),e._t("toolbar")],2)]),s("div",{staticClass:"sourceCodeEditor",attrs:{id:e.id}})])},a=[],r=s("025e"),o=s("5472"),n=s("a76e"),l=s("56b3"),c=s.n(l),u=(s("a7be"),s("f9d4"),s("959b"),s("ced6"),s("db91"),s("903e"),s("d7d5"),s("8c33"),s("10b2"),s("0dd0"),s("8822"),s("d2de"),s("4ebc")),d=s.n(u);window.jsonlint=d.a;var h={name:"TextEditor",components:{FullscreenButton:o["a"]},props:{id:String,editable:{type:Boolean,default:!0},value:{required:!0},language:{type:String,default:null},placeholder:{type:String,default:""},title:{type:String}},computed:{...r["a"].mapGetters(["processes"]),languageString(){return"string"===typeof this.language?this.language.toLowerCase():""},editorOptions(){let e={indentUnit:2,lineNumbers:!0,indentWithTabs:!0,matchBrackets:!0,autoCloseBrackets:!0,readOnly:!this.editable,placeholder:this.placeholder};switch(this.languageString){case"r":e.mode="text/x-rsrc";break;case"python":e.mode="text/x-python";break;case"math":e.mode="text/x-mathematica";break;case"markdown":e.mode="text/x-markdown",e.lineWrapping=!0;break;case"javascript":e.mode="text/javascript";break;case"json":case"processgraph":e.mode="application/json",e.gutters=["CodeMirror-lint-markers"],e.lint=!0;break}return e}},data(){return{canUndo:!1,canRedo:!1,editor:null,emitValue:this.value,element:null}},watch:{async value(){this.emitValue!==this.value&&(this.updateContent(),this.editor.clearHistory())},editorOptions(){for(var e in this.editorOptions)this.editor.setOption(e,this.editorOptions[e]);this.updateContent()}},mounted(){this.editor=c()(document.getElementById(this.id),this.editorOptions),this.editor.setSize(null,"100%"),"processgraph"===this.languageString&&this.editor.on("change",()=>this.updateState()),this.updateContent(),this.editor.on("changes",(e,t)=>{try{0===Object.values(t).filter(e=>"setValue"===e.origin).length&&this.commit()}catch(s){this.$emit("error",s)}}),this.element=this.$el},methods:{confirmClear(){var e=confirm("Do you really want to clear the existing code?");e&&(this.insert(""),this.emit(null))},updateState(){this.editor.setOption("lint",!!this.editor.getValue().trim());let e=this.editor.getDoc().historySize();this.canUndo=e.undo>0,this.canRedo=e.redo>0,this.editor.refresh(),this.element=this.$el},commit(){var e=this.editor.getValue();switch(this.languageString){case"math":return this.emit(e.replace(/[\r\n\t]+/," "));case"processgraph":if(e){var t=JSON.parse(e);if(r["a"].size(t)>0){var s=new n["ProcessGraph"](t,this.processes);return s.allowEmpty(),s.parse(),this.emit(t)}}return this.emit(null);case"json":return e?this.emit(JSON.parse(e)):this.emit(null);default:return this.emit(e)}},emit(e){this.emitValue=e,this.$emit("input",e)},insert(e,t=!0){if("string"!==typeof e&&(e=String(e)),t){const t=this.editor.getValue();if(e!==t){const t=this.editor.getScrollInfo();this.editor.setValue(e),this.editor.scrollTo(t.left,t.top)}}else this.editor.replaceSelection(e)},updateContent(){if(this.value)switch(this.languageString){case"processgraph":r["a"].isObject(this.value)?this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit)):this.insert("");break;case"json":this.insert(JSON.stringify(this.value,null,this.editorOptions.indentUnit));break;default:this.insert(this.value)}else this.insert("");this.editor.getDoc().clearHistory(),this.updateState()},insertProcess(e){try{this.insert(JSON.stringify(e,null,2),!1)}catch(t){r["a"].exception(this,t)}}}},p=h,m=(s("4f8c"),s("ccbe"),s("2877")),f=Object(m["a"])(p,i,a,!1,null,"100002bb",null);t["a"]=f.exports},"15dd":function(e,t,s){"use strict";s("bdf7")},"41a2":function(e,t,s){"use strict";var i=s("2f5c"),a=s("025e");t["a"]=(e,t,s)=>({components:{DataTable:i["a"]},data(){return{columns:{},syncTimer:null,lastSyncTime:null}},mounted(){this.updateData()},beforeDestroy(){this.stopSyncTimer()},computed:{...a["a"].mapState(e,{data:e}),...a["a"].mapGetters(e,["supportsList","supportsCreate","supportsRead","supportsUpdate","supportsDelete"])},methods:{...a["a"].mapActions(e,["list","create","read","update","delete"]),getTable(){return this.$refs&&this.$refs.table?this.$refs.table:null},onShow(){this.updateData(),this.startSyncTimer()},onHide(){this.stopSyncTimer()},startSyncTimer(){this.supportsList&&null===this.syncTimer&&(this.syncTimer=setInterval(this.updateData,this.getSyncInterval()))},stopSyncTimer(){null!==this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)},getSyncInterval(){return 60*this.$config.dataRefreshInterval*1e3},async refreshElement(e,s=null){var i=Object.assign({},e);try{let t=await this.read({data:e});"function"===typeof s&&s(t,i)}catch(r){a["a"].exception(this,r,"Load "+t+" error")}},async updateData(){var e=this.getTable(),i=Date.now()-this.getSyncInterval();if(e&&!(this.lastSyncTime>i))if(this.supportsList)if(this.supportsCreate){var r=this.data.length>0;r||e.setNoData("Loading "+s+"..."),this.lastSyncTime=Date.now();try{let s=await this.list();0==s.length&&e.setNoData("Add your first "+t+" here...")}catch(o){r?console.log(o):(a["a"].exception(this,o),e.setNoData("Sorry, unable to load data from the server."))}}else e.setNoData("Sorry, this feature is not supported by the server.");else e.setNoData("Sorry, listing stored "+s+" is not supported by the server.")}}})},4525:function(e,t,s){},"4d982":function(e,t,s){"use strict";s("c98e")},"4f8c":function(e,t,s){"use strict";s("65f5")},"50e5":function(e,t,s){},"65f5":function(e,t,s){},"79f4":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s("a76e"),a=s("025e");class r extends i["BaseProcess"]{constructor(e,t){super(e),this.exporter=t}async execute(e){await this.exporter.generateFunction(e)}}class o extends i["ProcessGraph"]{constructor(e,t,s){super(a["a"].isObject(e)?e:{},t),this.connection=s,this.indent=0,this.code=[],this.allowEmpty(),this.fillUndefinedParameters()}createProcessGraphInstance(e){let t=new o(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(t)}copyProcessGraphInstanceProperties(e){return e=super.copyProcessGraphInstanceProperties(e),e.connection=this.connection,e}createProcessInstance(e){return new r(e,this)}isKeyword(){return!1}comment(){}generateImports(){}generateConnection(){}generateAuthentication(){}generateBuilder(){}generateMetadata(){}generateMissingParameter(){}async generateFunction(){}generateFunctionParams(e){return e.map(e=>"undefined"!==typeof e.default?`${e.name} = ${this.e(e.default)}`:e.name)}async generateCallback(){}generateResult(){}makeNull(){return"null"}makeBoolean(e){return e?"true":"false"}makeArray(e){return`[${e.join(", ")}]`}makeObject(e){let t=a["a"].mapObject(e,(e,t)=>`${this.makeString(t)}: ${e}`);return`{${t.join(", ")}}`}makeString(e){return JSON.stringify(e)}makeNumber(e){return e}e(e){return null===e?this.makeNull():"boolean"===typeof e?this.makeBoolean(e):"number"===typeof e?this.makeNumber(e):"string"===typeof e?this.makeString(e):Array.isArray(e)?this.makeArray(e.map(e=>this.e(e))):a["a"].isObject(e)?this.makeObject(a["a"].mapObjectValues(e,e=>this.e(e))):"function"===typeof e?e():this.makeNull()}generateMetadata(){let e=!1;for(let t in this.process){if("process_graph"===t)continue;let s=this.process[t];Array.isArray(s)&&0===s.length||("string"===typeof s&&0===s.length||("boolean"!==typeof s||s)&&(e||(this.newLine(),this.comment("Set the metadata for the process"),e=!0),this.generateMetadataEntry(t,s)))}}async resolveArguments(e,t,s){let i=Array.isArray(e)?[]:{};for(let r in e){let n=e[r];if(!s||!s(r,n))if(a["a"].isObject(n)){if(n.from_node){i[r]=()=>this.var(n.from_node);continue}if(n.from_parameter){i[r]=()=>this.var(n.from_parameter);continue}if(n instanceof o){let e=await t(r);i[r]=()=>e;continue}i[r]=await this.resolveArguments(n,t,s)}else Array.isArray(n)?i[r]=await this.resolveArguments(n,t,s):i[r]=n}return i}async resolveCallback(e,t){let s=e.getArgument(t),i=s.getCallbackParameters();await s.execute(i);let a=this.var(e.id,"fn"),r=await this.generateCallback(s,i,a);return r||a}async generateArguments(e,t=!1,s=null){let i=await this.resolveArguments(e.arguments,async t=>await this.resolveCallback(e,t),s);return t&&(i=this.orderArguments(e,i)),i}orderArguments(e,t){let s=e.getProcessGraph().getProcess(e);if(s&&Array.isArray(s.parameters)){let e=s.parameters.map(e=>"undefined"!==typeof t[e.name]?t[e.name]:e.optional?void 0:null),i=!1;for(let t=e.length-1;t>=0;t--)"undefined"===typeof e[t]?i?e[t]=null:e.pop():i=!0;return e}}var(e,t="datacube"){return this.isKeyword(e)?e+"_":e.match(/^[a-z_]\w*$/)?e:`${t}${e}`}getTab(){return"\t"}addCode(e,t=""){if("string"!==typeof e)return;let s=this.getTab().repeat(this.indent),i=e.trim().split(/\r\n|\r|\n/g);for(let a of i)this.code.push(`${s}${t}${a}\n`)}newLine(e=1){for(let t=0;t<e;t++)this.addCode("")}getServerUrl(){return this.connection.getUrl()}async toCode(e=!1){this.code=[],e||(this.comment("Import required packages"),this.generateImports(),this.newLine(),this.comment("Connect to the back-end"),this.generateConnection(),this.generateAuthentication(),this.newLine(),this.generateBuilder(),this.generateMetadata(),this.newLine());let t=this.getProcessParameters();if(t.length>0){this.comment("ToDo: Here you need to set values for the parameters");for(let e of t)this.generateMissingParameter(e);this.newLine()}return await this.execute(),e||(this.newLine(),this.comment("The process can be executed synchronously (see below), as batch job or as web service now")),this.generateResult(this.getResultNode(),e),this.code.join("").trim()}async execute(){return await this.validate(),this.reset(),await this.executeNodes(this.getStartNodes()),this.getResultNode()}isMath(){return"undefined"===typeof this._isMath&&(this._isMath=this.processRegistry.isMath(this)),this._isMath}}},8099:function(e,t,s){},"80e5":function(e,t,s){"use strict";s("db4b")},"8c66":function(e,t,s){"use strict";var i=function(){var e=this,t=this,s=t.$createElement,i=t._self._c||s;return i("div",{ref:"visualEditor",staticClass:"visualEditor"},[i("div",{staticClass:"sourceHeader"},[t.title?i("strong",[t._v(t._s(t.title))]):t._e(),i("div",{staticClass:"sourceToolbar"},[t.editable?i("span",{staticClass:"sepr"},[i("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:t.confirmClear}},[i("i",{staticClass:"fas fa-file"})]),t._t("file-toolbar")],2):t._e(),t.editable?i("span",{staticClass:"sepr"},[i("button",{attrs:{type:"button",disabled:!t.canUndo,title:"Revert last change"},on:{click:function(e){return t.$refs.blocks.undo()}}},[i("i",{staticClass:"fas fa-undo-alt"})]),i("button",{attrs:{type:"button",disabled:!t.canRedo,title:"Redo last reverted change"},on:{click:function(e){return t.$refs.blocks.redo()}}},[i("i",{staticClass:"fas fa-redo-alt"})]),i("button",{attrs:{type:"button",disabled:!t.hasSelection,title:"Delete selected elements"},on:{click:function(e){return t.$refs.blocks.deleteSelected()}}},[i("i",{staticClass:"fas fa-trash"})])]):t._e(),t.editable?i("span",{staticClass:"sepr"},[t.parent?t._e():i("button",{attrs:{type:"button",title:"Edit Process Metadata"},on:{click:function(){return t.editProcess(t.value)}}},[i("i",{staticClass:"fas fa-sliders-h"})]),i("button",{attrs:{type:"button",title:"Add Parameter"},on:{click:t.addParameter}},[i("i",{staticClass:"fas fa-parking"})]),t.supportsMath?i("button",{class:{highlightFormula:t.isMath},attrs:{type:"button",title:"Insert/Edit formula"},on:{click:t.showExpressionModal}},[i("i",{staticClass:"fas fa-square-root-alt"})]):t._e()]):t._e(),i("button",{class:{compactMode:t.compactMode},attrs:{type:"button",title:"Compact Mode"},on:{click:function(e){return t.$refs.blocks.toggleCompact()}}},[i("i",{staticClass:"fas fa-compress-arrows-alt"})]),i("button",{attrs:{type:"button",title:"Scale to perfect size"},on:{click:function(e){return t.$refs.blocks.perfectScale()}}},[i("i",{staticClass:"fas fa-arrows-alt"})]),i("FullscreenButton",{attrs:{element:function(){return e.$refs.visualEditor}},on:{changed:function(s){e.$refs.blocks.perfectScale(),t.isFullScreen=s}}}),t._t("toolbar")],2)]),i("div",{staticClass:"editorSplitter"},[(t.showDiscoveryToolbar||t.isFullScreen)&&t.editable?i("DiscoveryToolbar",{staticClass:"discoveryToolbar",attrs:{onAddProcess:t.insertProcess}}):t._e(),i("div",{staticClass:"graphBuilder",on:{drop:t.onDrop,dragover:t.allowDrop}},[i("ModelBuilder",{ref:"blocks",attrs:{editable:t.editable,id:t.id,processes:t.processes,collections:t.collections,parent:t.parent,parentSchema:t.parentSchema,value:t.value},on:{input:t.commit,error:t.errorHandler,showProcess:function(e,s){return t.emit("showProcess",{id:e,namespace:s})},showCollection:function(e){return t.emit("showCollection",e)},showParameter:function(e){return t.emit("showProcessParameter",e)},editParameter:t.editParameter,editArguments:t.openArgumentEditor,compactMode:function(t){return e.compactMode=t},selectionChanged:t.selectionChanged,historyChanged:t.historyChanged}})],1)],1)])},a=[],r=s("1d9a"),o=s("025e"),n=s("cbd9"),l=s("3115"),c=s("5472"),u=s("fbda"),d=s("db05"),h={name:"VisualEditor",mixins:[l["a"]],components:{ModelBuilder:r["default"],DiscoveryToolbar:n["a"],FullscreenButton:c["a"]},props:{id:String,editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},parent:{type:Object,default:null},parentSchema:{type:Object,default:null},showDiscoveryToolbar:{type:Boolean,default:!1},title:{type:String},defaultValue:{}},computed:{...o["a"].mapState(["connection","collections"]),...o["a"].mapGetters(["processes","supportsMath"]),...o["a"].mapState("editor",["initialNode"]),isMath(){return this.supportsMath&&this.processes.isMath(this.value)}},data(){return{canUndo:!1,canRedo:!1,compactMode:!1,hasSelection:!1,formula:null,isFullScreen:!1}},watch:{value:{immediate:!0,handler(e){if(this.initialNode&&o["a"].isObject(e)&&o["a"].isObject(e.process_graph))try{let t=this.initialNode;"1"==t&&o["a"].size(e.process_graph)&&(t=Object.keys(e.process_graph)[0]),this.openArgumentEditorForNode(t)}catch(t){o["a"].exception(this,t)}finally{this.setInitialNode(null)}}}},methods:{...o["a"].mapMutations("editor",["setInitialNode"]),commit(e){"undefined"!==typeof this.defaultValue&&o["a"].isObject(e)&&0===o["a"].size(e.process_graph)&&(e=this.defaultValue),this.$emit("input",e)},errorHandler(e,t=null){o["a"].exception(this,e,t)},selectionChanged(e,t){this.hasSelection=Boolean(e.filter(e=>e.$el.allowsDelete).length||t.length)},historyChanged(e,t){this.canUndo=!!e[t-1],this.canRedo=!!e[t+1]},allowDrop(e){e.preventDefault()},onDrop(e){var t=e.dataTransfer.getData("application/vnd.openeo-node");if(t){let s=JSON.parse(t);return this.insertProcess(s,e.pageX,e.pageY),e.preventDefault()}let s=e.dataTransfer.files;if(1===s.length){let t=e.dataTransfer.files[0];if("application/json"===t.type){var i=new FileReader;return i.onload=async e=>{try{let t=JSON.parse(e.target.result);await this.$refs.blocks.import(t)}catch(t){o["a"].exception(this,t,"Parsing JSON file failed")}},i.onerror=e=>o["a"].exception(this,e,"Reading JSON file failed"),i.readAsText(t,"UTF-8"),e.preventDefault()}}},getNameField(e,t="name"){return{value:e,name:t,description:"A unique identifier. Must contain only letters (`a`-`z`), digits (`0`-`9`) and underscores (`_`). `snake_case` is recommended.",label:"Name",schema:{type:"string",pattern:"^\\w+$"},default:null}},getDescriptionField(e,t=!1,s="description",i="Description"){return{value:e,name:s,description:"Provides a detailed description. CommonMark (Markdown) syntax can be used for rich text formatting.",label:i,optional:t,schema:{type:"string",subtype:"commonmark"}}},getOptionalField(e){return{value:e,name:"optional",label:"Optional",description:"Parameters by default are required. CHeck this option to make the parameter optional. For optional parameters a default value should be specified.",optional:!0,schema:{type:"boolean"},default:!1}},getDefaultField(e){return{value:e,name:"default",label:"Default Value",description:"This value is used whenever the user of this process did not specify a value for this parameter.",toggledBy:"optional",optional:!0,schema:{}}},getExperimentalField(e){return{value:e,name:"experimental",label:"Experimental",description:"Declares that this is experimental, which means that it is unstable and likely to change.",optional:!0,schema:{type:"boolean"},default:!1}},getDeprecatedField(e){return{value:e,name:"deprecated",label:"Deprecated",description:"Declares that this is deprecated with the potential to be removed in any of the next versions. It should be transitioned out of usage.",optional:!0,schema:{type:"boolean"},default:!1}},getSchemaField(e,t="schema",s="Data Types"){let i=e?"json-schema":"openeo-datatype";return{value:e,name:t,label:s,description:"Allowed data type(s) as JSON Schema.",schema:[{title:"Single data type",type:"object",subtype:i},{title:"Multiple data types",type:"array",minItems:2,items:{type:"object",subtype:i}}]}},editProcess(e){e=o["a"].isObject(e)?e:{};let t=o["a"].isObject(e.returns)?e.returns:{};var s=[this.getNameField(e.id,"id"),{value:e.summary,name:"summary",description:"A very short description of the process with usually less than 60 characters.",label:"Summary",optional:!0,schema:{type:"string"}},this.getDescriptionField(e.description,!0),{value:e.categories,name:"categories",label:"Categories",optional:!0,schema:{type:"array",items:{type:"string"}}},this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),{label:"Parameters",description:'The parameters can be edited directly in the "Visual Model" interface.',info:!0},this.getDescriptionField(t.description,!0,"returns_description","Return Value > Description"),this.getSchemaField(t.schema,"returns_schema","Return Value > Data Type"),{value:e.exceptions,name:"exceptions",description:"Declares exceptions (errors) that might occur during execution of this process. This list is just for informative purposes.\n\nThe keys of the object are the error codes, which should only consist of alphanumerical characters. `PascalCase` is recommended.",label:"Errors",optional:!0,schema:{type:"object",additionalProperties:{type:"object",required:["message"],properties:{message:{title:"Error Message",type:"string"},description:{title:"Description",type:"string",subtype:"commonmark"},http:{title:"HTTP Status Code",type:"integer",enum:[400,500,501]}}}}},{value:e.examples,name:"examples",label:"Examples",description:"Example calls for this process with specific values for the parameters (arguments) and the result (return value).",optional:!0,schema:{type:"array",items:{type:"object",required:["arguments"],properties:{title:{title:"Title",type:"string"},title:{title:"Description",type:"string",subtype:"commonmark"},arguments:{title:"Arguments",type:"object",default:{}},returns:{title:"Return Value"}}}}},{value:e.links,name:"links",label:"Links",description:"Links related to this process, e.g. additional documentation.",optional:!0,schema:{type:"array",items:{type:"object",required:["href","rel"],properties:{href:{title:"URL",type:"string"},rel:{title:"Relation",description:"For examples see [IANA relation types](https://www.iana.org/assignments/link-relations/link-relations.xhtml)",type:"string",default:"about"},title:{title:"Title",type:"string"},type:{title:"Media Type",description:"For examples see [IANA media types](https://www.iana.org/assignments/media-types/media-types.xhtml)",type:"string"}}}}}];this.emit("showDataForm","Edit Process",s,async e=>{let t=o["a"].pickFromObject(e,["id","summary","description","categories","experimental","deprecated","exception","examples","links"]);("string"===typeof t.description||o["a"].isObject(t.schema))&&(t.returns={description:t.returns_description,schema:e.returns_schema});let s=this.$refs.blocks.export(!0),i=Object.assign({},s,t);this.commit(i)})},addParameter(){var e=[this.getNameField(),this.getDescriptionField(),this.getOptionalField(),this.getDefaultField(),this.getExperimentalField(),this.getDeprecatedField(),this.getSchemaField()];this.emit("showDataForm","Add Parameter",e,async e=>{"string"===typeof e.name&&e.name.length>0&&await this.$refs.blocks.addPgParameter(e)})},editParameter(e,t="Edit Parameter",s=null){var i=[this.getNameField(e.name),this.getDescriptionField(e.description),this.getOptionalField(e.optional),this.getDefaultField(e.default),this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),this.getSchemaField(e.schema)];this.emit("showDataForm",t,i,s)},showExpressionModal(){let e=new d["a"](this.value,this.processes,this.connection,!0);e.setCallbackParameters(this.$refs.blocks.getPgParameters().map(e=>e.spec));try{e.parse();let t={process:e},s={save:this.insertNodes};this.emit("showModal","ExpressionModal",t,s)}catch(t){o["a"].exception(this,t)}},openArgumentEditorForNode(e){let t=o["a"].deepClone(this.value),s=t.process_graph[e],i=this.processes.get(s.process_id,s.namespace);this.openArgumentEditor(i.parameters.map(e=>new u["ProcessParameter"](e)).filter(e=>e.isEditable()),s.arguments,i.id,!0,null,e=>{Object.assign(s,{arguments:e}),this.commit(t)})},openArgumentEditor(e,t,s="Edit",i=!0,a=null,r=null,o=null){let n={title:s,parameters:e,data:t,editable:i,selectParameterName:a,parent:o},l={};"function"===typeof r&&(l.save=r),this.emit("showModal","ParameterModal",n,l)},confirmClear(){var e=confirm("Do you really want to clear the existing model?");e&&this.clear()},clear(){this.$refs.blocks&&this.$refs.blocks.clear(),this.commit(null)},insertProcess(e,t=null,s=null){try{var i=this.$refs.blocks.getPositionForPageXY(t,s);let a=e.namespace;"backend"!==a&&"user"!==a||(a=null),this.$refs.blocks.addProcess(e.process_id,e.arguments,i,a)}catch(a){o["a"].exception(this,a)}},async insertNodes(e,t=!1){return await this.$refs.blocks.import({process_graph:e},{clear:t})}}},p=h,m=(s("4d982"),s("2877")),f=Object(m["a"])(p,i,a,!1,null,null,null);t["a"]=f.exports},"90b4":function(e,t,s){},"916f":function(e,t,s){"use strict";s("ebe9")},"991b":function(e,t,s){"use strict";s("90b4")},"9ba7":function(e,t,s){"use strict";s("b356")},a5c1:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:e.id}})},a=[],r=s("0921"),o=s("025e"),n=s("e300"),l=s("4cdf"),c=s("9c78"),u=s("5bc3"),d=s("480c"),h=s("6cf3"),p=s("3e6b"),m=s("5831"),f=s("2ef1"),g=s("2278"),b=s("d510"),w=(s("7505"),s("cfd3")),v=(s("6601"),s("457f")),y={name:"MapViewer",mixins:[r["a"]],props:{extents:{type:Array,default:()=>null},geoJson:{type:Object,default:()=>null}},data(){return{WMTSCapabilities:{},swipe:{control:null,left:null,right:null},timeline:null}},methods:{renderMap(){let e=Array.isArray(this.extents)&&this.extents.length>0;if(this.createMap(!e),e)for(let i of this.extents){var t=o["a"].extentToBBox(i);this.addRectangle(t.west,t.east,t.north,t.south)}o["a"].isObject(this.geoJson)&&(this.geoJsonLayer=this.addGeoJson(this.geoJson));let s=this.map.getLayers();s.on("add",()=>this.toggleSwipeControl()),s.on("remove",()=>this.toggleSwipeControl()),this.$listeners&&this.$listeners.drop&&(this.map.getViewport().addEventListener("dragover",e=>e.preventDefault()),this.map.getViewport().addEventListener("drop",this.$listeners.drop))},addRectangle(e,t,s,i){let a=[...this.fromLonLat([e,i]),...this.fromLonLat([t,s])],r=new p["a"]({title:"Extent",displayInLayerSwitcher:!1,source:new m["a"]({features:[new l["a"](Object(u["c"])(a))],projection:"EPSG:4326",wrapX:!1})});this.map.addLayer(r),this.map.getView().fit(a,this.fitOptions)},async showWebService(e){switch(e.type.toLowerCase()){case"xyz":this.updateXYZLayer(e);break;case"wmts":await this.updateWMTSLayer(e);break;default:o["a"].error(this,"Sorry, the service type is not supported by the map.")}},toggleSwipeControl(){var e=this.getVisibleLayers();2===e.length?(null===this.swipe.control&&(this.swipe.control=new w["a"],this.map.addControl(this.swipe.control)),this.swipe.left!==e[0]&&(this.swipe.control.addLayer(e[0]),this.swipe.left=e[0]),this.swipe.right!==e[1]&&(this.swipe.control.addLayer(e[1],!0),this.swipe.right=e[1])):(this.map.removeControl(this.swipe.control),this.swipe.control=null,this.swipe.left=null,this.swipe.right=null)},addLayerToMap(e){e.set("userLayer",!0),this.map.addLayer(e),e.on("change",()=>this.toggleSwipeControl()),e.on("change:visible",()=>this.toggleSwipeControl()),e.on("change:zIndex",()=>this.toggleSwipeControl())},removeLayerFromMap(e){let t=this.getLayerFromMap(e);t&&this.map.removeLayer(t)},getLayerFromMap(e){let t=this.map.getLayers().getArray();for(let s of t)if(s.get("id")===e)return s;return null},updateGeoTiffLayer(e,t=null){var s=new d["a"]({id:e,title:t||"GeoTiff",source:new h["a"]({url:"http://tiles.rdnt.io/tiles?url="+encodeURIComponent(e),crossOrigin:"anonymous"})});return this.addLayerToMap(s),s},async addCollection(e){let t=o["a"].getPreviewLinkFromSTAC(e);t||o["a"].error(this,"No visualizations found for collection");let s,i={id:e.id,url:t.href,title:e.title||e.id};switch(this.map.getLayers().forEach(e=>{e.get("previewLayer")&&e.get("id")!==i.id&&this.map.removeLayer(e)}),t.rel.toLowerCase()){case"xyz":s=this.updateXYZLayer(i);break;case"wmts":let e=[];t["wmts:layer"]&&e.push(t["wmts:layer"]),s=await this.updateWMTSLayer(i,e);break;default:return void o["a"].error(this,"Sorry, the service type is not supported by the map.")}s.set("previewLayer",!0);try{let t=o["a"].extentToBBox(e.extent.spatial.bbox[0]),i=[...this.fromLonLat([t.west,t.south]),...this.fromLonLat([t.east,t.north])],a=new p["a"]({title:"Extent",noSwitcherDelete:!0,source:new m["a"]({features:[new l["a"](Object(u["c"])(i))],projection:"EPSG:4326",wrapX:!1})}),r=a.getStyle();"function"===typeof r&&(r=r()[0]),r.setFill(null),s.getLayers().push(a),this.map.getView().fit(i,this.fitOptions)}catch(a){console.log(a)}},getWMTSTimes(e,t){const s=e.Contents.Layer||[];let i=s.find(e=>e.Identifier==t);if(!i||!i.Dimension)return[];let a=i.Dimension.find(e=>"TIME"===e.Identifier);return a?a.Value.sort():[]},async updateWMTSLayer(e,t=[],s,i="Service"){if(this.removeLayerFromMap(e.id),!this.WMTSCapabilities[e.url]){let t=new URL(e.url);t.searchParams.set("service","wmts"),t.searchParams.set("request","GetCapabilities");let s=await axios.get(t.toString(),{responseType:"text"});var a=new g["a"];this.WMTSCapabilities[e.url]=a.read(s.data)}let r=this.WMTSCapabilities[e.url],l=null,u=null,h=null,p=null,m=o["a"].getResourceTitle(e,i),f=new n["a"];for(let n of t){let e=Object(b["b"])(r,{layer:n,matrixSet:"EPSG:3857"});h||(h=new Date(e.dimensions.TIME));let t=this.getWMTSTimes(r,n);if(t.length){let e=new Date(t[0]),s=new Date(t[t.length-1]);(!l||e<l)&&(l=e),(!u||s>u)&&(u=s)}s&&(o["a"].isObject(e.dimensions)||(e.dimensions={}),e.dimensions.time=s),p=new b["a"](e);var w=new d["a"]({title:m,source:this.trackTileProgress(p),noSwitcherDelete:!0});f.push(w)}if(l&&u){let e;this.timeline=new v["a"]({className:"ol-pointer",graduation:"day",minDate:l,maxDate:u}),this.timeline.on("scroll",(function(t){!t.date||t.date>u||t.date<l||(e&&window.clearTimeout(e),e=window.setTimeout(()=>{try{let e=t.date.toISOString().substr(0,10);p.updateDimensions({TIME:e});let s=document.getElementsByClassName("timeline-date-label");s[0].innerText=e,s[0].disabled=!0}catch(s){console.log(s)}e=null},500))})),this.map.addControl(this.timeline),this.timeline.addButton({className:"timeline-date-label",title:`The date that is shown on the map for the collection '${m}'`,html:"No date"}),this.timeline.setDate(h)}let y=new c["a"]({id:e.id,title:m,layers:f});return this.addLayerToMap(y),this.timeline&&this.map.getLayers().on("remove",e=>{e.element===y&&(this.map.removeControl(this.timeline),this.timeline=null)}),y},updateXYZLayer(e,t="Service"){this.removeLayerFromMap(e.id);let s=o["a"].replaceParam(e.url,"__editorSessionId",(new Date).getTime()).replace(/%7B/g,"{").replace(/%7D/g,"}"),i=o["a"].getResourceTitle(e,t),a=new d["a"]({title:i,source:this.trackTileProgress(new f["a"]({url:s})),noSwitcherDelete:!0}),r=new c["a"]({id:e.id,title:i,layers:[a]});return this.addLayerToMap(r),r}}},S=y,C=(s("991b"),s("2877")),k=Object(C["a"])(S,i,a,!1,null,null,null);t["default"]=k.exports},b356:function(e,t,s){},b5d7:function(e,t,s){"use strict";s("50e5")},bdf7:function(e,t,s){},c240:function(e,t,s){},c261:function(e,t,s){},c46c:function(e,t,s){"use strict";s("c261")},c98e:function(e,t,s){},ccbe:function(e,t,s){"use strict";s("4525")},db05:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s("025e"),a=s("79f4"),r=s("2b70");const o=["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield","builder","connection","formula","openeo","result"];class n extends a["a"]{constructor(e,t,s,i=!1){super(e,t,s),this.generateFormula=i}createProcessGraphInstance(e){let t=new n(e,this.processRegistry,this.getJsonSchemaValidator(),this.generateFormula);return this.copyProcessGraphInstanceProperties(t)}parse(){this.parsed||super.parse()}isKeyword(e){return o.includes(e.toLowerCase())}comment(e){this.addCode(e,"// ")}generateImports(){this.addCode("import { OpenEO, Formula } from '@openeo/js-client';")}generateConnection(){this.addCode(`let connection = await OpenEO.connect('${this.getServerUrl()}');`)}generateAuthentication(){this.comment("ToDo: Here you need to add your authentication steps")}generateBuilder(){this.addCode("let builder = await connection.buildProcess();")}generateMetadataEntry(e,t){this.addCode(`builder.${e} = ${this.e(t)};`)}async generateFunction(e){let t=this.var(e.id),s=e.getParent()?"this":"builder",a=await this.generateArguments(e,!e.namespace);if(this.comment(e.description),i["a"].isObject(a)){let i=e.namespace?`${e.process_id}@${e.namespace}`:e.process_id;this.addCode(`let ${t} = ${s}.process("${i}", ${this.e(a)});`)}else this.addCode(`let ${t} = ${s}.${e.process_id}(${a.map(e=>this.e(e)).join(", ")});`)}generateMissingParameter(e){this.comment(e.description);let t=this.var(e.name,"param"),s="undefined"!==typeof e.default?s:null;this.addCode(`let ${t} = ${this.e(s)};`)}async generateCallback(e,t,s){if(this.generateFormula&&e&&e.isMath()){let t=e.toFormulaString(),s=JSON.stringify(t);return`new Formula(${s})`}{let i=this.generateFunctionParams(t);this.newLine(),this.addCode(`let ${s} = function(${i.join(", ")}) {`),this.indent++,this.addCode(await e.toCode(!0)),this.indent--,this.addCode("}")}}generateResult(e,t){if(!e)return;let s=this.var(e.id);t?this.addCode(`return ${s};`):this.addCode(`let result = await connection.computeResult(${s});`)}toFormulaString(){return this.isMath()?this.nodeToFormula(this.getResultNode()):""}getArrayElementPlaceholder(e){if("array_element"===e.process_id&&"parameter"===e.getArgumentType("data")){let t=e.getRawArgument("data").from_parameter,s=this.getCallbackParameters().findIndex(e=>e.name===t);if(s>=0)return"$".repeat(s+1)+(e.getArgument("label")||e.getArgument("index"))}return null}nodeToFormula(e,t=null){if("array_element"===e.process_id){let t=this.getArrayElementPlaceholder(e);if(t)return t}let s=r["Formula"].reverseOperatorMapping[e.process_id],a=this.processRegistry.get(e.process_id),o="undefined"!==typeof r["Formula"].arrayOperatorMapping[e.process_id],n=t=>{if(i["a"].isObject(t))if(t.from_node){let i=e.getProcessGraph().getNode(t.from_node);t=i?this.nodeToFormula(i,s):"#"+t.from_node}else{if(!t.from_parameter)throw new Error("Objects not allowed");t=t.from_parameter}return t},l=[],c=Array.isArray(a.parameters)?a.parameters:[];for(let i of c){let t=n(e.getRawArgument(i.name));if(o&&Array.isArray(t)&&"data"===i.name){l=t.map(e=>n(e));break}if("undefined"!==typeof t)l.push(t);else{if("undefined"===typeof i.default)throw new Error('Argument for parameter "'+i.name+'" missing');l.push(i.default)}}if(o&&(l=l.filter(e=>null!==e)),s){let e=["/","*"],i=["-","+"],a=l.map(e=>e<0?"("+e+")":e).join(s);return!t||i.includes(t)&&i.includes(s)||e.includes(t)&&e.includes(s)||"^"===s||i.includes(t)&&e.includes(s)?a:"("+a+")"}return e.process_id+"("+l.join(", ")+")"}}},db4b:function(e,t,s){},ebe9:function(e,t,s){},f3db:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"wrapper"}},[s("div",{class:{authenticated:e.isAuthenticated},attrs:{id:"ide"}},[s("header",{staticClass:"navbar"},[s("Logo"),s("ul",{attrs:{id:"menu"}},[s("li",[s("div",{staticClass:"menuItem",attrs:{title:"Start a guided tour"},on:{click:e.showHelp}},[s("i",{staticClass:"fas fa-question fa-fw"}),e._v(" Help")])]),s("li",[s("div",{staticClass:"menuItem",attrs:{title:"Get server information"},on:{click:e.showServerInfo}},[s("i",{staticClass:"fas fa-info fa-fw"}),e._v(" Server")])]),s("li",[s("UserMenu")],1)])],1),s("Splitpanes",{staticClass:"default-theme",on:{resize:e.resized,"pane-maximize":e.resized}},[s("Pane",{attrs:{id:"discovery",size:e.splitpaneSizeH[0]}},[s("DiscoveryToolbar",{staticClass:"toolbar tour-ide-discovery",attrs:{onAddProcess:e.insertProcess,collectionPreview:!0,persist:!0}})],1),s("Pane",{attrs:{id:"workspace",size:e.splitpaneSizeH[1]}},[s("Splitpanes",{staticClass:"default-theme",attrs:{horizontal:""},on:{resize:e.resized,"pane-maximize":e.resized}},[s("Pane",{attrs:{id:"editor",size:e.splitpaneSizeV[0]}},[s("Editor",{ref:"editor",staticClass:"mainEditor tour-ide-editor",attrs:{id:"main",value:e.process,title:e.contextTitle},on:{input:e.updateEditor},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[s("button",{attrs:{type:"button",title:"Import process from external source"},on:{click:e.importProcess}},[s("i",{staticClass:"fas fa-cloud-download-alt"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.saveSupported,expression:"saveSupported"}],attrs:{type:"button",disabled:!e.hasProcess,title:"Save to "+e.contextTitle},on:{click:e.saveProcess}},[s("i",{staticClass:"fas fa-save"})]),s("button",{attrs:{type:"button",disabled:!e.hasProcess,title:"Export into another programming language"},on:{click:e.exportCode}},[s("i",{staticClass:"fas fa-file-export"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.validateSupported,expression:"validateSupported"}],attrs:{type:"button",disabled:!e.hasProcess,title:"Validate process on server-side"},on:{click:e.validateProcess}},[s("i",{staticClass:"fas fa-tasks"})])]},proxy:!0}])})],1),s("Pane",{attrs:{id:"user",size:e.splitpaneSizeV[1]}},[e.isAuthenticated?s("UserWorkspace",{staticClass:"userContent tour-ide-workspace"}):s("div",{staticClass:"message info",attrs:{title:"Login is required to interact with the server."}},[s("i",{staticClass:"fas fa-sign-in-alt"}),s("span",{staticClass:"login-message"},[s("strong",[s("a",{on:{click:e.login}},[e._v("Log in")])]),e._v(" is required to interact with the server.")])])],1)],1)],1),s("Pane",{attrs:{id:"viewer",size:e.splitpaneSizeH[2]}},[s("Viewer",{staticClass:"tour-ide-viewer"})],1)],1)],1)])},a=[],r=s("3115"),o=s("025e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"UserMenu"}},[s("div",{staticClass:"menuItem"},[e._m(0),s("div",{staticClass:"data"},[s("span",{staticClass:"name nowrap"},[s("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.userName))]),e.budget?s("span",{staticClass:"credits nowrap"},[s("i",{staticClass:"fas fa-dollar-sign fa-fw"}),e._v(" "+e._s(e.budget))]):e._e(),e.hasStorage?s("span",{staticClass:"storage nowrap"},[s("i",{staticClass:"fas fa-database fa-fw"}),e._v(" "+e._s(e.storageUsedPercent)+"% used")]):e._e()])]),s("div",{staticClass:"dropdown"},[e.profileLink?s("a",{staticClass:"item",attrs:{href:e.profileLink.href,target:"_blank"}},[e._v("Welcome, "+e._s(e.userName)+"!")]):s("div",{staticClass:"item"},[e._v("Welcome, "+e._s(e.userName)+"!")]),e.isAuthenticated?[e.settingsLink?s("a",{staticClass:"item",attrs:{href:e.settingsLink.href,target:"_blank"}},[s("i",{staticClass:"fas fa-user-edit"}),e._v(" "+e._s(e.settingsLink.title||"Edit Profile"))]):e._e(),s("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.logout.apply(null,arguments)}}},[s("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" Logout")])]:[s("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[s("i",{staticClass:"fas fa-sign-in-alt"}),e._v(" Login")]),e.registerLink?s("a",{staticClass:"item",attrs:{href:e.registerLink.href,target:"_blank"}},[s("i",{staticClass:"fas fa-user-plus"}),e._v(" Register")]):e._e(),e.passwordLink?s("a",{staticClass:"item",attrs:{href:e.passwordLink.href,target:"_blank"}},[s("i",{staticClass:"fas fa-key"}),e._v(" Forgotten Password?")]):e._e()],e.$config.serverUrl?e._e():s("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.disconnect.apply(null,arguments)}}},[s("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" Disconnect")]),e.userLinks.length>0?[s("hr"),e._l(e.userLinks,(function(t,i){return s("a",{key:i,staticClass:"item",attrs:{href:t.href,target:"_blank",rel:t.rel}},[e._v(e._s(t.title))])}))]:e._e(),e.budget||e.userInfo.default_plan||e.paymentLink?[s("hr"),s("div",{staticClass:"item"},[s("h4",[e._v("Billing")]),e.userInfo.default_plan?s("div",{staticClass:"secondary-text"},[e._v("Plan: "+e._s(e.userInfo.default_plan))]):e._e(),e.budget?s("div",{staticClass:"secondary-text"},[e._v("Budget: "+e._s(e.budget))]):e._e()]),e.paymentLink?s("a",{staticClass:"item",attrs:{href:e.paymentLink.href,target:"_blank"}},[s("i",{staticClass:"fas fa-credit-card"}),e._v(" "+e._s(e.paymentLink.title||"Recharge"))]):e._e()]:e._e(),e.hasStorage?[s("hr"),s("div",{staticClass:"item"},[s("h4",[e._v("Storage")]),s("div",{staticClass:"secondary-text nowrap"},[e._v("Used "+e._s(e.formatMegabyte(e.storageUsed))+" of "+e._s(e.formatMegabyte(e.userInfo.storage.quota))+".")]),s("div",{staticClass:"storagePercent"},[s("div",{staticClass:"used",style:"width: "+e.storageUsedPercent+"%"})])])]:e._e()],2)])},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"down"},[s("i",{staticClass:"fas fa-chevron-down"})])}],c={name:"UserMenu",mixins:[r["a"]],computed:{...o["a"].mapState(["userInfo","isAuthenticated"]),...o["a"].mapGetters(["currency","capabilities"]),userLinks(){return o["a"].friendlyLinks(this.userInfo.links,!0,["self","edit-form","payment","alternate"])},serverLinks(){return this.capabilities?this.capabilities.links():[]},registerLink(){return this.serverLinks.find(e=>"create-form"===e.rel)},passwordLink(){return this.serverLinks.find(e=>"recovery-form"===e.rel)},settingsLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find(e=>"edit-form"===e.rel):void 0},paymentLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find(e=>"payment"===e.rel):void 0},profileLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find(e=>"alternate"===e.rel):void 0},hasStorage(){return o["a"].isObject(this.userInfo.storage)&&"number"===typeof this.userInfo.storage.quota&&"number"===typeof this.userInfo.storage.free},budget(){return o["a"].formatBudget(this.userInfo.budget,this.currency)},userName(){return"string"===typeof this.userInfo.name?this.userInfo.name:"string"===typeof this.userInfo.user_id?this.userInfo.user_id:this.isAuthenticated?"User":"Guest"},storageUsed(){return this.hasStorage?this.userInfo.storage.quota-this.userInfo.storage.free:null},storageUsedPercent(){return this.hasStorage?Math.round(this.storageUsed/this.userInfo.storage.quota*100):null}},methods:{...o["a"].mapActions({logoutUser:"logout"}),...o["a"].mapMutations("editor",{resetEditor:"reset"}),async logout(){await this.logoutUser(!1),o["a"].ok(this,"Logout successful.")},async disconnect(){await this.logoutUser(!0),this.resetEditor(),window.history.pushState({},"","?")},login(){this.emit("showLogin")},formatMegabyte(e){var t=1073741824;return e>t?Math.round(e/t)+" GB":Math.round(e/1048576)+" MB"}}},u=c,d=(s("fdbd"),s("2877")),h=Object(d["a"])(u,n,l,!1,null,"76333d38",null),p=h.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tabs",{ref:"tabs",attrs:{id:"userContent"}},[e.showJobs?s("Tab",{attrs:{id:"jobs",name:"Data Processing",icon:"fa-tasks"},on:{show:e.onShow,hide:e.onHide}},[s("JobPanel")],1):e._e(),e.showServices?s("Tab",{attrs:{id:"services",name:"Web Services",icon:"fa-cloud"},on:{show:e.onShow,hide:e.onHide}},[s("ServicePanel")],1):e._e(),e.showCustomProcesses?s("Tab",{attrs:{id:"customProcesses",name:"Custom Processes",icon:"fa-sitemap"},on:{show:e.onShow,hide:e.onHide}},[s("CustomProcessPanel")],1):e._e(),e.showFiles?s("Tab",{attrs:{id:"files",name:"Files",icon:"fa-file"},on:{show:e.onShow,hide:e.onHide}},[s("FilePanel")],1):e._e()],1)},f=[],g=s("e7ea"),b=s("bdb2"),w=s("d24e"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("DataTable",{ref:"table",staticClass:"JobPanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(s){return e.showJobInfo(t.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("estimateJob"),expression:"supports('estimateJob')"}],attrs:{title:"Estimate"},on:{click:function(s){return e.estimateJob(t.row)}}},[s("i",{staticClass:"fas fa-file-invoice-dollar"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate&&e.isJobInactive(t.row),expression:"supportsUpdate && isJobInactive(p.row)"}],attrs:{title:"Edit metadata"},on:{click:function(s){return e.editMetadata(t.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead&&e.isJobInactive(t.row),expression:"supportsRead && isJobInactive(p.row)"}],attrs:{title:"Edit process"},on:{click:function(s){return e.showInEditor(t.row)}}},[s("i",{staticClass:"fas fa-project-diagram"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteJob(t.row)}}},[s("i",{staticClass:"fas fa-trash"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("startJob")&&e.isJobInactive(t.row),expression:"supports('startJob') && isJobInactive(p.row)"}],attrs:{title:"Start processing"},on:{click:function(s){return e.queueJob(t.row)}}},[s("i",{staticClass:"fas fa-play-circle"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("stopJob")&&e.isJobActive(t.row),expression:"supports('stopJob') && isJobActive(p.row)"}],attrs:{title:"Cancel processing"},on:{click:function(s){return e.cancelJob(t.row)}}},[s("i",{staticClass:"fas fa-stop-circle"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("downloadResults")&&e.hasResults(t.row),expression:"supports('downloadResults') && hasResults(p.row)"}],attrs:{title:"Download"},on:{click:function(s){return e.downloadResults(t.row)}}},[s("i",{staticClass:"fas fa-download"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("downloadResults")&&e.hasResults(t.row),expression:"supports('downloadResults') && hasResults(p.row)"}],attrs:{title:"View results"},on:{click:function(s){return e.viewResults(t.row,!0)}}},[s("i",{staticClass:"fas fa-eye"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("debugJob"),expression:"supports('debugJob')"}],attrs:{title:"View logs"},on:{click:function(s){return e.showLogs(t.row)}}},[s("i",{staticClass:"fas fa-bug"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new job for batch processing",disabled:!this.hasProcess},on:{click:function(t){return e.createJobFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),e._v(" Create Batch Job")]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("computeResult"),expression:"supports('computeResult')"}],attrs:{title:"Run the process directly and view the results without storing them permanently",disabled:!this.hasProcess},on:{click:e.executeProcess}},[s("i",{staticClass:"fas fa-play"}),e._v(" Run / Preview")])])],2)},y=[],S=s("41a2"),C=s("2b70");const k=Object(S["a"])("jobs","batch job","batch jobs");var x={name:"JobPanel",mixins:[k,r["a"]],data(){return{columns:{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Batch Job",computedValue:e=>o["a"].getResourceTitle(e),edit:this.updateTitle},status:{name:"Status",stylable:!0},created:{name:"Submitted",format:"Timestamp",sort:"desc"},updated:{name:"Last update",format:"Timestamp"},actions:{name:"Actions",filterable:!1,sort:!1}},watchers:{},jobUpdater:null,runId:0}},mounted(){this.listen("replaceProcess",this.replaceProcess)},computed:{...o["a"].mapState(["connection"]),...o["a"].mapGetters(["supports","supportsBilling","supportsBillingPlans"]),...o["a"].mapGetters("editor",["hasProcess"]),...o["a"].mapState("editor",["process"])},watch:{data:{handler:function(e){this.watchers={};for(let t of e)switch(t.status.toLowerCase()){case"running":case"queued":this.watchers[t.id]=t;break}},deep:!0}},methods:{...o["a"].mapActions("jobs",["queue","cancel"]),startSyncTimer(){k.methods.startSyncTimer.call(this),this.jobUpdater=setInterval(this.executeWatchers,1e4)},stopSyncTimer(){k.methods.stopSyncTimer.call(this),null!==this.jobUpdater&&clearInterval(this.jobUpdater)},showInEditor(e){this.refreshElement(e,e=>this.emit("editProcess",e))},async executeProcess(){let e={timeout:0,type:"async",buttons:[{text:"Close",action:e=>{this.$snotify.remove(e.id,!0)}}]};try{this.runId++;let t=this.$snotify.async("A process is currently executed synchronously...","Run / Preview #"+this.runId,null,e),s=await this.connection.computeResult(this.process);this.emit("viewSyncResult",s),this.$snotify.remove(t.id,!0)}catch(t){let e="Processing Error";"string"===typeof t.message&&t.message.length>this.$config.snotifyDefaults.bodyMaxLength?(this.emit("viewLogs",[{id:t.id||"unknown",code:t.code||void 0,level:"error",message:t.message,links:t.links||[]}]),o["a"].error(this,"Synchronous processing failed. Please see the logs for details.",e)):o["a"].exception(this,t,e)}},jobCreated(e){var t=[];this.supports("estimateJob")&&t.push({text:"Estimate",action:()=>this.estimateJob(e)}),this.supports("startJob")&&t.push({text:"Start processing",action:()=>this.queueJob(e)}),this.supports("deleteJob")&&t.push({text:"Delete",action:()=>this.deleteJob(e)}),o["a"].confirm(this,'Job "'+o["a"].getResourceTitle(e)+'" created!',t)},getTitleField(e=null){return{name:"title",label:"Title",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e=null){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getBillingPlanField(e){return{name:"plan",label:"Billing plan",schema:{type:"string",subtype:"billing-plan"},value:e,optional:!0}},getBudgetField(e=null){return{name:"budget",label:"Budget",schema:{type:"number",subtype:"budget"},default:null,value:e,optional:!0}},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},async createJob(e,t){try{t=this.normalizeToDefaultData(t);let s=await this.create({parameters:[e,t.title,t.description,t.plan,t.budget]});this.jobCreated(s)}catch(s){o["a"].exception(this,s,"Create Job Error: "+(t.title||""))}},createJobFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null];this.emit("showDataForm","Create new batch job",e,e=>this.createJob(this.process,e))},deleteJob(e){this.delete({data:e}).catch(t=>o["a"].exception(this,t,"Delete Job Error: "+o["a"].getResourceTitle(e)))},executeWatchers(){for(var e in this.watchers)this.refreshElement(this.watchers[e],(e,t)=>{if("finished"!==t.status&&"finished"===e.status){var s=[];this.supports("downloadResults")&&(s.push({text:"Download",action:()=>this.downloadResults(e)}),s.push({text:"View",action:()=>this.viewResults(e)})),o["a"].confirm(this,'Job "'+o["a"].getResourceTitle(e)+'" has finished!',s)}else"error"!==t.status&&"error"===e.status&&o["a"].error(this,'Job "'+o["a"].getResourceTitle(e)+'" has stopped due to an error or timeout.');t.status!==e.status&&this.emit("jobStatusUpdated",e,t)})},async showJobInfo(e){this.refreshElement(e,async e=>{let t=null;if("finished"===e.status)try{t=await e.getResultsAsStac()}catch(s){o["a"].exception(this,s,"Load Results Error: "+o["a"].getResourceTitle(e))}this.emit("showModal","JobInfoModal",{job:e.getAll(),result:t})})},async estimateJob(e){try{let t=await e.estimateJob();this.emit("showModal","JobEstimateModal",{job:e.getAll(),estimate:t})}catch(t){o["a"].exception(this,t,"Job Estimate Error: "+o["a"].getResourceTitle(e))}},showLogs(e){this.emit("viewLogs",e)},replaceProcess(e,t){e instanceof C["Job"]&&(this.isJobActive(e)?o["a"].error(this,"Can't update process while batch job is running."):this.updateJob(e,{process:t}))},editMetadata(e){this.refreshElement(e,e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null];this.emit("showDataForm","Edit batch job",t,t=>this.updateJob(e,t))})},updateTitle(e,t){this.updateJob(e,{title:t})},async updateJob(e,t){try{let s=await this.update({data:e,parameters:this.normalizeToDefaultData(t)});o["a"].ok(this,'Job "'+o["a"].getResourceTitle(s)+'" successfully updated.')}catch(s){o["a"].exception(this,s,"Update Job Error: "+o["a"].getResourceTitle(e))}},async queueJob(e){try{let t=await this.queue({data:e});o["a"].ok(this,'Job "'+o["a"].getResourceTitle(t)+'" successfully queued.')}catch(t){o["a"].exception(this,t,"Queue Job Error: "+o["a"].getResourceTitle(e))}},async cancelJob(e){try{let t=await this.cancel({data:e});o["a"].ok(this,'Job "'+o["a"].getResourceTitle(t)+'" successfully canceled.')}catch(t){o["a"].exception(this,t,"Cancel Job Error: "+o["a"].getResourceTitle(e))}},async viewResults(e){try{let t=await e.getResultsAsStac();if(0==o["a"].size(t.assets))return void o["a"].error(this,'No results available for job "'+o["a"].getResourceTitle(e)+'".');this.emit("viewJobResults",t,e)}catch(t){o["a"].exception(this,t,"View Result Error: "+o["a"].getResourceTitle(e))}},async downloadResults(e){try{let t=await e.getResultsAsStac();if(0==o["a"].size(t.assets))return void o["a"].error(this,'No results available for job "'+o["a"].getResourceTitle(e)+'".');this.emit("showModal","DownloadAssetsModal",{job:e,result:t})}catch(t){o["a"].exception(this,t,"Download Result Error: "+o["a"].getResourceTitle(e))}},hasResults(e){return"string"!==typeof e.status||"finished"==e.status.toLowerCase()},isJobInactive(e){return"string"!==typeof e.status||!this.isActiveStatusCode(e.status)},isJobActive(e){return"string"!==typeof e.status||this.isActiveStatusCode(e.status)},isActiveStatusCode(e){switch(e.toLowerCase()){case"running":case"queued":return!0;default:return!1}}}},P=x,T=(s("0791"),Object(d["a"])(P,v,y,!1,null,null,null)),L=T.exports,_=s("f0fa"),D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("DataTable",{ref:"table",staticClass:"ServicePanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(t){return[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(s){return e.serviceInfo(t.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate,expression:"supportsUpdate"}],attrs:{title:"Edit metadata"},on:{click:function(s){return e.editMetadata(t.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(s){return e.showInEditor(t.row)}}},[s("i",{staticClass:"fas fa-project-diagram"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(s){return e.deleteService(t.row)}}},[s("i",{staticClass:"fas fa-trash"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.row.enabled&&e.isMapServiceSupported(t.row.type),expression:"p.row.enabled && isMapServiceSupported(p.row.type)"}],attrs:{title:"View on map"},on:{click:function(s){return e.viewService(t.row)}}},[s("i",{staticClass:"fas fa-map"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("debugService"),expression:"supports('debugService')"}],attrs:{title:"View logs"},on:{click:function(s){return e.showLogs(t.row)}}},[s("i",{staticClass:"fas fa-bug"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new service",disabled:!this.hasProcess},on:{click:function(t){return e.createServiceFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),e._v(" Create")])])],2)},M=[],E={name:"ServicePanel",mixins:[Object(S["a"])("services","web service","web services"),r["a"]],data(){return{columns:{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Web Service",computedValue:e=>o["a"].getResourceTitle(e),edit:this.updateTitle},type:{name:"Type",format:e=>"string"===typeof e?e.toUpperCase():e},enabled:{name:"Enabled",edit:this.toggleEnabled},created:{name:"Submitted",format:"Timestamp",sort:"desc"},actions:{name:"Actions",filterable:!1,sort:!1}}}},computed:{...o["a"].mapState("editor",["process"]),...o["a"].mapGetters("editor",["hasProcess"]),...o["a"].mapState(["serviceTypes"]),...o["a"].mapGetters(["supports","supportsBilling","supportsBillingPlans"])},mounted(){this.listen("replaceProcess",this.replaceProcess)},methods:{isMapServiceSupported(e){return"string"===typeof e&&this.$config.supportedMapServices.includes(e.toLowerCase())},showInEditor(e){this.refreshElement(e,e=>this.emit("editProcess",e))},showLogs(e){this.emit("viewLogs",e)},serviceCreated(e){var t=[];this.isMapServiceSupported(e.type)&&t.push({text:"View on map",action:()=>this.viewService(e)}),this.supportsRead&&t.push({text:"Details",action:()=>this.serviceInfo(e)}),this.supportsDelete&&t.push({text:"Delete",action:()=>this.deleteService(e)}),o["a"].confirm(this,"Web Service created!",t)},getTitleField(e=null){return{name:"title",label:"Title",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e=null){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getServiceTypeField(e){return{name:"type",label:"Type",schema:{type:"string",subtype:"service-type"},value:e}},getBillingPlanField(e){return{name:"plan",label:"Billing plan",schema:{type:"string",subtype:"billing-plan"},value:e,optional:!0}},getBudgetField(e=null){return{name:"budget",label:"Budget",schema:{type:"number",subtype:"budget"},default:null,value:e,optional:!0}},getEnabledField(e=!0){return{name:"enabled",label:"Enabled",schema:{type:"boolean"},default:!0,value:e,optional:!0}},getConfigField(e){return{name:"configuration",label:"Service Configuration",schema:{type:"object",subtype:"service-config"},value:e,optional:!0}},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"!==typeof e.enabled&&"boolean"!==typeof e.enabled&&(e.enabled=!0),"undefined"===typeof e.configuration||o["a"].isObject(e.configuration)||(e.configuration={}),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},async createService(e,t){t=this.normalizeToDefaultData(t);try{let s=await this.create({parameters:[e,t.type,t.title,t.description,t.enabled,t.configuration,t.plan,t.budget]});this.serviceCreated(s)}catch(s){o["a"].exception(this,s,"Create Service Error: "+(t.title||""))}},createServiceFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.getServiceTypeField(),this.getEnabledField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null,this.getConfigField()];this.emit("showDataForm","Create new web service",e,e=>this.createService(this.process,e))},editMetadata(e){this.refreshElement(e,e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.getEnabledField(e.enabled),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null,this.getConfigField(e.configuration)];this.emit("showDataForm","Edit web service",t,t=>this.updateService(e,t))})},serviceInfo(e){this.refreshElement(e,e=>{this.emit("showModal","ServiceInfoModal",{service:e.getAll()})})},replaceProcess(e,t){e instanceof C["Service"]&&this.updateService(e,{process:t})},updateTitle(e,t){this.updateService(e,{title:t})},toggleEnabled(e){this.updateService(e,{enabled:!e.enabled})},async updateService(e,t){try{let s=await this.update({data:e,parameters:this.normalizeToDefaultData(t)});o["a"].ok(this,'Service "'+o["a"].getResourceTitle(s)+'" successfully updated.')}catch(s){o["a"].exception(this,s,"Update Service Error: "+o["a"].getResourceTitle(e))}},async deleteService(e){try{await this.delete({data:e}),this.emit("removeWebService",e.id)}catch(t){o["a"].exception(this,t,"Delete Service Error: "+o["a"].getResourceTitle(e))}},viewService(e){this.emit("viewWebService",e)}}},F=E,I=(s("916f"),Object(d["a"])(F,D,M,!1,null,null,null)),j=I.exports,R={name:"UserWorkspace",components:{FilePanel:w["a"],JobPanel:L,CustomProcessPanel:_["a"],ServicePanel:j,Tabs:g["default"],Tab:b["default"]},computed:{...o["a"].mapGetters(["supports"]),showJobs(){return this.supports("listJobs")||this.supports("createJob")},showServices(){return this.supports("listServices")||this.supports("createService")},showCustomProcesses(){return this.supports("listUserProcesses")||this.supports("setUserProcess")},showFiles(){return this.supports("listFiles")||this.supports("uploadFile")}},methods:{onShow(e){e.$children.length&&"function"===typeof e.$children[0].onShow&&e.$children[0].onShow()},onHide(e){e.$children.length&&"function"===typeof e.$children[0].onHide&&e.$children[0].onHide()}}},$=R,A=(s("b5d7"),Object(d["a"])($,m,f,!1,null,null,null)),J=A.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tabs",{ref:"tabs",attrs:{id:"viewerContent"},scopedSlots:e._u([{key:"default",fn:function(){return[s("Tab",{attrs:{id:"mapView",name:"Map",icon:"fa-map",selected:!0},on:{show:e.onShow,hide:e.onHide},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.tab;return[s("MapViewer",{ref:"mapViewer",attrs:{id:"mapCanvas",show:i.active,center:[50.1725,9.15],zoom:6,removableLayers:!0},on:{drop:function(t){return e.onDrop(t)}}})]}}])})]},proxy:!0},{key:"dynamic",fn:function(t){var i=t.tab;return[e.logViewerIcons.includes(i.icon)?s("LogViewer",{attrs:{data:i.data}}):"fa-image"===i.icon?s("ImageViewer",{attrs:{data:i.data}}):s("DataViewer",{attrs:{data:i.data}})]}}])})},N=[],V=s("d700"),B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"imageViewer",staticClass:"imageViewer",class:{fullscreen:e.fullScreen}},[s("div",{staticClass:"toolbar"},[s("span",{staticClass:"value",attrs:{title:e.valueTitle}},[e._v(e._s(e.valueText))]),s("FullscreenButton",{staticClass:"fullscreen-button",attrs:{element:function(){return e.$refs.imageViewer}},on:{changed:e.fullscreenToggled}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.loaded,expression:"!loaded"}],staticClass:"noDataMessage"},[s("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" Loading image...")]),s("canvas",{ref:"canvas",class:{fullsize:e.fullSize},attrs:{title:e.title},on:{click:e.resize,mousemove:e.getPixelValue,mouseout:e.resetPixelValue,load:e.imageLoaded}})])},z=[],U=s("5472"),G={name:"ImageViewer",components:{FullscreenButton:U["a"]},props:{data:{required:!0}},data(){return{fullScreen:!1,fullSize:!1,img:null,loaded:!1,context:null,value:"-"}},mounted(){this.data.blob?this.showImageBlob(this.data.blob):this.data.url&&this.showImage(this.data.url)},computed:{title(){return this.fullScreen?"":this.fullSize?"Click to shrink (fit to screen)":"Click to enlarge (full size)"},valueTitle(){return this.fullScreen||this.fullSize?"":"Show in full size to get precise values"},valueText(){return this.fullScreen||this.fullSize?"Pixel Value: "+this.value:"Estimated Pixel Value: "+this.value}},methods:{showImage(e){this.loaded=!1,this.img=new Image,this.img.crossOrigin="Anonymous",this.img.onload=this.imageLoaded.bind(this),this.img.src=e},showImageBlob(e){this.showImage(URL.createObjectURL(e))},imageLoaded(){this.loaded=!0,this.$refs.canvas.width=this.img.naturalWidth,this.$refs.canvas.height=this.img.naturalHeight,this.context=this.$refs.canvas.getContext("2d"),this.context.drawImage(this.img,0,0)},fullscreenToggled(e){this.fullScreen=e},resize(){this.fullScreen||(this.fullSize=!this.fullSize)},resetPixelValue(){this.value="-"},getPixelValue(e){try{let t=this.$refs.canvas.getBoundingClientRect(),s=this.img.naturalWidth/t.width,i=this.img.naturalHeight/t.height,a=e.offsetX*s,r=e.offsetY*i,[o,n,l,c]=this.context.getImageData(Math.ceil(a),Math.ceil(r),1,1).data;this.value=0===c?"no data":o==n&&n===l?255===c?o:`${o}, Alpha: ${c}`:`Red: ${o}, Green: ${n}, Blue: ${l}, Alpha: ${c}`}catch(t){this.value="n/a",console.log(t)}}}},H=G,W=(s("9ba7"),Object(d["a"])(H,B,z,!1,null,"38f11af8",null)),q=W.exports,X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"log-viewer"},[null===e.logs?s("div",{staticClass:"noDataMessage"},[s("i",{staticClass:"fas fa-spinner fa-spin fa-lg"}),e._v(" Loading logs...")]):s("Logs",{attrs:{logs:e.logs}})],1)},Y=[],K=s("b60c"),Z={name:"LogViewer",mixins:[r["a"]],components:{Logs:K["a"]},props:{data:{type:[Object,Array],required:!0}},data(){return{logs:null,syncTimer:null}},computed:{...o["a"].mapState(["connection"]),isJob(){return o["a"].isObject(this.data)&&"function"===typeof this.data.debugJob},isService(){return o["a"].isObject(this.data)&&"function"===typeof this.data.debugService},logIterator(){return this.isJob?this.data.debugJob():this.isService?this.data.debugService():null}},created(){this.isJob&&this.listen("jobStatusUpdated",this.onJobStatusUpdated)},beforeDestroy(){this.onHide()},methods:{onShow(){this.loadNext(),this.isJob?this.onJobStatusUpdated(this.data):this.isService&&this.startWatcher()},onHide(){this.stopWatcher()},onJobStatusUpdated(e){if(e===this.data&&"string"===typeof this.data.status)switch(this.data.status.toLowerCase()){case"running":case"queued":this.startWatcher();break;default:this.stopWatcher()}},startWatcher(){null===this.syncTimer&&(this.syncTimer=setInterval(this.loadNext.bind(this),1e4))},stopWatcher(){null!==this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)},async loadNext(){if(this.logIterator){let e=await this.logIterator.nextLogs();Array.isArray(this.logs)||(this.logs=[]);for(let t of e)this.logs.push(t)}else Array.isArray(this.data)&&!this.logs&&(this.logs=this.data)}}},Q=Z,ee=(s("c46c"),Object(d["a"])(Q,X,Y,!1,null,null,null)),te=ee.exports,se=s("a5c1"),ie=s("b40f"),ae=s.n(ie),re={name:"Viewer",mixins:[r["a"]],components:{Tab:b["default"],Tabs:g["default"],DataViewer:V["a"],ImageViewer:q,LogViewer:te,MapViewer:se["default"]},mounted(){this.listen("viewBlob",this.showViewer),this.listen("viewLink",this.showViewer),this.listen("viewSyncResult",this.showSyncResults),this.listen("viewJobResults",this.showJobResults),this.listen("viewWebService",this.showWebService),this.listen("viewLogs",this.showLogs),this.listen("removeWebService",this.removeWebService),this.listen("showCollectionPreview",this.showCollectionPreview)},data(){return{tabCounter:{},mapActive:!1,logViewerIcons:["fa-bug","fa-bomb","fa-tasks"]}},computed:{...o["a"].mapState(["connection"])},methods:{...o["a"].mapActions(["describeCollection"]),async showCollectionPreview(e){if("string"===typeof e)try{e=await this.describeCollection(e)}catch(t){return void o["a"].error(this,"Sorry, can't load collection '"+e+"'.")}this.showMapViewer(),await this.$refs.mapViewer.addCollection(e)},showWebService(e){this.showMapViewer(),this.$refs.mapViewer.showWebService(e)},removeWebService(e){this.$refs.mapViewer.removeLayerFromMap(e)},showMapViewer(){this.$refs.tabs.selectTab("mapView")},showSyncResults(e){Array.isArray(e.logs)&&e.logs.length>0&&this.showLogs(e.logs),this.showViewer(e.data)},showJobResults(e,t){for(var s in e.assets){var i=e.assets[s];this.showViewer(i,this.makeTitle(s,t.id,!0))}},showLogs(e,t="Logs",s="fa-bug"){let i=Array.isArray(e)?t:o["a"].getResourceTitle(e,!0);this.$refs.tabs.addTab(i,s,e,null,!0,!0,e=>this.onShow(e),e=>this.onHide(e))},async onDrop(e){var t=e.dataTransfer.getData("application/vnd.openeo-node");if(!t)return;let s=JSON.parse(t);if("load_collection"===s.process_id){e.preventDefault();let t=o["a"].isObject(s.arguments)?s.arguments.id:null;try{let e=await this.describeCollection(t);this.showCollectionPreview(e)}catch(i){o["a"].error(this,"Sorry, can't load collection details for '"+t+"'.")}}},onShow(e){e.$children.length&&"function"===typeof e.$children[0].onShow?e.$children[0].onShow():"function"===typeof e.onShow&&e.onShow()},onHide(e){e.$children.length&&"function"===typeof e.$children[0].onHide?e.$children[0].onHide():"function"===typeof e.onHide&&e.onHide()},uniqueTitle(e){return this.tabCounter[e]?(this.tabCounter[e]++,e+" ("+this.tabCounter[e]+")"):(this.tabCounter[e]=1,e)},makeTitle(e,t,s=!1){return e?s?this.uniqueTitle(e):e:this.uniqueTitle(t)},async showViewer(e,t=null){var s={};o["a"].isObject(e)&&"string"===typeof e.href&&"string"===typeof e.type?(s.type=e.type,s.url=e.href):e instanceof Blob?(s.type=e.type,s.blob=e):o["a"].error(this,"Sorry, invalid data received."),"string"===typeof s.type&&-1!==s.type.indexOf("/")&&-1===s.type.indexOf("*")||o["a"].error(this,"Sorry, can't detect content type.");try{let e=ae.a.parse(s.type);s.type=e.type,s.parameters=e.parameters}catch(i){}switch(s.type){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":this.$refs.tabs.addTab(this.makeTitle(t,"Image"),"fa-image",s,null,!0,!0);break;case"application/json":case"text/plain":case"text/csv":this.$refs.tabs.addTab(this.makeTitle(t,"Data"),"fa-database",s,null,!0,!0);break;case"image/tiff":if(s.url&&"geotiff"===s.parameters.application){this.showMapViewer(),this.$refs.mapViewer.updateGeoTiffLayer(s.url,this.makeTitle(t,"GeoTiff"));break}default:if(s.blob instanceof Blob){C["OpenEO"].Environment.saveToFile(s.blob,o["a"].makeFileName("result",s.type));break}if(s.url)try{let e=await this.connection._get(s.url,"","blob"),t=o["a"].getFileNameFromURL(s.url);if(e.data instanceof Blob){C["OpenEO"].Environment.saveToFile(e.data,o["a"].makeFileName(t,s.type));break}}catch(i){console.error(i)}o["a"].error(this,"Sorry, content type not supported by the viewer and can't be downloaded.")}}}},oe=re,ne=(s("15dd"),Object(d["a"])(oe,O,N,!1,null,null,null)),le=ne.exports,ce=s("ceb0"),ue=s("2241"),de=s("cbd9"),he=s("fbda"),pe=s("512e"),me={name:"IDE",mixins:[r["a"]],components:{DiscoveryToolbar:de["a"],Editor:ce["default"],Logo:ue["a"],Viewer:le,UserMenu:p,UserWorkspace:J,Splitpanes:pe["Splitpanes"],Pane:pe["Pane"]},data(){return{resizeListener:null,userInfoUpdater:null}},computed:{...o["a"].mapState(["connection","isAuthenticated"]),...o["a"].mapState("editor",["context","process","collectionPreview"]),...o["a"].mapGetters(["title","apiVersion","supports"]),...o["a"].mapGetters("jobs",{supportsJobUpdate:"supportsUpdate"}),...o["a"].mapGetters("services",{supportsServiceUpdate:"supportsUpdate"}),...o["a"].mapGetters("userProcesses",{supportsUserProcessUpdate:"supportsUpdate"}),contextTitle(){return null!==this.context?o["a"].getResourceTitle(this.context,!0):""},saveSupported(){return null!==this.context&&(this.context instanceof C["Job"]&&this.supportsJobUpdate||this.context instanceof C["Service"]&&this.supportsServiceUpdate||this.context instanceof C["UserProcess"]&&this.supportsUserProcessUpdate)},hasProcess(){return o["a"].size(this.process)>0},validateSupported(){return this.supports("validateProcess")},splitpaneSizeH(){return this.isAuthenticated?[20,50,30]:[20,40,40]},splitpaneSizeV(){return this.isAuthenticated?[50,50]:[99,1]}},async mounted(){this.listen("showDataForm",this.showDataForm),this.listen("editProcess",this.editProcess),this.listen("showLogin",this.login),this.resizeListener=e=>this.resized(e),window.addEventListener("resize",this.resizeListener),this.isAuthenticated&&(this.userInfoUpdater=setInterval(this.describeAccount,60*this.$config.dataRefreshInterval*1e3)),this.emit("title",this.title),this.collectionPreview&&this.$nextTick(()=>{this.emit("showCollectionPreview",this.collectionPreview),this.setCollectionPreview(null)})},beforeDestroy(){null!==this.resizeListener&&window.removeEventListener("resize",this.resizeListener),null!==this.userInfoUpdater&&clearInterval(this.userInfoUpdater)},methods:{...o["a"].mapActions(["describeAccount"]),...o["a"].mapMutations(["discoveryCompleted"]),...o["a"].mapMutations("editor",["setContext","setProcess","setCollectionPreview"]),resized(e){this.emit("windowResized",e)},login(){this.discoveryCompleted(!1)},importProcess(){let e={save:this.updateEditor};this.emit("showModal","ImportProcessModal",{},e)},saveProcess(){this.emit("replaceProcess",this.context,this.process)},async exportCode(){this.emit("showModal","ExportCodeModal")},async validateProcess(){if(!this.validateSupported)return o["a"].error(this,"Server doesn't support validation");if(!this.hasProcess)return o["a"].info(this,"Nothing to validate...");try{let e=await this.connection.validateProcess(this.process);e.length>0?(e.forEach(e=>e.level="error"),this.emit("viewLogs",e,"Validation Result","fa-tasks")):o["a"].ok(this,"The process is valid")}catch(e){o["a"].exception(this,e,"Validation rejected")}},updateEditor(e){this.setProcess(e),null===e&&this.setContext(null)},editProcess(e){this.setContext(e)},insertProcess(e){this.$refs.editor.insertProcess(e)},showServerInfo(){this.emit("showModal","ServerInfoModal")},showHelp(){this.emit("showTour","ide")},showDataForm(e,t,s=null,i=null){var a="function"===typeof s,r={},o=[];for(let c of t)null!==c&&(o.push(new he["ProcessParameter"](c)),r[c.name]=c.value);let n={title:e,parameters:o,data:r,editable:a},l={};"function"===typeof s&&(l.save=s),"function"===typeof i&&(l.closed=i),this.emit("showModal","ParameterModal",n,l)}}},fe=me,ge=(s("80e5"),Object(d["a"])(fe,i,a,!1,null,null,null));t["default"]=ge.exports},fdbd:function(e,t,s){"use strict";s("8099")}}]);
//# sourceMappingURL=chunk-545f4342.a28be597.js.map