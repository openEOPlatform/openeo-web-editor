{"version":3,"sources":["webpack:///./src/components/openlayers/progress.js","webpack:///src/components/MapMixin.vue","webpack:///./src/components/MapMixin.vue","webpack:///./src/components/MapMixin.vue?a8d9","webpack:///./src/components/modals/Modal.vue?1509","webpack:///src/components/modals/Modal.vue","webpack:///./src/components/modals/Modal.vue?82de","webpack:///./src/components/modals/Modal.vue","webpack:///./src/components/modals/CollectionModal.vue?8b21","webpack:///./src/components/modals/CollectionModal.vue?bd44","webpack:///src/components/modals/CollectionModal.vue","webpack:///./src/components/modals/CollectionModal.vue?e3d0","webpack:///./src/components/modals/CollectionModal.vue","webpack:///./src/components/modals/Modal.vue?f34c","webpack:///./src/components/MapMixin.css?df6f","webpack:///./src/components/MapViewer.vue?b08f","webpack:///src/components/MapViewer.vue","webpack:///./src/components/MapViewer.vue?8175","webpack:///./src/components/MapViewer.vue"],"names":["Progress","constructor","this","createHtml","loading","loaded","addLoading","update","addLoaded","percent","toFixed","label","innerText","progressBarInner","style","width","el","opacity","show","document","createElement","className","progressBar","appendChild","getControl","c","Control","element","render","staticRenderFns","component","_vm","_h","$createElement","_c","_self","staticClass","zIndex","on","backgroundClose","ref","$event","preventDefault","stopPropagation","startMove","apply","arguments","_t","_v","_s","title","close","attrs","collection","id","$emit","scopedSlots","_u","key","fn","p","showMap","extents","currentItems","String","Date","now","geometry","hasPrevItems","paginate","hasNextItems","_e"],"mappings":"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ACA,qDACA,qDAGA,sBACA,8BACA,GACA,yBAIA,mBACA,sCACA,eACA,mBACA,SAGA,aAGA,6BACA,kBACA,KACA,mBACA,mBACA,4DACA,4BAIA,OADA,sBACA,GAIA,uBACA,uCACA,GACA,4DAGA,IAaA,EAbA,GACA,QACA,WACA,qBAWA,OAPA,iCACA,2CACA,0BAKA,qBACA,UACA,yBACA,MACA,WACA,SACA,iBACA,wBAEA,kCACA,MACA,QAEA,YADA,0EAIA,yBAGA,IACA,oDACA,4EACA,cACA,eACA,oBACA,mBACA,UACA,+BAEA,aAIA,eAEA,wBACA,UAEA,gBAEA,sBAEA,0BACA,SACA,iBAIA,kBACA,6BACA,iCACA,oBACA,SAEA,iDACA,SAGA,eAFA,IAKA,4CAGA,GAFA,+BAEA,8BACA,qBACA,qCACA,gDACA,0DACA,iBACA,4CAGA,mCACA,OACA,OACA,OACA,OACA,+BACA,aACA,gBACA,wBACA,QACA,wBAEA,IACA,+BAGA,6BACA,aACA,qBACA,4BACA,UACA,OAEA,UACA,KAGA,IACA,gCACA,iBAEA,qBAEA,gBACA,kBACA,QACA,iCACA,sBAEA,UAGA,SAOA,MANA,0BACA,uBACA,iBACA,UACA,YAGA,wCACA,6BAGA,GACA,uBAEA,yBACA,IACA,wCACA,oBACA,SAEA,6DACA,iBACA,iBACA,SACA,eAEA,QACA,SAEA,mCAEA,yBACA,gCACA,oEACA,iBAEA,yBAGA,kBACA,QACA,QACA,WAaA,OAXA,sBAEA,eACA,qCACA,gBACA,sCACA,sBAKA,GAGA,8BACA,8BAGA,kHACA,+BACA,cACA,QACA,0CACA,SAEA,sBAEA,cACA,QACA,QACA,QACA,KAIA,OADA,sBACA,KCpYmV,I,wBCQ/UC,EAAY,eACd,EACAF,EACAC,GACA,EACA,KACA,KACA,MAIa,OAAAC,E","file":"js/chunk-22e7c7a4.c5a98974.js","sourcesContent":["import { Control } from 'ol/control.js';\n\nexport default class Progress {\n\n\tconstructor() {\n\t\tthis.createHtml();\n\t\tthis.loading = 0;\n\t\tthis.loaded = 0;\n\t}\n\n\taddLoading() {\n\t\tthis.loading++;\n\t\tthis.update();\n\t};\n\n\taddLoaded() {\n\t\tthis.loaded++;\n\t\tthis.update();\n\t}\n\n\tupdate() {\n\t\tvar percent = (this.loaded / this.loading * 100).toFixed(1) + '%';\n\t\n\t\tthis.label.innerText = \"Loading Tiles (\" + percent + \")\";\n\t\tthis.progressBarInner.style.width = percent;\n\n\t\tif (this.loading === this.loaded) {\n\t\t\tthis.loading = 0;\n\t\t\tthis.loaded = 0;\n\t\t}\n\n\t\tthis.el.style.opacity = this.show() ? 1 : 0;\n\t}\n\n\tshow() {\n\t\treturn (this.loading > 0 && this.loaded <= this.loading);\n\t}\n\n\tcreateHtml() {\n\t\tthis.el = document.createElement('div');\n\t\tthis.el.className = 'ol-unselectable ol-progress-control';\n\t\tthis.progressBar = document.createElement('div');\n\t\tthis.progressBar.className = 'progress-bar';\n\t\tthis.progressBarInner = document.createElement('div');\n\t\tthis.progressBarInner.className = 'progress-bar-inner';\n\t\tthis.progressBar.appendChild(this.progressBarInner);\n\t\tthis.label = document.createElement('div');\n\t\tthis.label.className = 'progress-label';\n\t\tthis.el.appendChild(this.progressBar);\n\t\tthis.el.appendChild(this.label);\n\t}\n\t\n\tgetControl() {\n\t\tvar c = new Control({\n\t\t\telement: this.el\n\t\t});\n\t\treturn c;\n\t}\n\n}","<script>\nimport EventBusMixin from './EventBusMixin.vue';\nimport Utils from '../utils.js';\n\nimport 'ol/ol.css';\nimport { defaults as defaultControls, FullScreen, ScaleLine } from 'ol/control';\nimport { isEmpty as extentIsEmpty } from 'ol/extent';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport Map from 'ol/Map';\nimport View from 'ol/View';\nimport { fromLonLat } from 'ol/proj';\nimport TileLayer from 'ol/layer/Tile';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport OSM from 'ol/source/OSM';\n\nimport 'ol-ext/control/LayerSwitcher.css';\nimport LayerSwitcher from 'ol-ext/control/LayerSwitcher';\n\nimport Progress from './openlayers/progress';\n\nexport default {\n\tmixins: [EventBusMixin],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tcenter: { // WGS84: lat, lon\n\t\t\ttype: Array,\n\t\t\tdefault: () => [0,0]\n\t\t},\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tshow: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\teditable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tremovableLayers: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tmap: null,\n\t\t\tbaseLayer: null,\n\t\t\tosm: null,\n\t\t\tprogress: null\n\t\t};\n\t},\n\twatch: {\n\t\tshow() {\n\t\t\tthis.showMap();\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.showMap();\n\t},\n\tmethods: {\n\t\tshowMap() {\n\t\t\tif (this.show) {\n\t\t\t\tthis.$nextTick(this.renderMap);\n\t\t\t}\n\t\t},\n\t\tcreateMap(showLayerSwitcher = false) {\n\t\t\tif (this.map !== null) {\n\t\t\t\tthis.map.updateSize();\n\t\t\t\tthis.map.render();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.progress = new Progress();\n\t\t\tthis.osm = new OSM();\n\t\t\tthis.baseLayer = new TileLayer({\n\t\t\t\tsource: this.trackTileProgress(this.osm),\n\t\t\t\tbaseLayer: true,\n\t\t\t\ttitle: \"OpenStreetMap\",\n\t\t\t\tnoSwitcherDelete: true\n\t\t\t});\n\t\t\tvar customControls = [\n\t\t\t\tnew FullScreen(),\n\t\t\t\tnew ScaleLine(),\n\t\t\t\tthis.progress.getControl()\n\t\t\t];\n\t\t\tif (showLayerSwitcher) {\n\t\t\t\tcustomControls.push(new LayerSwitcher({trash: this.removableLayers}));\n\t\t\t}\n\t\t\tvar mapOptions = {\n\t\t\t\ttarget: this.id,\n\t\t\t\tlayers: [\n\t\t\t\t\tthis.baseLayer\n\t\t\t\t],\n\t\t\t\tview: new View({\n\t\t\t\t\tcenter: fromLonLat([this.center[1], this.center[0]]),\n\t\t\t\t\tzoom: this.zoom\n\t\t\t\t})\n\t\t\t};\n\t\t\tif (!this.editable) {\n\t\t\t\tmapOptions.interactions = [];\n\t\t\t\tmapOptions.controls = customControls;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmapOptions.controls = defaultControls().extend(customControls);\n\t\t\t}\n\t\t\tthis.map = new Map(mapOptions);\n\n\t\t\tthis.listen('windowResized', this.updateMapSize);\n\t\t},\n\n\t\tonShow() {\n\t\t\tthis.listen('windowResized', this.updateMapSize);\n\t\t},\n\t\tonHide() {\n\t\t\tthis.unlisten('windowResized');\n\t\t},\n\n\t\t// To be overridden by implementing components.\n\t\trenderMap() {\n\t\t\tthis.createMap();\n\t\t},\n\n\t\tasync updateMapSize() {\n\t\t\tif (this.map) {\n\t\t\t\tawait this.$nextTick();\n\t\t\t\tthis.map.updateSize();\n\t\t\t}\n\t\t},\n\n\t\tgetVisibleLayers() {\n\t\t\tlet shownLayers = [];\n\t\t\tlet layers = this.map.getLayers().getArray();\n\t\t\tfor(let layer of layers) {\n\t\t\t\tif (layer.get('userLayer') && layer.getVisible()) {\n\t\t\t\t\tshownLayers.push(layer);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shownLayers;\n\t\t},\n\n\t\taddGeoJson(geojson) {\n\t\t\tvar sourceOpts = {};\n\t\t\tif (Utils.detectGeoJson(geojson)) {\n\t\t\t\tsourceOpts.features = (new GeoJSON()).readFeatures(\n\t\t\t\t\tgeojson,\n\t\t\t\t\t{\n\t\t\t\t\t\tfeatureProjection: this.osm.getProjection()\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tvar source = new VectorSource(sourceOpts);\n\t\t\tvar layer = new VectorLayer({\n\t\t\t\ttitle: \"GeoJSON\",\n\t\t\t\tsource: source\n\t\t\t});\n\t\t\tthis.map.addLayer(layer);\n\t\t\tvar extent = source.getExtent();\n\t\t\tif (!extentIsEmpty(extent)) {\n\t\t\t\tthis.map.getView().fit(extent);\n\t\t\t}\n\t\t\treturn layer;\n\t\t},\n\n\t\ttrackTileProgress(source) {\n\t\t\tsource.on('tileloadstart', () => {\n\t\t\t\tthis.progress.addLoading();\n\t\t\t});\n\t\t\tsource.on('tileloadend', () => {\n\t\t\t\tthis.progress.addLoaded();\n\t\t\t});\n\t\t\tsource.on('tileloaderror', () => {\n\t\t\t\tthis.progress.addLoaded();\n\t\t\t});\n\t\t\treturn source;\n\t\t}\n\n\t}\n}\n</script>","var render, staticRenderFns\nimport script from \"./MapMixin.vue?vue&type=script&lang=js&\"\nexport * from \"./MapMixin.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapMixin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapMixin.vue?vue&type=script&lang=js&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"modal\",style:({'z-index': _vm.zIndex}),on:{\"mousedown\":_vm.backgroundClose}},[_c('div',{ref:\"container\",staticClass:\"modal-container\",style:(_vm.style)},[_c('header',{staticClass:\"modal-header\",on:{\"mousedown\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.startMove.apply(null, arguments)}}},[_vm._t(\"header\",function(){return [_c('h2',[_vm._v(_vm._s(_vm.title))]),_c('span',{staticClass:\"close\",on:{\"click\":_vm.close}},[_c('i',{staticClass:\"fa fa-times\",attrs:{\"aria-hidden\":\"true\"}})])]})],2),_c('main',{staticClass:\"modal-content\"},[_vm._t(\"default\")],2),_c('footer',{staticClass:\"modal-footer\"},[_vm._t(\"footer\")],2)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div class=\"modal\" @mousedown=\"backgroundClose\" :style=\"{'z-index': zIndex}\">\n\t\t<div ref=\"container\" class=\"modal-container\" :style=\"style\">\n\t\t\t<header class=\"modal-header\" @mousedown.prevent.stop=\"startMove\">\n\t\t\t\t<slot name=\"header\">\n\t\t\t\t\t<h2>{{ title }}</h2>\n\t\t\t\t\t<span class=\"close\" @click=\"close\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></span>\n\t\t\t\t</slot>\n\t\t\t</header>\n\t\t\t<main class=\"modal-content\">\n\t\t\t\t<slot></slot>\n\t\t\t</main>\n\t\t\t<footer class=\"modal-footer\">\n\t\t\t\t<slot name=\"footer\"></slot>\n\t\t\t</footer>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport EventBusMixin from '../EventBusMixin.vue';\nimport Utils from '../../utils.js';\n\nexport default {\n\tname: 'Modal',\n\tmixins: [EventBusMixin],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\tminWidth: {\n\t\t\ttype: String,\n\t\t\tdefault: \"30%\"\n\t\t},\n\t\tmaxWidth: {\n\t\t\ttype: String,\n\t\t\tdefault: \"85%\"\n\t\t},\n\t\tminHeight: {\n\t\t\ttype: String,\n\t\t\tdefault: \"auto\"\n\t\t},\n\t\tshow: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tzIndex: 1000,\n\t\t\tposition: null,\n\t\t\tdragPosition: null\n\t\t};\n\t},\n    computed: {\n\t\t...Utils.mapState('editor', ['hightestModalZIndex']),\n\t\tstyle() {\n\t\t\tlet style = {\n\t\t\t\t'min-width': this.minWidth,\n\t\t\t\t'max-width': this.maxWidth,\n\t\t\t\t'min-height': this.minHeight\n\t\t\t};\n\t\t\tif (Array.isArray(this.position)) {\n\t\t\t\tstyle.position = 'absolute';\n\t\t\t\tstyle.left = this.position[0] + 'px';\n\t\t\t\tstyle.top = this.position[1] + 'px';\n\t\t\t}\n\t\t\treturn style;\n\t\t}\n    },\n\twatch: {\n\t\tshow: {\n\t\t\timmediate: true,\n\t\t\thandler(show) {\n\t\t\t\tif (!show) {\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.open();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\t...Utils.mapMutations('editor', ['openModal', 'closeModal']),\n\t\topen() {\n\t\t\tthis.openModal();\n\t\t\tthis.zIndex = this.hightestModalZIndex;\n\t\t\twindow.addEventListener('keydown', this.escCloseListener);\n\t\t\tthis.$emit('shown');\n\t\t},\n\t\tclose() {\n\t\t\twindow.removeEventListener('keydown', this.escCloseListener);\n\t\t\tthis.closeModal();\n\t\t\tthis.$emit('closed');\n\t\t},\n\t\tstartMove(event) {\n\t\t\tthis.dragPosition = [\n\t\t\t\tevent.clientX,\n\t\t\t\tevent.clientY\n\t\t\t];\n\n\t\t\tdocument.addEventListener('mousemove', this.move);\n\t\t\tdocument.addEventListener('mouseup', this.stopMove);\n\t\t},\n\t\tstopMove() {\n\t\t\tdocument.removeEventListener('mousemove', this.move);\n\t\t\tdocument.removeEventListener('mouseup', this.stopMove);\n\t\t},\n\t\tmove(event) {\n      \t\tevent.preventDefault();\n\t\t\t// set the element's new position\n\t\t\tthis.position = [\n\t\t\t\tthis.$refs.container.offsetLeft - (this.dragPosition[0] - event.clientX),\n\t\t\t\tthis.$refs.container.offsetTop - (this.dragPosition[1] - event.clientY)\n\t\t\t];\n\t\t\t// Store for later\n\t\t\tthis.dragPosition = [\n\t\t\t\tevent.clientX,\n\t\t\t\tevent.clientY\n\t\t\t];\n\t\t},\n\t\tescCloseListener(event) {\n\t\t\tif (event.key == \"Escape\") { \n\t\t\t\tthis.close();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tbackgroundClose(event) {\n\t\t\tif (event.target === this.$el) {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\">\n@import '../../../theme.scss';\n\n.modal {\n    position: fixed;\n    z-index: 1000; /* Snotify has 9999 and is intentionally above the modals */\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0,0,0,0.4);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.modal .modal-container {\n    background-color: #fff;\n    border: 1px solid #fff;\n\tmax-height: 96%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbox-shadow: 8px 8px 8px 0px rgba(0,0,0,0.3);\n\tresize: both;\n\toverflow: hidden;\n}\n\n.modal .modal-header {\n\tbackground-color: $mainColor;\n\tcolor: white;\n\tmargin: 0;\n\theight: 1.5rem;\n\tpadding: 1rem;\n\tdisplay: flex;\n\talign-items: center;\n    cursor: move;\n}\n\n.modal .modal-header h2 {\n\tdisplay: inline-block;\n\tflex-grow: 1;\n\tmargin: 0;\n\tfont-size: 1.5rem;\n\tborder: 0;\n\tpadding: 0;\n}\n\n.modal .modal-content {\n    padding: 1rem;\n\toverflow: auto;\n\tflex-grow: 1;\n}\n\n.modal .inline .modal-content {\n\tpadding: 0;\n}\n\n.modal .modal-footer:empty {\n\tdisplay: none;\n}\n\n.modal .modal-footer {\n\tbackground-color: #eee;\n\tmargin: 0;\n\tpadding: 1rem;\n}\n\n.modal .close {\n\tfont-size: 1.5rem;\n\theight: 2rem;\n\twidth: 2rem;\n    color: white;\n    cursor: pointer;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.modal .close:hover, .modal .close:focus {\n    color: red;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Modal.vue?vue&type=template&id=3152d480&\"\nimport script from \"./Modal.vue?vue&type=script&lang=js&\"\nexport * from \"./Modal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Modal.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionModal.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Modal',{attrs:{\"title\":_vm.collection.id},on:{\"closed\":function($event){return _vm.$emit('closed')}}},[_c('div',{staticClass:\"docgen\"},[_c('Collection',{attrs:{\"data\":_vm.collection},scopedSlots:_vm._u([{key:\"spatial-extents\",fn:function(p){return [_c('MapViewer',{staticClass:\"map\",attrs:{\"id\":\"collectionMap\",\"show\":_vm.showMap,\"extents\":p.extents}})]}}])}),(_vm.currentItems)?_c('section',[_c('Items',{attrs:{\"items\":_vm.currentItems},scopedSlots:_vm._u([{key:\"item-location\",fn:function(p){return [_c('MapViewer',{attrs:{\"id\":String(Date.now()),\"geoJson\":p.geometry}})]}}],null,false,3894742568)}),_c('div',{staticClass:\"pagination\"},[_c('button',{attrs:{\"title\":\"Previous page\",\"disabled\":!_vm.hasPrevItems},on:{\"click\":function($event){return _vm.paginate(-1)}}},[_c('i',{staticClass:\"fas fa-arrow-left\"}),_vm._v(\" Previous Page\")]),_c('button',{attrs:{\"title\":\"Next page\",\"disabled\":!_vm.hasNextItems},on:{\"click\":function($event){return _vm.paginate(1)}}},[_vm._v(\"Next Page \"),_c('i',{staticClass:\"fas fa-arrow-right\"})])])],1):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<Modal :title=\"collection.id\" @closed=\"$emit('closed')\">\n\t\t<div class=\"docgen\">\n\t\t\t<Collection :data=\"collection\">\n\t\t\t\t<template #spatial-extents=\"p\">\n\t\t\t\t\t<MapViewer class=\"map\" id=\"collectionMap\" :show=\"showMap\" :extents=\"p.extents\"></MapViewer>\n\t\t\t\t</template>\n\t\t\t</Collection>\n\t\t\t<section v-if=\"currentItems\">\n\t\t\t\t<Items :items=\"currentItems\">\n\t\t\t\t\t<template #item-location=\"p\">\n\t\t\t\t\t\t<MapViewer :id=\"String(Date.now())\" :geoJson=\"p.geometry\"></MapViewer>\n\t\t\t\t\t</template>\n\t\t\t\t</Items>\n\t\t\t\t<div class=\"pagination\">\n\t\t\t\t\t<button title=\"Previous page\" @click=\"paginate(-1)\" :disabled=\"!hasPrevItems\"><i class=\"fas fa-arrow-left\"></i> Previous Page</button>\n\t\t\t\t\t<button title=\"Next page\" @click=\"paginate(1)\" :disabled=\"!hasNextItems\">Next Page <i class=\"fas fa-arrow-right\"></i></button>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\t</Modal>\n</template>\n\n<script>\nimport MapViewer from '../MapViewer.vue';\nimport Modal from './Modal.vue';\nimport Collection from '@openeo/vue-components/components/Collection.vue';\nimport Utils from '../../utils.js';\n\nexport default {\n\tname: 'CollectionModal',\n\tcomponents: {\n\t\tMapViewer,\n\t\tModal,\n\t\tCollection,\n\t\tItems: () => import('@openeo/vue-components/components/Items.vue')\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowMap: false,\n\t\t\titems: [],\n\t\t\titemsPage: 0,\n\t\t\titemsIterator: null\n\t\t};\n\t},\n\tprops: {\n\t\tcollection: {\n\t\t\ttype: Object\n\t\t}\n\t},\n\tcomputed: {\n\t\t...Utils.mapState(['connection']),\n\t\t...Utils.mapGetters(['supports']),\n\t\tbbox() {\n\t\t\ttry {\n\t\t\t\treturn this.collection.extent.spatial.bbox[0];\n\t\t\t} catch(e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tcurrentItems() {\n\t\t\tif (this.items.length >= this.itemsPage) {\n\t\t\t\treturn this.items[this.itemsPage];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\thasPrevItems() {\n\t\t\treturn (this.itemsPage > 0);\n\t\t},\n\t\thasNextItems() {\n\t\t\treturn (this.itemsPage < this.items.length - 1);\n\t\t}\n\t},\n\tasync mounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.showMap = true;\n\t\t});\n\n\t\tif (this.supports('listCollectionItems')) {\n\t\t\tawait this.nextItems();\n\t\t\t// Always request a page in advance so that we know whether a next page is available.\n\t\t\tthis.nextItems();\n\t\t}\n\t},\n\tmethods: {\n\t\tasync paginate(step) {\n\t\t\tif (step > 0) {\n\t\t\t\tawait this.nextItems();\n\t\t\t}\n\t\t\telse if (this.itemsPage === 0 && step < 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemsPage += step;\n\t\t},\n\t\tasync nextItems() {\n\t\t\tif (!this.itemsIterator) {\n\t\t\t\tthis.itemsIterator = await this.connection.listCollectionItems(this.collection.id);\n\t\t\t}\n\t\t\tlet next = await this.itemsIterator.next();\n\t\t\tif (next && next.value && !next.done) {\n\t\t\t\tthis.items.push(next.value);\n\t\t\t}\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\">\n.vue-component.styled-description .docgen {\n\th1, h2, h3, h4, h5 {\n\t\tmargin: 1.5em 0 0 0;\n\t\tpadding: 0;\n\t\tborder: 0;\n\t\tfont-size: 1.1em;\n\t}\n\th1 {\n\t\tfont-size: 1.2em;\n\t}\n\th2 {\n\t\tfont-size: 1.15em;\n\t}\n}\n.docgen .collection > h2 {\n\tdisplay: none;\n}\n.docgen .items > h2 {\n\tdisplay: block;\n\tfont-size: 1.4em;\n    margin-top: 1.5em;\n    border-bottom-style: dotted;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CollectionModal.vue?vue&type=template&id=4ce7143a&\"\nimport script from \"./CollectionModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CollectionModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CollectionModal.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./MapMixin.css?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":_vm.id}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div :id=\"id\"></div>\n</template>\n\n<script>\nimport MapMixin from './MapMixin.vue';\nimport Utils from '../utils.js';\n\nimport Collection from 'ol/Collection';\nimport Feature from 'ol/Feature';\nimport LayerGroup from 'ol/layer/Group';\nimport { fromExtent as PolygonFromExtent } from 'ol/geom/Polygon';\nimport { fromLonLat } from 'ol/proj';\nimport TileLayer from 'ol/layer/Tile';\nimport TileJSON from 'ol/source/TileJSON';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport XYZ from 'ol/source/XYZ';\nimport WMTSCapabilities from 'ol/format/WMTSCapabilities';\nimport WMTS, {optionsFromCapabilities} from 'ol/source/WMTS';\n\nimport 'ol-ext/control/Swipe.css';\nimport Swipe from 'ol-ext/control/Swipe';\n\nimport 'ol-ext/control/Timeline.css';\nimport Timeline from 'ol-ext/control/Timeline';\n\nexport default {\n\tname: 'MapViewer',\n\tmixins: [MapMixin],\n\tprops: {\n\t\textents: { // Array of Array (WGS84: west, south, east, north)\n\t\t\ttype: Array,\n\t\t\tdefault: () => null\n\t\t},\n\t\tgeoJson: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => null\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tWMTSCapabilities: {},\n\t\t\tswipe: {\n\t\t\t\tcontrol: null,\n\t\t\t\tleft: null,\n\t\t\t\tright: null\n\t\t\t},\n\t\t\ttimeline: null\n\t\t}\n\t},\n\tmethods: {\n\t\trenderMap() {\n\t\t\tlet showExtents = Array.isArray(this.extents) && this.extents.length > 0;\n\t\t\tthis.createMap(!showExtents);\n\n\t\t\tif (showExtents) {\n\t\t\t\tfor(let extent of this.extents) {\n\t\t\t\t\tvar bbox = Utils.extentToBBox(extent);\n\t\t\t\t\tthis.addRectangle(bbox.west, bbox.east, bbox.north, bbox.south);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Utils.isObject(this.geoJson)) {\n\t\t\t\tthis.geoJsonLayer = this.addGeoJson(this.geoJson);\n\t\t\t}\n\n\t\t\tlet layers = this.map.getLayers();\n\t\t\tlayers.on('add', () => this.toggleSwipeControl());\n\t\t\tlayers.on('remove', () => this.toggleSwipeControl());\n\n\t\t\tif (this.$listeners && this.$listeners.drop) {\n\t\t\t\tthis.map.getViewport().addEventListener('dragover', event => event.preventDefault());\n\t\t\t\tthis.map.getViewport().addEventListener('drop', this.$listeners.drop);\n\t\t\t}\n\t\t},\n\n\t\taddRectangle(w, e, n, s) {\n\t\t\tlet extent = [...fromLonLat([w, s]), ...fromLonLat([e, n])];\n\t\t\tlet layer = new VectorLayer({\n\t\t\t\ttitle: \"Extent\",\n\t\t\t\tdisplayInLayerSwitcher: false,\n\t\t\t\tsource: new VectorSource({\n\t\t\t\t\tfeatures: [\n\t\t\t\t\t\tnew Feature(PolygonFromExtent(extent))\n\t\t\t\t\t],\n\t\t\t\t\twrapX: false\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.map.addLayer(layer);\n\t\t\tthis.map.getView().fit(extent);\n\t\t\t// ToDo: The Collection component has some smart fitting behavior in setMapSize()\n\t\t\t// Implement something similar here, too.\n\t\t},\n\n\t\tasync showWebService(service) {\n\t\t\tswitch(service.type.toLowerCase()) {\n\t\t\t\tcase 'xyz':\n\t\t\t\t\tthis.updateXYZLayer(service);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'wmts':\n\t\t\t\t\tawait this.updateWMTSLayer(service);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tUtils.error(this, 'Sorry, the service type is not supported by the map.');\n\t\t\t}\n\t\t},\n\n\t\ttoggleSwipeControl() {\n\t\t\tvar shownLayers = this.getVisibleLayers();\n\t\t\tif (shownLayers.length === 2) {\n\t\t\t\tif (this.swipe.control === null) {\n\t\t\t\t\tthis.swipe.control = new Swipe();\n\t\t\t\t\tthis.map.addControl(this.swipe.control);\n\t\t\t\t}\n\t\t\t\tif (this.swipe.left !== shownLayers[0]) {\n\t\t\t\t\tthis.swipe.control.addLayer(shownLayers[0]);\n\t\t\t\t\tthis.swipe.left = shownLayers[0];\n\t\t\t\t}\n\t\t\t\tif (this.swipe.right !== shownLayers[1]) {\n\t\t\t\t\tthis.swipe.control.addLayer(shownLayers[1], true);\n\t\t\t\t\tthis.swipe.right = shownLayers[1];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.map.removeControl(this.swipe.control);\n\t\t\t\tthis.swipe.control = null;\n\t\t\t\tthis.swipe.left = null;\n\t\t\t\tthis.swipe.right = null;\n\t\t\t}\n\t\t},\n\n\t\taddLayerToMap(layer) {\n\t\t\tlayer.set('userLayer', true);\n\n\t\t\tthis.map.addLayer(layer);\n\n\t\t\tlayer.on('change', () => this.toggleSwipeControl());\n\t\t\tlayer.on('change:visible', () => this.toggleSwipeControl());\n\t\t\tlayer.on('change:zIndex', () => this.toggleSwipeControl());\n\t\t},\n\n\t\tremoveLayerFromMap(id) {\n\t\t\tlet layer = this.getLayerFromMap(id);\n\t\t\tif (layer) {\n\t\t\t\tthis.map.removeLayer(layer);\n\t\t\t}\n\t\t},\n\n\t\tgetLayerFromMap(id) {\n\t\t\tlet layers = this.map.getLayers().getArray();\n\t\t\tfor(let layer of layers) {\n\t\t\t\tif (layer.get('id') === id) {\n\t\t\t\t\treturn layer;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tupdateGeoTiffLayer(url, title = null) {\n\t\t\tvar layer = new TileLayer({\n\t\t\t\tid: url,\n\t\t\t\ttitle: title ? title : 'GeoTiff',\n\t\t\t\tsource: new TileJSON({\n\t\t\t\t\turl: 'http://tiles.rdnt.io/tiles?url=' + encodeURIComponent(url),\n\t\t\t\t\tcrossOrigin: 'anonymous'\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis.addLayerToMap(layer);\n\t\t\treturn layer;\n\t\t\t// ToDo: Implement full/native GTiff support\n\t\t},\n\n\t\tasync addCollection(collection) {\n\t\t\tlet link = Utils.getPreviewLinkFromSTAC(collection);\n\t\t\tif (!link) {\n\t\t\t\tUtils.error(this, 'No visualizations found for collection');\n\t\t\t}\n\n\t\t\tlet service = {\n\t\t\t\tid: collection.id,\n\t\t\t\turl: link.href,\n\t\t\t\ttitle: collection.title || collection.id\n\t\t\t};\n\n\t\t\t// Remove other previewLayers, only show one at a time\n\t\t\tthis.map.getLayers().forEach(layer => {\n\t\t\t\tif (layer.get('previewLayer') && layer.get('id') !== service.id) {\n\t\t\t\t\tthis.map.removeLayer(layer);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet layer;\n\t\t\tswitch(link.rel.toLowerCase()) {\n\t\t\t\tcase 'xyz':\n\t\t\t\t\tlayer = this.updateXYZLayer(service);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'wmts':\n\t\t\t\t\tlet layers = [];\n\t\t\t\t\tif (link['wmts:layer']) {\n\t\t\t\t\t\tlayers.push(link['wmts:layer']);\n\t\t\t\t\t}\n\t\t\t\t\tlayer = await this.updateWMTSLayer(service, layers);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tUtils.error(this, 'Sorry, the service type is not supported by the map.');\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlayer.set('previewLayer', true);\n\n\t\t\t// Fit to extent of collection\n\t\t\ttry {\n\t\t\t\tlet bbox = Utils.extentToBBox(collection.extent.spatial.bbox[0]);\n\t\t\t\tlet extent = [...fromLonLat([bbox.west, bbox.south]), ...fromLonLat([bbox.east, bbox.north])];\n\t\t\t\tlet extentLayer = new VectorLayer({\n\t\t\t\t\ttitle: \"Extent\",\n\t\t\t\t\tnoSwitcherDelete: true,\n\t\t\t\t\tsource: new VectorSource({\n\t\t\t\t\t\tfeatures: [\n\t\t\t\t\t\t\tnew Feature(PolygonFromExtent(extent))\n\t\t\t\t\t\t],\n\t\t\t\t\t\twrapX: false\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\n\t\t\t\tlet style = extentLayer.getStyle();\n\t\t\t\t// https://github.com/openlayers/openlayers/issues/10131\n\t\t\t\tif (typeof style === 'function') {\n\t\t\t\t\tstyle = style()[0];\n\t\t\t\t}\n\t\t\t\tstyle.setFill(null);\n\n\t\t\t\tlayer.getLayers().push(extentLayer);\n\n\t\t\t\tthis.map.getView().fit(extent);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t},\n\n\t\tgetWMTSTimes(capabilities, layerId) {\n\t\t\tconst layers = capabilities.Contents.Layer || [];\n\t\t\tlet layer = layers.find(l => l.Identifier == layerId);\n\t\t\tif (!layer || !layer.Dimension) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tlet timeDimension = layer.Dimension.find(d => d.Identifier === 'TIME');\n\t\t\tif (!timeDimension) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\treturn timeDimension.Value.sort();\n\t\t},\n\n\t\tasync updateWMTSLayer(service, layerNames = [], time = undefined, prefix = \"Service\") {\n\t\t\tthis.removeLayerFromMap(service.id);\n\n\t\t\tif (!this.WMTSCapabilities[service.url]) {\n\t\t\t\tlet url = new URL(service.url);\n\t\t\t\turl.searchParams.set('service', 'wmts');\n\t\t\t\turl.searchParams.set('request', 'GetCapabilities');\n\t\t\t\tlet response = await axios.get(url.toString(), { responseType: 'text' });\n\t\t\t\tvar parser = new WMTSCapabilities();\n\t\t\t\tthis.WMTSCapabilities[service.url] = parser.read(response.data);\n\t\t\t}\n\n\t\t\tlet capabilities = this.WMTSCapabilities[service.url];\n\t\t\tlet minDate = null;\n\t\t\tlet maxDate = null;\n\t\t\tlet defaultDate = null;\n\t\t\tlet source = null;\n\t\t\tlet title = Utils.getResourceTitle(service, prefix);\n\t\t\tlet layerCollection = new Collection();\n\t\t\tfor(let layer of layerNames) {\n\t\t\t\tlet options = optionsFromCapabilities(capabilities, {\n\t\t\t\t\tlayer,\n\t\t\t\t\tmatrixSet: 'EPSG:3857'\n\t\t\t\t});\n\t\t\t\tif (!defaultDate) {\n\t\t\t\t\tdefaultDate = new Date(options.dimensions.TIME);\n\t\t\t\t}\n\n\t\t\t\tlet times = this.getWMTSTimes(capabilities, layer);\n\t\t\t\tif (times.length) {\n\t\t\t\t\tlet min = new Date(times[0]);\n\t\t\t\t\tlet max = new Date(times[times.length -1]);\n\t\t\t\t\tif (!minDate || min < minDate) {\n\t\t\t\t\t\tminDate = min;\n\t\t\t\t\t}\n\t\t\t\t\tif (!maxDate || max > maxDate) {\n\t\t\t\t\t\tmaxDate = max;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (time) {\n\t\t\t\t\tif (!Utils.isObject(options.dimensions)) {\n\t\t\t\t\t\toptions.dimensions = {};\n\t\t\t\t\t}\n\t\t\t\t\toptions.dimensions.time = time;\n\t\t\t\t}\n\t\t\t\tsource = new WMTS(options);\n\t\t\t\tvar mapLayer = new TileLayer({\n\t\t\t\t\ttitle,\n\t\t\t\t\tsource: this.trackTileProgress(source),\n\t\t\t\t\tnoSwitcherDelete: true\n\t\t\t\t});\n\t\t\t\tlayerCollection.push(mapLayer);\n\t\t\t}\n\n\t\t\tif (minDate && maxDate) {\n\t\t\t\tthis.timeline = new Timeline({\n\t\t\t\t\tclassName: 'ol-pointer',\n\t\t\t\t\tgraduation: 'day',\n\t\t\t\t\tminDate: minDate,\n\t\t\t\t\tmaxDate: maxDate\n\t\t\t\t});\n\t\t\t\tlet run;\n\t\t\t\tthis.timeline.on('scroll', function(e) {\n\t\t\t\t\tif (!e.date || e.date > maxDate || e.date < minDate) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (run) {\n\t\t\t\t\t\twindow.clearTimeout(run);\n\t\t\t\t\t}\n\t\t\t\t\trun = window.setTimeout(() => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tlet date = e.date.toISOString().substr(0, 10);\n\t\t\t\t\t\t\tsource.updateDimensions({\n\t\t\t\t\t\t\t\tTIME: date\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tlet btns = document.getElementsByClassName('timeline-date-label');\n\t\t\t\t\t\t\tbtns[0].innerText = date;\n\t\t\t\t\t\t\tbtns[0].disabled = true;\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trun = null;\n\t\t\t\t\t}, 500);\n\t\t\t\t});\n\t\t\t\tthis.map.addControl(this.timeline);\n\n\t\t\t\tthis.timeline.addButton({\n\t\t\t\t\tclassName: 'timeline-date-label',\n\t\t\t\t\ttitle: `The date that is shown on the map for the collection '${title}'`,\n\t\t\t\t\thtml: 'No date'\n\t\t\t\t});\n\t\t\t\tthis.timeline.setDate(defaultDate);\n\t\t\t}\n\n\t\t\tlet group = new LayerGroup({\n\t\t\t\tid: service.id,\n\t\t\t\ttitle,\n\t\t\t\tlayers: layerCollection\n\t\t\t});\n\t\t\tthis.addLayerToMap(group);\n\n\t\t\tif (this.timeline) {\n\t\t\t\tthis.map.getLayers().on('remove', event => {\n\t\t\t\t\tif (event.element === group) {\n\t\t\t\t\t\tthis.map.removeControl(this.timeline);\n\t\t\t\t\t\tthis.timeline = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn group;\n\t\t},\n\n\t\tupdateXYZLayer(service, prefix = \"Service\") {\n\t\t\tthis.removeLayerFromMap(service.id);\n\n\t\t\t// Replace/add a query parameter with a unique ID so that OpenLayers doesn't load tiles from cache\n\t\t\tlet url = Utils.replaceParam(service.url, '__editorSessionId', new Date().getTime()).replace(/%7B/g, '{').replace(/%7D/g, '}');\n\t\t\tlet title = Utils.getResourceTitle(service, prefix);\n\t\t\tlet layer = new TileLayer({\n\t\t\t\ttitle,\n\t\t\t\tsource: this.trackTileProgress(new XYZ({\n\t\t\t\t\turl\n\t\t\t\t})),\n\t\t\t\tnoSwitcherDelete: true\n\t\t\t});\n\t\t\tlet group = new LayerGroup({\n\t\t\t\tid: service.id,\n\t\t\t\ttitle,\n\t\t\t\tlayers: [\n\t\t\t\t\tlayer\n\t\t\t\t]\n\t\t\t});\n\t\t\tthis.addLayerToMap(group);\n\t\t\treturn group;\n\t\t}\n\n\t}\n\n}\n</script>\n\n<style src=\"./MapMixin.css\"></style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapViewer.vue?vue&type=template&id=6a9aa486&\"\nimport script from \"./MapViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./MapViewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapMixin.css?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}