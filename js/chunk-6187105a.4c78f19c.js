(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6187105a"],{1416:function(e,t,a){},"26e7":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"geojson-map-editor",attrs:{id:e.id}},[a("ProgressControl",{ref:"progress",attrs:{map:e.map}})],1)},i=[],o=a("4bc5"),r=a("330e"),n=a("025e"),l=a("a2e1"),d=a("b2fc"),c=a("0af5"),u=(a("faaa"),a("f087")),h=a("e887"),p=(a("159a"),a("c516")),m=a("d803"),f={name:"GeoJsonMapEditor",mixins:[o["a"],r["a"]],props:{value:{type:Object,default:null}},data(){return{geoJsonLayer:null}},methods:{async renderMap(){let e=!0;if(this.value){let t=this.createGeoJsonSource(this.value),a=t.getExtent();Object(c["G"])(a)||(e=!1!==n["a"].isBboxInWebMercator(n["a"].extentToBBox(a)))}if(await this.createMap(e?"EPSG:3857":"EPSG:4326"),this.addBasemaps(),this.editable?this.geoJsonLayer=this.geoJsonEditor(e?this.value:source):this.geoJsonLayer=this.addGeoJson(e?this.value:source),this.editable){var t=()=>this.$emit("input",this.getGeoJson());this.geoJsonLayer.getSource().on("change",t)}},geoJsonEditor(e){var t=this.addGeoJson(e),a=new u["a"];this.map.addControl(a);var s=new p["a"]({source:t.getSource(),interactions:{Info:!1,DrawHole:!1,Offset:!1,Split:!1}});a.addControl(s);var i=new m["a"];this.map.addInteraction(i),i.on("undo",e=>{"addfeature"===e.action.type&&(s.getInteraction("Select").getFeatures().clear(),s.getInteraction("Transform").select())});var o=new u["a"]({group:!0,controls:[new h["a"]({html:'<i class="fas fa-undo-alt"></i>',title:"Undo",handleClick:()=>i.undo()}),new h["a"]({html:'<i class="fas fa-redo-alt"></i>',title:"Redo",handleClick:()=>i.redo()})]});return a.addControl(o),this.map.addInteraction(new d["a"]({source:t.getSource()})),t},getGeoJson(){var e=new l["a"],t=this.geoJsonLayer.getSource().getFeatures(),a=[];for(var s in t)a.push(e.writeFeatureObject(t[s],{dataProjection:"EPSG:4326",featureProjection:this.map.getView().getProjection()}));return 0===a.length?null:1===a.length?!a[0].properties&&a[0].geometry?a[0].geometry:a[0]:{type:"FeatureCollection",features:a}}}},g=f,y=(a("63a9"),a("faca"),a("2877")),v=Object(y["a"])(g,s,i,!1,null,null,null);t["a"]=v.exports},2930:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal",style:{"z-index":e.zIndex},on:{mousedown:e.backgroundClose}},[a("div",{ref:"container",staticClass:"modal-container",style:e.style},[a("header",{staticClass:"modal-header",on:{mousedown:e.startMove}},[e._t("header",(function(){return[a("h2",[e._v(e._s(e.title))]),a("span",{staticClass:"close",on:{click:e.close}},[a("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]}))],2),a("main",{staticClass:"modal-content"},[e._t("default")],2),a("footer",{staticClass:"modal-footer"},[e._t("footer")],2)])])},i=[],o=a("3115"),r=a("025e"),n={name:"Modal",mixins:[o["a"]],props:{title:{type:String,default:null},minWidth:{type:String,default:null},width:{type:String,default:"auto"},show:{type:Boolean,default:!0}},data(){return{zIndex:1e3,position:null,dragPosition:null}},computed:{...r["a"].mapState("editor",["hightestModalZIndex"]),style(){let e={width:this.width};return this.minWidth&&(e["min-width"]=this.minWidth),Array.isArray(this.position)&&(e.position="absolute",e.left=this.position[0]+"px",e.top=this.position[1]+"px"),e}},watch:{show:{immediate:!0,handler(e){e?this.open():this.close()}}},methods:{...r["a"].mapMutations("editor",["openModal","closeModal"]),open(){this.openModal(),this.zIndex=this.hightestModalZIndex,window.addEventListener("keydown",this.escCloseListener),this.$emit("shown")},close(){window.removeEventListener("keydown",this.escCloseListener),this.closeModal(),this.$emit("closed")},startMove(e){"H2"!==e.target.tagName&&(this.dragPosition=[e.clientX,e.clientY],document.addEventListener("mousemove",this.move),document.addEventListener("mouseup",this.stopMove),e.preventDefault(),e.stopPropagation())},stopMove(){document.removeEventListener("mousemove",this.move),document.removeEventListener("mouseup",this.stopMove)},move(e){e.preventDefault(),this.position=[this.$refs.container.offsetLeft-(this.dragPosition[0]-e.clientX),this.$refs.container.offsetTop-(this.dragPosition[1]-e.clientY)],this.dragPosition=[e.clientX,e.clientY]},escCloseListener(e){if("Escape"==e.key)return this.close(),e.preventDefault(),e.stopPropagation(),!1},backgroundClose(e){e.target===this.$el&&this.close()}}},l=n,d=(a("8781"),a("2877")),c=Object(d["a"])(l,s,i,!1,null,null,null);t["a"]=c.exports},"2d6d":function(e,t,a){"use strict";a("4ed6")},"2e68":function(e,t,a){"use strict";a("ffc9")},"330e":function(e,t,a){"use strict";var s,i,o=a("025e"),r=a("3115"),n=a("0af5"),l=a("06f8"),d=a("a2e1"),c=a("2ce2"),u=a("3e6b"),h=a("5831"),p={mixins:[r["a"]],methods:{addGeoJson(e,t=!1,a="GeoJSON",s=!0){let i;i=e instanceof h["a"]?e:this.createGeoJsonSource(e,this.map.getView().getProjection());let o=new u["a"]({title:a,source:i});!s&&this.removeLayerFill&&this.removeLayerFill(o),this.map.addLayer(o);let r=i.getExtent();if(Object(n["G"])(r)||this.map.getView().fit(r,this.getFitOptions()),t){var d=new c["a"]({hitTolerance:5,multi:!1,condition:l["m"],layers:[o]});d.on("select",this.onSelect),this.map.addInteraction(d)}return o},onSelect(e){if(e.selected.length>0){let t=e.selected[0],a=o["a"].omitFromObject(t.getProperties(),["geometry"]),s=t.getId()||"Feature Properties";this.emit("showDataModal",a,s)}},createGeoJsonSource(e,t){let a=[];return o["a"].detectGeoJson(e)&&(a=(new d["a"]).readFeatures(e,{featureProjection:t})),new h["a"]({features:a,wrapX:!1})}}},m=p,f=a("2877"),g=Object(f["a"])(m,s,i,!1,null,null,null);t["a"]=g.exports},4749:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.texts.length>0?a("div",{staticClass:"ol-unselectable ol-control value",class:{pointer:e.texts.length>1},on:{click:e.toggle}},[e._v(" "+e._s(e.current)+" ")]):e._e()},i=[],o=a("96a2"),r={name:"TextControl",mixins:[o["a"]],data(){return{i:0}},computed:{texts(){return Array.isArray(this.text)?this.text:"string"===typeof this.text&&this.text.length>0?[this.text]:[]},current(){return 0===this.texts.length?"":this.texts[this.i%this.text.length]}},props:{text:{text:[String,Array],default:""}},methods:{toggle(){this.i++}}},n=r,l=(a("2d6d"),a("2877")),d=Object(l["a"])(n,s,i,!1,null,"fe2bcd86",null);t["a"]=d.exports},"4bc5":function(e,t,a){"use strict";var s=a("3115"),i=a("025e"),o=(a("5bc0"),a("c320")),r=a("9d47"),n=a("21bc"),l=a("5eee"),d=a("a2c7"),c=a("256f"),u=a("f5dd"),h=a("601e"),p=a("480c"),m=a("2ef1"),f=(a("1399"),a("0417")),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"ol-unselectable ol-progress-control"},[a("div",{staticClass:"progress-bar"},[a("div",{staticClass:"progress-bar-inner",style:{width:e.percent}})]),a("div",{staticClass:"progress-label"},[e._v(e._s(e.label))])])},y=[],v=a("96a2"),b={name:"ProgressControl",mixins:[v["a"]],data(){return{loading:0,loaded:0}},computed:{show(){return this.loading>0&&this.loaded<=this.loading},percent(){return(this.loaded/this.loading*100).toFixed(1)+"%"},label(){return"Loading Tiles ("+this.percent+")"}},methods:{addLoading(){this.loading++,this.update()},addLoaded(){this.loaded++,this.update()},update(){this.loading===this.loaded&&(this.loading=0,this.loaded=0),this.loading===this.loaded&&(this.loading=0,this.loaded=0)}}},w=b,x=(a("2e68"),a("2877")),L=Object(x["a"])(w,g,y,!1,null,"1da4d958",null),S=L.exports;let P=1;var j,C,$={components:{ProgressControl:S},mixins:[s["a"]],props:{show:{type:Boolean,default:!0},editable:{type:Boolean,default:!0},removableLayers:{type:Boolean,default:!1}},data(){return{map:null,id:"map_"+P++}},watch:{async show(){await this.showMap()}},computed:{...i["a"].mapState(["userLocation","locationZoom"])},async mounted(){await this.showMap()},methods:{async showMap(){this.show&&(await this.$nextTick(),await this.renderMap())},async createMap(e="EPSG:3857"){let t,a={showFullExtent:!0};if("string"===typeof e?a.projection=await h["a"].get(e):e instanceof u["a"]?a.projection=e:e instanceof d["a"]?t=e:i["a"].isObject(e)&&(a=e),t||(t=new d["a"](a),t.getCenter()||t.setCenter(Object(c["j"])([this.userLocation[1],this.userLocation[0]],t.getProjection())),t.getZoom()||t.setZoom(this.locationZoom)),null!==this.map)return this.map.updateSize(),void this.map.render();var s=[new o["a"],new r["a"]],p={target:this.id,view:t};this.editable?p.controls=Object(n["a"])().extend(s):(p.interactions=[],p.controls=s),this.map=new l["a"](p),this.listen("windowResized",this.updateMapSize);let m=this.map.getLayers();m.on("add",e=>{let t=e.element,a=t.get("events");for(let s in a)this.map.on(s,a[s])}),m.on("remove",e=>{let t=e.element,a=t.get("events");for(let s in a)this.map.un(s,a[s])})},addLayerSwitcher(){this.map.addControl(new f["a"]({trash:this.removableLayers}))},addBasemaps(){let e={opaque:!0,attributionsCollapsible:!1,wrapX:!1},t=[];if(Array.isArray(this.$config.basemaps)){let a=!1;for(let s of this.$config.basemaps){let i=new m["a"](Object.assign({},e,s)),o=new p["a"]({source:this.trackTileProgress(i),baseLayer:!0,title:s.title,noSwitcherDelete:!0,visible:!a});t.push(o),this.map.addLayer(o),a=!0}}return t},onShow(){this.listen("windowResized",this.updateMapSize)},onHide(){this.unlisten("windowResized")},async renderMap(){await this.createMap(),this.addBasemaps()},async updateMapSize(){this.map&&(await this.$nextTick(),this.map.updateSize())},addLayerToMap(e){e.set("userLayer",!0),this.map.addLayer(e)},removeLayerFromMap(e){let t=this.getLayerFromMap(e);t&&this.map.removeLayer(t)},getLayerFromMap(e){let t=this.map.getLayers().getArray();for(let a of t)if(a.get("id")===e)return a;return null},getVisibleLayers(){let e=[],t=this.map.getLayers().getArray();for(let a of t)a.get("userLayer")&&a.getVisible()&&e.push(a);return e},getFitOptions(e=25){let t={};var a=this.map.getSize();return t.padding=a&&e>0?[a[0]*e/100,a[1]*e/100,a[0]*e/100,a[1]*e/100]:[30,30,30,30],t},trackTileProgress(e){return this.$refs.progress&&(e.on("tileloadstart",()=>{this.$refs.progress.addLoading()}),e.on("tileloadend",()=>{this.$refs.progress.addLoaded()}),e.on("tileloaderror",()=>{this.$refs.progress.addLoaded()})),e},fromLonLat(e){return Object(c["j"])(e,this.map.getView().getProjection())}}},M=$,_=Object(x["a"])(M,j,C,!1,null,null,null);t["a"]=_.exports},"4ed6":function(e,t,a){},"601e":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("a79f"),i=a("256f"),o=a("f5dd"),r=a("bc81"),n=a("025e");class l{static async get(e){return e instanceof o["a"]?e:await l._load(e)}static add(e,t,a){try{s["a"].defs(e,t),Object(r["a"])(s["a"]);let o=Object(i["n"])(e);return Array.isArray(a)&&(a=Object(i["w"])(a,"EPSG:4326",o),o.setExtent(a)),t.includes("+datum=WGS84")&&(o.basemap=!0),o}catch(o){return console.error(o),null}}static async addFromStac(e){if(n["a"].isObject(e)&&n["a"].isObject(e.properties)){if(e.properties["proj:epsg"])return await l.get(e.properties["proj:epsg"]);if(e.properties["proj:wkt2"])return l.add(e.id,e.properties["proj:wkt2"])}return null}static async _load(e){let t,s;if("string"===typeof e&&e.match(/^EPSG:\d+$/i))t=e.toUpperCase(),s=e.substr(5);else{if(!Number.isInteger(e))return null;t="EPSG:"+e,s=String(e)}let o=Object(i["n"])(t);if(o)return o;let r=await a.e("chunk-2d0b5f87").then(a.t.bind(null,"1abc",3));return s in r?l.add(t,r[s][0],r[s][1]):null}}},"63a9":function(e,t,a){"use strict";a("1416")},"6b1e":function(e,t,a){},"70e2":function(e,t,a){},8781:function(e,t,a){"use strict";a("6b1e")},"96a2":function(e,t,a){"use strict";var s,i,o=a("3900"),r={props:{map:{type:Object}},data(){return{control:null}},mounted(){this.control=new o["a"]({element:this.$el})},watch:{map(e){e&&this.map.addControl(this.control)}},methods:{getControl(){return this.control}}},n=r,l=a("2877"),d=Object(l["a"])(n,s,i,!1,null,null,null);t["a"]=d.exports},be47:function(e,t,a){"use strict";a("70e2")},c2dc:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{show:e.show,minWidth:"60%",width:"90%",title:e.title},on:{closed:function(t){return e.$emit("closed")}},scopedSlots:e._u([{key:"default",fn:function(){return[0===e.parameters.length?a("p",[e._v("No editable parameters available.")]):a("form",{attrs:{id:"parameterModal"},on:{submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[e._l(e.parameters,(function(t,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.toggleParamVisibility(t),expression:"toggleParamVisibility(param)"}],key:s,staticClass:"fieldRow"},[a("label",{class:{fieldLabel:!0,highlight:t.name===e.selectParameter,info:t.info}},[e._v(" "+e._s(e.displayLabel(t))+" "),t.info||t.optional?e._e():a("strong",{staticClass:"required",attrs:{title:"required"}},[e._v("*")]),t.description?a("div",{staticClass:"description"},[a("Description",{attrs:{description:t.description}})],1):e._e()]),t.info?e._e():a("ParameterDataTypes",{ref:t.name,refInFor:!0,attrs:{editable:e.editable,parameter:t,context:e.context,parent:e.parent},on:{schemaSelected:function(a){return e.updateType(t,a)}},model:{value:e.values[t.name],callback:function(a){e.$set(e.values,t.name,a)},expression:"values[param.name]"}}),!t.info&&t.unspecified?a("button",{staticClass:"deleteBtn",attrs:{title:"Delete unspecified parameter",type:"button"},on:{click:function(t){return e.deleteParam(s)}}},[a("i",{staticClass:"fas fa-trash"})]):e._e()],1)})),a("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})],2)]},proxy:!0},e.$listeners.save?{key:"footer",fn:function(){return[a("div",{staticClass:"footer"},[a("button",{staticClass:"save",on:{click:e.save}},[e._v("Save")])])]},proxy:!0}:null],null,!0)})},i=[],o=a("025e"),r=a("2930"),n=a("8088"),l=a("3916"),d={name:"ParameterModal",components:{Modal:r["a"],Description:n["default"],ParameterDataTypes:l["default"]},props:{title:{type:String},parameters:{type:Array},data:{type:Object},editable:{type:Boolean,default:!0},selectParameter:{type:String,default:null},parent:{type:Object,default:null}},data(){return{show:!0,values:o["a"].deepClone(this.data),schemas:{}}},computed:{context(){return{values:this.values,schemas:this.schemas,parameters:this.parameters}}},mounted(){this.$nextTick(()=>this.setSelected())},methods:{toggleParamVisibility(e){return!e||!e.toggledBy||!!this.context.values[e.toggledBy]},deleteParam(e){let t=this.parameters[e].name;this.$delete(this.parameters,e),this.$delete(this.schemas,t),this.$delete(this.values,t)},updateType(e,t){this.$set(this.schemas,e.name,t)},displayLabel(e){return"string"===typeof e.label&&e.label.length>0?e.label:o["a"].prettifyString(e.name)},save(){try{this.$emit("save",this.values),this.show=!1}catch(e){o["a"].exception(this,e)}},componentforParameter(e){return e&&Array.isArray(this.$refs[e])&&this.$refs[e][0]?this.$refs[e][0]:null},setSelected(e=0){let t;this.selectParameter?t=this.componentforParameter(this.selectParameter):this.parameters.length>0&&(t=this.componentforParameter(this.parameters[0].name)),t&&(t.$el&&t.$el.scrollIntoView?(this.selectParameter&&t.$el.scrollIntoView(),this.setInputFocus(t.$el)):e<10&&setTimeout(()=>this.setSelected(++e),250))},setInputFocus(e,t=0){if(e.querySelector){let t=e.querySelector('input:not([type="hidden"]):not([disabled]):not([class~="multiselect__input"]), button:not([disabled]), textarea:not([disabled]), select:not([disabled]), datalist:not([disabled])');t&&t.focus()}else t<10&&setTimeout(()=>this.setInputFocus(e,++t),250)}}},c=d,u=(a("e944"),a("be47"),a("2877")),h=Object(u["a"])(c,s,i,!1,null,"294756d2",null);t["default"]=h.exports},ceb6:function(e,t,a){},d16f:function(e,t,a){},e944:function(e,t,a){"use strict";a("d16f")},faca:function(e,t,a){"use strict";a("ceb6")},ffc9:function(e,t,a){}}]);
//# sourceMappingURL=chunk-6187105a.4c78f19c.js.map