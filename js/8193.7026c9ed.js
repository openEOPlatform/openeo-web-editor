"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[8193],{86368:(t,e,i)=>{const r=i(10061),s=Symbol("max"),n=Symbol("length"),o=Symbol("lengthCalculator"),a=Symbol("allowStale"),l=Symbol("maxAge"),h=Symbol("dispose"),c=Symbol("noDisposeOnSet"),f=Symbol("lruList"),u=Symbol("cache"),g=Symbol("updateAgeOnGet"),d=()=>1;class p{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[s]=t.max||1/0;const e=t.length||d;if(this[o]="function"!==typeof e?d:e,this[a]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[h]=t.dispose,this[c]=t.noDisposeOnSet||!1,this[g]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[s]=t||1/0,m(this)}get max(){return this[s]}set allowStale(t){this[a]=!!t}get allowStale(){return this[a]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[l]=t,m(this)}get maxAge(){return this[l]}set lengthCalculator(t){"function"!==typeof t&&(t=d),t!==this[o]&&(this[o]=t,this[n]=0,this[f].forEach((t=>{t.length=this[o](t.value,t.key),this[n]+=t.length}))),m(this)}get lengthCalculator(){return this[o]}get length(){return this[n]}get itemCount(){return this[f].length}rforEach(t,e){e=e||this;for(let i=this[f].tail;null!==i;){const r=i.prev;A(this,t,i,e),i=r}}forEach(t,e){e=e||this;for(let i=this[f].head;null!==i;){const r=i.next;A(this,t,i,e),i=r}}keys(){return this[f].toArray().map((t=>t.key))}values(){return this[f].toArray().map((t=>t.value))}reset(){this[h]&&this[f]&&this[f].length&&this[f].forEach((t=>this[h](t.key,t.value))),this[u]=new Map,this[f]=new r,this[n]=0}dump(){return this[f].map((t=>!w(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[f]}set(t,e,i){if(i=i||this[l],i&&"number"!==typeof i)throw new TypeError("maxAge must be a number");const r=i?Date.now():0,a=this[o](e,t);if(this[u].has(t)){if(a>this[s])return b(this,this[u].get(t)),!1;const o=this[u].get(t),l=o.value;return this[h]&&(this[c]||this[h](t,l.value)),l.now=r,l.maxAge=i,l.value=e,this[n]+=a-l.length,l.length=a,this.get(t),m(this),!0}const g=new S(t,e,a,r,i);return g.length>this[s]?(this[h]&&this[h](t,e),!1):(this[n]+=g.length,this[f].unshift(g),this[u].set(t,this[f].head),m(this),!0)}has(t){if(!this[u].has(t))return!1;const e=this[u].get(t).value;return!w(this,e)}get(t){return y(this,t,!0)}peek(t){return y(this,t,!1)}pop(){const t=this[f].tail;return t?(b(this,t),t.value):null}del(t){b(this,this[u].get(t))}load(t){this.reset();const e=Date.now();for(let i=t.length-1;i>=0;i--){const r=t[i],s=r.e||0;if(0===s)this.set(r.k,r.v);else{const t=s-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[u].forEach(((t,e)=>y(this,e,!1)))}}const y=(t,e,i)=>{const r=t[u].get(e);if(r){const e=r.value;if(w(t,e)){if(b(t,r),!t[a])return}else i&&(t[g]&&(r.value.now=Date.now()),t[f].unshiftNode(r));return e.value}},w=(t,e)=>{if(!e||!e.maxAge&&!t[l])return!1;const i=Date.now()-e.now;return e.maxAge?i>e.maxAge:t[l]&&i>t[l]},m=t=>{if(t[n]>t[s])for(let e=t[f].tail;t[n]>t[s]&&null!==e;){const i=e.prev;b(t,e),e=i}},b=(t,e)=>{if(e){const i=e.value;t[h]&&t[h](i.key,i.value),t[n]-=i.length,t[u].delete(i.key),t[f].removeNode(e)}};class S{constructor(t,e,i,r,s){this.key=t,this.value=e,this.length=i,this.now=r,this.maxAge=s||0}}const A=(t,e,i,r)=>{let s=i.value;w(t,s)&&(b(t,i),t[a]||(s=void 0)),s&&e.call(r,s.value,s.key,t)};t.exports=p},70362:t=>{t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},10061:(t,e,i)=>{function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var i=0,s=arguments.length;i<s;i++)e.push(arguments[i]);return e}function s(t,e,i){var r=e===t.head?new a(i,null,e,t):new a(i,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function n(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,i,r){if(!(this instanceof a))return new a(t,e,i,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}t.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,i=t.prev;return e&&(e.prev=i),i&&(i.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=i),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)n(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var i=this.head,r=0;null!==i;r++)t.call(e,i.value,r,this),i=i.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var i=this.tail,r=this.length-1;null!==i;r--)t.call(e,i.value,r,this),i=i.prev},r.prototype.get=function(t){for(var e=0,i=this.head;null!==i&&e<t;e++)i=i.next;if(e===t&&null!==i)return i.value},r.prototype.getReverse=function(t){for(var e=0,i=this.tail;null!==i&&e<t;e++)i=i.prev;if(e===t&&null!==i)return i.value},r.prototype.map=function(t,e){e=e||this;for(var i=new r,s=this.head;null!==s;)i.push(t.call(e,s.value,this)),s=s.next;return i},r.prototype.mapReverse=function(t,e){e=e||this;for(var i=new r,s=this.tail;null!==s;)i.push(t.call(e,s.value,this)),s=s.prev;return i},r.prototype.reduce=function(t,e){var i,r=this.head;if(arguments.length>1)i=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,i=this.head.value}for(var s=0;null!==r;s++)i=t(i,r.value,s),r=r.next;return i},r.prototype.reduceReverse=function(t,e){var i,r=this.tail;if(arguments.length>1)i=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,i=this.tail.value}for(var s=this.length-1;null!==r;s--)i=t(i,r.value,s),r=r.prev;return i},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,i=this.head;null!==i;e++)t[e]=i.value,i=i.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,i=this.tail;null!==i;e++)t[e]=i.value,i=i.prev;return t},r.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var i=new r;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var s=0,n=this.head;null!==n&&s<t;s++)n=n.next;for(;null!==n&&s<e;s++,n=n.next)i.push(n.value);return i},r.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var i=new r;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var s=this.length,n=this.tail;null!==n&&s>e;s--)n=n.prev;for(;null!==n&&s>t;s--,n=n.prev)i.push(n.value);return i},r.prototype.splice=function(t,e,...i){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,n=this.head;null!==n&&r<t;r++)n=n.next;var o=[];for(r=0;n&&r<e;r++)o.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(r=0;r<i.length;r++)n=s(this,n,i[r]);return o},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,i=t;null!==i;i=i.prev){var r=i.prev;i.prev=i.next,i.next=r}return this.head=e,this.tail=t,this};try{i(70362)(r)}catch(l){}},14812:(t,e,i)=>{i.d(e,{X:()=>n});const r=new Map;function s(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>r.set(t,e)))}async function n(t){const e=r.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);const i=await e();return new i(t)}s([void 0,1],(()=>i.e(3321).then(i.bind(i,83321)).then((t=>t.default)))),s(5,(()=>i.e(8672).then(i.bind(i,8672)).then((t=>t.default)))),s(6,(()=>{throw new Error("old style JPEG compression is not supported.")})),s(7,(()=>i.e(9347).then(i.bind(i,39347)).then((t=>t.default)))),s([8,32946],(()=>Promise.all([i.e(9586),i.e(5522)]).then(i.bind(i,65522)).then((t=>t.default)))),s(32773,(()=>i.e(7411).then(i.bind(i,17411)).then((t=>t.default)))),s(34887,(()=>Promise.all([i.e(9586),i.e(4173)]).then(i.bind(i,74173)).then((t=>t.default)))),s(50001,(()=>i.e(1588).then(i.bind(i,51588)).then((t=>t.default))))},38193:(t,e,i)=>{i.d(e,{mK:()=>Q,W0:()=>J,MS:()=>tt});var r=i(76943),s=i(42411);class n{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const i=this.getUint32(t,e),r=this.getUint32(t+4,e);let s;if(e){if(s=i+2**32*r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*i+r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}getInt64(t,e){let i=0;const r=(128&this._dataView.getUint8(t+(e?7:0)))>0;let s=!0;for(let n=0;n<8;n++){let o=this._dataView.getUint8(t+(e?n:7-n));r&&(s?0!==o&&(o=255&~(o-1),s=!1):o=255&~o),i+=o*256**n}return r&&(i=-i),i}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return(0,s.g)(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class o{constructor(t,e,i,r){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=i,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),i=this.readUint32(t+4);let r;if(this._littleEndian){if(r=e+2**32*i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*e+i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(t){let e=0;const i=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0;let r=!0;for(let s=0;s<8;s++){let n=this._dataView.getUint8(t+(this._littleEndian?s:7-s));i&&(r?0!==n&&(n=255&~(n-1),r=!1):n=255&~n),e+=n*256**s}return i&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}const a="\r\n\r\n";function l(t){if("undefined"!==typeof Object.fromEntries)return Object.fromEntries(t);const e={};for(const[i,r]of t)e[i.toLowerCase()]=r;return e}function h(t){const e=t.split("\r\n").map((t=>{const e=t.split(":").map((t=>t.trim()));return e[0]=e[0].toLowerCase(),e}));return l(e)}function c(t){const[e,...i]=t.split(";").map((t=>t.trim())),r=i.map((t=>t.split("=")));return{type:e,params:l(r)}}function f(t){let e,i,r;return t&&([,e,i,r]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),i=parseInt(i,10),r=parseInt(r,10)),{start:e,end:i,total:r}}function u(t,e){let i=null;const r=new TextDecoder("ascii"),s=[],n=`--${e}`,o=`${n}--`;for(let a=0;a<10;++a){const e=r.decode(new Uint8Array(t,a,n.length));e===n&&(i=a)}if(null===i)throw new Error("Could not find initial boundary");while(i<t.byteLength){const e=r.decode(new Uint8Array(t,i,Math.min(n.length+1024,t.byteLength-i)));if(0===e.length||e.startsWith(o))break;if(!e.startsWith(n))throw new Error("Part does not start with boundary");const l=e.substr(n.length+2);if(0===l.length)break;const c=l.indexOf(a),u=h(l.substr(0,c)),{start:g,end:d,total:p}=f(u["content-range"]),y=i+n.length+c+a.length,w=parseInt(d,10)+1-parseInt(g,10);s.push({headers:u,data:t.slice(y,y+w),offset:g,length:w,fileSize:p}),i=y+w+4}return s}class g{async fetch(t,e){return Promise.all(t.map((t=>this.fetchSlice(t,e))))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}var d=i(86368);async function p(t){return new Promise((e=>setTimeout(e,t)))}function y(t,e){const i=Array.isArray(t)?t:Array.from(t),r=Array.isArray(e)?e:Array.from(e);return i.map(((t,e)=>[t,r[e]]))}class w extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,w),this.name="AbortError"}}class m extends Error{constructor(t,e){super(e),this.errors=t,this.message=e,this.name="AggregateError"}}const b=m;class S{constructor(t,e,i=null){this.offset=t,this.length=e,this.data=i}get top(){return this.offset+this.length}}class A{constructor(t,e,i){this.offset=t,this.length=e,this.blockIds=i}}class I extends g{constructor(t,{blockSize:e=65536,cacheSize:i=100}={}){super(),this.source=t,this.blockSize=e,this.blockCache=new d({max:i}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const i=new Map,r=new Map,s=new Set;for(const{offset:l,length:h}of t){let t=l+h;const{fileSize:e}=this;null!==e&&(t=Math.min(t,e));const n=Math.floor(l/this.blockSize)*this.blockSize;for(let o=n;o<t;o+=this.blockSize){const t=Math.floor(o/this.blockSize);this.blockCache.has(t)?i.set(t,this.blockCache.get(t)):this.blockRequests.has(t)?r.set(t,this.blockRequests.get(t)):(this.blockIdsToFetch.has(t)||this.blockIdsToFetch.add(t),s.add(t))}}await p(),this.fetchBlocks(e);for(const l of s){const t=this.blockRequests.get(l),e=this.blockCache.get(l);if(t)r.set(l,t);else{if(!e)throw new Error(`Block ${l} is not in the block requests`);i.set(l,e)}}let n=await Promise.allSettled(Array.from(r.values()));if(n.some((t=>"rejected"===t.status))){const t=new Set;for(const[i,s]of y(r.keys(),n)){const{rejected:r,reason:n}=s;r&&"AbortError"===n.name&&n.signal!==e&&(this.blockIdsToFetch.add(i),t.add(i))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(e);for(const e of t){const t=this.blockRequests.get(e);if(!t)throw new Error(`Block ${e} is not in the block requests`);r.set(e,t)}n=await Promise.allSettled(Array.from(r.values()))}}if(n.some((t=>"rejected"===t.status))){if(e&&e.aborted)throw new w("Request was aborted");throw new b(n.filter((t=>"rejected"===t.status)).map((t=>t.reason)),"Request failed")}const o=n.map((t=>t.value)),a=new Map(y(Array.from(r.keys()),o));for(const[l,h]of i)a.set(l,h);return this.readSliceData(t,a)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(e,t);for(let r=0;r<e.length;++r){const s=e[r];for(const e of s.blockIds){const s=(async()=>{try{const t=(await i)[r],s=e*this.blockSize,n=s-t.offset,o=Math.min(n+this.blockSize,t.data.byteLength),a=t.data.slice(n,o),l=new S(s,a.byteLength,a);return this.blockCache.set(e,l),l}catch(s){throw"AbortError"===s.name&&(s.signal=t),s}finally{this.blockRequests.delete(e)}})();this.blockRequests.set(e,s)}}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort(((t,e)=>t-e));if(0===e.length)return[];let i=[],r=null;const s=[];for(const n of e)null===r||r+1===n?(i.push(n),r=n):(s.push(new A(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[n],r=n);return s.push(new A(i[0]*this.blockSize,i.length*this.blockSize,i)),s}readSliceData(t,e){return t.map((t=>{const i=t.offset+t.length,r=Math.floor(t.offset/this.blockSize),s=Math.floor((t.offset+t.length)/this.blockSize),n=new ArrayBuffer(t.length),o=new Uint8Array(n);for(let a=r;a<=s;++a){const r=e.get(a),s=r.offset-t.offset,n=r.top-i;let l,h=0,c=0;s<0?h=-s:s>0&&(c=s),l=n<0?r.length-h:i-r.offset-h;const f=new Uint8Array(r.data,h,l);o.set(f,c)}return n}))}}class D{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class v{constructor(t){this.url=t}async request({headers:t,credentials:e,signal:i}={}){throw new Error("request is not implemented")}}class T extends D{constructor(t){super(),this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){const t=this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer;return t}}class E extends v{constructor(t,e){super(t),this.credentials=e}async request({headers:t,credentials:e,signal:i}={}){const r=await fetch(this.url,{headers:t,credentials:e,signal:i});return new T(r)}}class x extends D{constructor(t,e){super(),this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class P extends v{constructRequest(t,e){return new Promise(((i,r)=>{const s=new XMLHttpRequest;s.open("GET",this.url),s.responseType="arraybuffer";for(const[e,n]of Object.entries(t))s.setRequestHeader(e,n);s.onload=()=>{const t=s.response;i(new x(s,t))},s.onerror=r,s.onabort=()=>r(new w("Request aborted")),s.send(),e&&(e.aborted&&s.abort(),e.addEventListener("abort",(()=>s.abort())))}))}async request({headers:t,signal:e}={}){const i=await this.constructRequest(t,e);return i}}var F=i(73752),M=i(13640),k=i(82630),C=i(48764)["Buffer"];class G extends D{constructor(t,e){super(),this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){const t=await this.dataPromise;return t}}class R extends v{constructor(t){super(t),this.parsedUrl=k.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?F:M}constructRequest(t,e){return new Promise(((i,r)=>{const s=this.httpApi.get({...this.parsedUrl,headers:t},(t=>{const e=new Promise((e=>{const i=[];t.on("data",(t=>{i.push(t)})),t.on("end",(()=>{const t=C.concat(i).buffer;e(t)})),t.on("error",r)}));i(new G(t,e))}));s.on("error",r),e&&(e.aborted&&s.destroy(new w("Request aborted")),e.addEventListener("abort",(()=>s.destroy(new w("Request aborted")))))}))}async request({headers:t,signal:e}={}){const i=await this.constructRequest(t,e);return i}}class U extends g{constructor(t,e,i,r){super(),this.client=t,this.headers=e,this.maxRanges=i,this.allowFullFile=r,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length,Promise.all(t.map((t=>this.fetchSlice(t,e)))))}async fetchSlices(t,e){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${t.map((({offset:t,length:e})=>`${t}-${t+e}`)).join(",")}`},signal:e});if(i.ok){if(206===i.status){const{type:r,params:s}=c(i.getHeader("content-type"));if("multipart/byteranges"===r){const t=u(await i.getData(),s.boundary);return this._fileSize=t[0].fileSize||null,t}const n=await i.getData(),{start:o,end:a,total:l}=f(i.getHeader("content-range"));this._fileSize=l||null;const h=[{data:n,offset:o,length:a-o}];if(t.length>1){const i=await Promise.all(t.slice(1).map((t=>this.fetchSlice(t,e))));return h.concat(i)}return h}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await i.getData();return this._fileSize=t.byteLength,[{data:t,offset:0,length:t.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:i,length:r}=t,s=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+r}`},signal:e});if(s.ok){if(206===s.status){const t=await s.getData(),{total:e}=f(s.getHeader("content-range"));return this._fileSize=e||null,{data:t,offset:i,length:r}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await s.getData();return this._fileSize=t.byteLength,{data:t,offset:0,length:t.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function O(t,{blockSize:e,cacheSize:i}){return null===e?t:new I(t,e,i)}function L(t,{headers:e={},credentials:i,maxRanges:r=0,allowFullFile:s=!1,...n}={}){const o=new E(t,i),a=new U(o,e,r,s);return O(a,n)}function _(t,{headers:e={},maxRanges:i=0,allowFullFile:r=!1,...s}={}){const n=new P(t),o=new U(n,e,i,r);return O(o,s)}function B(t,{headers:e={},maxRanges:i=0,allowFullFile:r=!1,...s}={}){const n=new R(t),o=new U(n,e,i,r);return O(o,s)}function N(t,{forceXHR:e=!1,...i}={}){return"function"!==typeof fetch||e?"undefined"!==typeof XMLHttpRequest?_(t,i):B(t,i):L(t,i)}class K extends g{constructor(t){super(),this.file=t}async fetchSlice(t,e){return new Promise(((i,r)=>{const s=this.file.slice(t.offset,t.offset+t.length),n=new FileReader;n.onload=t=>i(t.target.result),n.onerror=r,n.onabort=r,n.readAsArrayBuffer(s),e&&e.addEventListener("abort",(()=>n.abort()))}))}}function V(t){return new K(t)}var j=i(82499);function q(t){switch(t){case j.sf.BYTE:case j.sf.ASCII:case j.sf.SBYTE:case j.sf.UNDEFINED:return 1;case j.sf.SHORT:case j.sf.SSHORT:return 2;case j.sf.LONG:case j.sf.SLONG:case j.sf.FLOAT:case j.sf.IFD:return 4;case j.sf.RATIONAL:case j.sf.SRATIONAL:case j.sf.DOUBLE:case j.sf.LONG8:case j.sf.SLONG8:case j.sf.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function z(t){const e=t.GeoKeyDirectory;if(!e)return null;const i={};for(let r=4;r<=4*e[3];r+=4){const s=j.P1[e[r]],n=e[r+1]?j.L[e[r+1]]:null,o=e[r+2],a=e[r+3];let l=null;if(n){if(l=t[n],"undefined"===typeof l||null===l)throw new Error(`Could not get value of geoKey '${s}'.`);"string"===typeof l?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),1===o&&(l=l[0]))}else l=a;i[s]=l}return i}function H(t,e,i,r){let s=null,n=null;const o=q(e);switch(e){case j.sf.BYTE:case j.sf.ASCII:case j.sf.UNDEFINED:s=new Uint8Array(i),n=t.readUint8;break;case j.sf.SBYTE:s=new Int8Array(i),n=t.readInt8;break;case j.sf.SHORT:s=new Uint16Array(i),n=t.readUint16;break;case j.sf.SSHORT:s=new Int16Array(i),n=t.readInt16;break;case j.sf.LONG:case j.sf.IFD:s=new Uint32Array(i),n=t.readUint32;break;case j.sf.SLONG:s=new Int32Array(i),n=t.readInt32;break;case j.sf.LONG8:case j.sf.IFD8:s=new Array(i),n=t.readUint64;break;case j.sf.SLONG8:s=new Array(i),n=t.readInt64;break;case j.sf.RATIONAL:s=new Uint32Array(2*i),n=t.readUint32;break;case j.sf.SRATIONAL:s=new Int32Array(2*i),n=t.readInt32;break;case j.sf.FLOAT:s=new Float32Array(i),n=t.readFloat32;break;case j.sf.DOUBLE:s=new Float64Array(i),n=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e!==j.sf.RATIONAL&&e!==j.sf.SRATIONAL)for(let a=0;a<i;++a)s[a]=n.call(t,r+a*o);else for(let a=0;a<i;a+=2)s[a]=n.call(t,r+a*o),s[a+1]=n.call(t,r+(a*o+4));return e===j.sf.ASCII?new TextDecoder("utf-8").decode(s):s}class W{constructor(t,e,i){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=i}}class $ extends Error{constructor(t){super(`No image at index ${t}`),this.index=t}}class Y{async readRasters(t={}){const{window:e,width:i,height:r}=t;let{resX:s,resY:n,bbox:o}=t;const a=await this.getImage();let l=a;const h=await this.getImageCount(),c=a.getBoundingBox();if(e&&o)throw new Error('Both "bbox" and "window" passed.');if(i||r){if(e){const[t,i]=a.getOrigin(),[r,s]=a.getResolution();o=[t+e[0]*r,i+e[1]*s,t+e[2]*r,i+e[3]*s]}const t=o||c;if(i){if(s)throw new Error("Both width and resX passed");s=(t[2]-t[0])/i}if(r){if(n)throw new Error("Both width and resY passed");n=(t[3]-t[1])/r}}if(s||n){const t=[];for(let e=0;e<h;++e){const i=await this.getImage(e),{SubfileType:r,NewSubfileType:s}=i.fileDirectory;(0===e||2===r||1&s)&&t.push(i)}t.sort(((t,e)=>t.getWidth()-e.getWidth()));for(let e=0;e<t.length;++e){const i=t[e],r=(c[2]-c[0])/i.getWidth(),o=(c[3]-c[1])/i.getHeight();if(l=i,s&&s>r||n&&n>o)break}}let f=e;if(o){const[t,e]=a.getOrigin(),[i,r]=l.getResolution(a);f=[Math.round((o[0]-t)/i),Math.round((o[1]-e)/r),Math.round((o[2]-t)/i),Math.round((o[3]-e)/r)],f=[Math.min(f[0],f[2]),Math.min(f[1],f[3]),Math.max(f[0],f[2]),Math.max(f[1],f[3])]}return l.readRasters({...t,window:f})}}class X extends Y{constructor(t,e,i,r,s={}){super(),this.source=t,this.littleEndian=e,this.bigTiff=i,this.firstIFDOffset=r,this.cache=s.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const i=this.bigTiff?4048:1024;return new o((await this.source.fetch([{offset:t,length:"undefined"!==typeof e?e:i}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,i=this.bigTiff?8:2;let r=await this.getSlice(t);const s=this.bigTiff?r.readUint64(t):r.readUint16(t),n=s*e+(this.bigTiff?16:6);r.covers(t,n)||(r=await this.getSlice(t,n));const o={};let a=t+(this.bigTiff?8:2);for(let c=0;c<s;a+=e,++c){const t=r.readUint16(a),e=r.readUint16(a+2),i=this.bigTiff?r.readUint64(a+4):r.readUint32(a+4);let s,n;const l=q(e),h=a+(this.bigTiff?12:8);if(l*i<=(this.bigTiff?8:4))s=H(r,e,i,h);else{const t=r.readOffset(h),n=q(e)*i;if(r.covers(t,n))s=H(r,e,i,t);else{const r=await this.getSlice(t,n);s=H(r,e,i,t)}}n=1===i&&-1===j.It.indexOf(t)&&e!==j.sf.RATIONAL&&e!==j.sf.SRATIONAL?s[0]:s,o[j.L[t]]=n}const l=z(o),h=r.readOffset(t+i+e*s);return new W(o,l,h)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(0===t)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){if(e instanceof $)throw new $(t);throw e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(0===e.nextIFDByteOffset)throw new $(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new r.Z(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;while(e)try{await this.requestIFD(t),++t}catch(i){if(!(i instanceof $))throw i;e=!1}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const e="GDAL_STRUCTURAL_METADATA_SIZE=",i=e.length+100;let r=await this.getSlice(t,i);if(e===H(r,j.sf.ASCII,e.length,t)){const e=H(r,j.sf.ASCII,i,t),s=e.split("\n")[0],n=Number(s.split("=")[1].split(" ")[0])+s.length;n>i&&(r=await this.getSlice(t,n));const o=H(r,j.sf.ASCII,n,t);this.ghostValues={},o.split("\n").filter((t=>t.length>0)).map((t=>t.split("="))).forEach((([t,e])=>{this.ghostValues[t]=e}))}return this.ghostValues}static async fromSource(t,e,i){const r=(await t.fetch([{offset:0,length:1024}],i))[0],s=new n(r),o=s.getUint16(0,0);let a;if(18761===o)a=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");a=!1}const l=s.getUint16(2,a);let h;if(42===l)h=!1;else{if(43!==l)throw new TypeError("Invalid magic number.");{h=!0;const t=s.getUint16(4,a);if(8!==t)throw new Error("Unsupported offset byte-size.")}}const c=h?s.getUint64(8,a):s.getUint32(4,a);return new X(t,a,h,c,e)}close(){return"function"===typeof this.source.close&&this.source.close()}}class Z extends Y{constructor(t,e){super(),this.mainFile=t,this.overviewFiles=e,this.imageFiles=[t].concat(e),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map((t=>t.parseFileDirectoryAt(t.firstIFDOffset))));return this.fileDirectoriesPerFile=await Promise.all(t),this.fileDirectoriesPerFile}async getImage(t=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let e=0,i=0;for(let s=0;s<this.imageFiles.length;s++){const n=this.imageFiles[s];for(let o=0;o<this.imageCounts[s];o++){if(t===e){const t=await n.requestIFD(i);return new r.Z(t.fileDirectory,t.geoKeyDirectory,n.dataView,n.littleEndian,n.cache,n.source)}e++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(null!==this.imageCount)return this.imageCount;const t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map((t=>t.getImageCount())));return this.imageCounts=await Promise.all(t),this.imageCount=this.imageCounts.reduce(((t,e)=>t+e),0),this.imageCount}}async function J(t,e={},i){return X.fromSource(N(t,e),i)}async function Q(t,e){return X.fromSource(V(t),e)}async function tt(t,e=[],i={},r){const s=await X.fromSource(N(t,i),r),n=await Promise.all(e.map((t=>X.fromSource(N(t,i)))));return new Z(s,n)}},76943:(t,e,i)=>{i.d(e,{Z:()=>M});var r=i(42411),s=i(88330),n=i(18602),o=i(82499);function a(t,e){const{width:i,height:r}=t,s=new Uint8Array(i*r*3);let n;for(let o=0,a=0;o<t.length;++o,a+=3)n=256-t[o]/e*256,s[a]=n,s[a+1]=n,s[a+2]=n;return s}function l(t,e){const{width:i,height:r}=t,s=new Uint8Array(i*r*3);let n;for(let o=0,a=0;o<t.length;++o,a+=3)n=t[o]/e*256,s[a]=n,s[a+1]=n,s[a+2]=n;return s}function h(t,e){const{width:i,height:r}=t,s=new Uint8Array(i*r*3),n=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<t.length;++a,l+=3){const i=t[a];s[l]=e[i]/65536*256,s[l+1]=e[i+n]/65536*256,s[l+2]=e[i+o]/65536*256}return s}function c(t){const{width:e,height:i}=t,r=new Uint8Array(e*i*3);for(let s=0,n=0;s<t.length;s+=4,n+=3){const e=t[s],i=t[s+1],o=t[s+2],a=t[s+3];r[n]=(255-e)/256*255*((255-a)/256),r[n+1]=(255-i)/256*255*((255-a)/256),r[n+2]=(255-o)/256*255*((255-a)/256)}return r}function f(t){const{width:e,height:i}=t,r=new Uint8ClampedArray(e*i*3);for(let s=0,n=0;s<t.length;s+=3,n+=3){const e=t[s],i=t[s+1],o=t[s+2];r[n]=e+1.402*(o-128),r[n+1]=e-.34414*(i-128)-.71414*(o-128),r[n+2]=e+1.772*(i-128)}return r}const u=.95047,g=1,d=1.08883;function p(t){const{width:e,height:i}=t,r=new Uint8Array(e*i*3);for(let s=0,n=0;s<t.length;s+=3,n+=3){const e=t[s+0],i=t[s+1]<<24>>24,o=t[s+2]<<24>>24;let a,l,h,c=(e+16)/116,f=i/500+c,p=c-o/200;f=u*(f*f*f>.008856?f*f*f:(f-16/116)/7.787),c=g*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),p=d*(p*p*p>.008856?p*p*p:(p-16/116)/7.787),a=3.2406*f+-1.5372*c+-.4986*p,l=-.9689*f+1.8758*c+.0415*p,h=.0557*f+-.204*c+1.057*p,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,l=l>.0031308?1.055*l**(1/2.4)-.055:12.92*l,h=h>.0031308?1.055*h**(1/2.4)-.055:12.92*h,r[n]=255*Math.max(0,Math.min(1,a)),r[n+1]=255*Math.max(0,Math.min(1,l)),r[n+2]=255*Math.max(0,Math.min(1,h))}return r}var y=i(14812);function w(t,e,i,r=1){return new(Object.getPrototypeOf(t).constructor)(e*i*r)}function m(t,e,i,r,s){const n=e/r,o=i/s;return t.map((t=>{const a=w(t,r,s);for(let l=0;l<s;++l){const s=Math.min(Math.round(o*l),i-1);for(let i=0;i<r;++i){const o=Math.min(Math.round(n*i),e-1),h=t[s*e+o];a[l*r+i]=h}}return a}))}function b(t,e,i){return(1-i)*t+i*e}function S(t,e,i,r,s){const n=e/r,o=i/s;return t.map((t=>{const a=w(t,r,s);for(let l=0;l<s;++l){const s=o*l,h=Math.floor(s),c=Math.min(Math.ceil(s),i-1);for(let i=0;i<r;++i){const o=n*i,f=o%1,u=Math.floor(o),g=Math.min(Math.ceil(o),e-1),d=t[h*e+u],p=t[h*e+g],y=t[c*e+u],w=t[c*e+g],m=b(b(d,p,f),b(y,w,f),s%1);a[l*r+i]=m}}return a}))}function A(t,e,i,r,s,n="nearest"){switch(n.toLowerCase()){case"nearest":return m(t,e,i,r,s);case"bilinear":case"linear":return S(t,e,i,r,s);default:throw new Error(`Unsupported resampling method: '${n}'`)}}function I(t,e,i,r,s,n){const o=e/r,a=i/s,l=w(t,r,s,n);for(let h=0;h<s;++h){const s=Math.min(Math.round(a*h),i-1);for(let i=0;i<r;++i){const a=Math.min(Math.round(o*i),e-1);for(let o=0;o<n;++o){const c=t[s*e*n+a*n+o];l[h*r*n+i*n+o]=c}}}return l}function D(t,e,i,r,s,n){const o=e/r,a=i/s,l=w(t,r,s,n);for(let h=0;h<s;++h){const s=a*h,c=Math.floor(s),f=Math.min(Math.ceil(s),i-1);for(let i=0;i<r;++i){const a=o*i,u=a%1,g=Math.floor(a),d=Math.min(Math.ceil(a),e-1);for(let o=0;o<n;++o){const a=t[c*e*n+g*n+o],p=t[c*e*n+d*n+o],y=t[f*e*n+g*n+o],w=t[f*e*n+d*n+o],m=b(b(a,p,u),b(y,w,u),s%1);l[h*r*n+i*n+o]=m}}}return l}function v(t,e,i,r,s,n,o="nearest"){switch(o.toLowerCase()){case"nearest":return I(t,e,i,r,s,n);case"bilinear":case"linear":return D(t,e,i,r,s,n);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function T(t,e,i){let r=0;for(let s=e;s<i;++s)r+=t[s];return r}function E(t,e,i){switch(t){case 1:if(e<=8)return new Uint8Array(i);if(e<=16)return new Uint16Array(i);if(e<=32)return new Uint32Array(i);break;case 2:if(8===e)return new Int8Array(i);if(16===e)return new Int16Array(i);if(32===e)return new Int32Array(i);break;case 3:switch(e){case 16:case 32:return new Float32Array(i);case 64:return new Float64Array(i);default:break}break;default:break}throw Error("Unsupported data format/bitsPerSample")}function x(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!==0)&&(3!==t||16!==e&&32!==e&&64!==e)}function P(t,e,i,r,s,n,o){const a=new DataView(t),l=2===i?o*n:o*n*r,h=2===i?1:r,c=E(e,s,l),f=parseInt("1".repeat(s),2);if(1===e){let t;t=1===i?r*s:s;let e=n*t;0!==(7&e)&&(e=e+7&-8);for(let i=0;i<o;++i){const t=i*e;for(let e=0;e<n;++e){const r=t+e*h*s;for(let t=0;t<h;++t){const o=r+t*s,l=(i*n+e)*h+t,u=Math.floor(o/8),g=o%8;if(g+s<=8)c[l]=a.getUint8(u)>>8-s-g&f;else if(g+s<=16)c[l]=a.getUint16(u)>>16-s-g&f;else if(g+s<=24){const t=a.getUint16(u)<<8|a.getUint8(u+2);c[l]=t>>24-s-g&f}else c[l]=a.getUint32(u)>>32-s-g&f}}}}return c.buffer}class F{constructor(t,e,i,r,s,n){this.fileDirectory=t,this.geoKeys=e,this.dataView=i,this.littleEndian=r,this.tiles=s?{}:null,this.isTiled=!t.StripOffsets;const o=t.PlanarConfiguration;if(this.planarConfiguration="undefined"===typeof o?1:o,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=n}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return"undefined"!==typeof this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:"undefined"!==typeof this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,i=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(t,e){return(0,r.g)(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64;default:break}break;default:break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){const i=this.getSampleFormat(t),r=this.getBitsPerSample(t);return E(i,r,e)}async getTileOrStrip(t,e,i,r,s){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let a;const{tiles:l}=this;let h,c;1===this.planarConfiguration?a=e*n+t:2===this.planarConfiguration&&(a=i*n*o+e*n+t),this.isTiled?(h=this.fileDirectory.TileOffsets[a],c=this.fileDirectory.TileByteCounts[a]):(h=this.fileDirectory.StripOffsets[a],c=this.fileDirectory.StripByteCounts[a]);const f=(await this.source.fetch([{offset:h,length:c}],s))[0];let u;return null!==l&&l[a]?u=l[a]:(u=(async()=>{let t=await r.decode(this.fileDirectory,f);const i=this.getSampleFormat(),s=this.getBitsPerSample();return x(i,s)&&(t=P(t,i,this.planarConfiguration,this.getSamplesPerPixel(),s,this.getTileWidth(),this.getBlockHeight(e))),t})(),null!==l&&(l[a]=u)),{x:t,y:e,sample:i,data:await u}}async _readRaster(t,e,i,r,s,n,o,a,l){const h=this.getTileWidth(),c=this.getTileHeight(),f=this.getWidth(),u=this.getHeight(),g=Math.max(Math.floor(t[0]/h),0),d=Math.min(Math.ceil(t[2]/h),Math.ceil(f/h)),p=Math.max(Math.floor(t[1]/c),0),y=Math.min(Math.ceil(t[3]/c),Math.ceil(u/c)),w=t[2]-t[0];let m=this.getBytesPerPixel();const b=[],S=[];for(let A=0;A<e.length;++A)1===this.planarConfiguration?b.push(T(this.fileDirectory.BitsPerSample,0,e[A])/8):b.push(0),S.push(this.getReaderForSample(e[A]));const I=[],{littleEndian:D}=this;for(let A=p;A<y;++A)for(let n=g;n<d;++n)for(let o=0;o<e.length;++o){const a=o,g=e[o];2===this.planarConfiguration&&(m=this.getSampleByteSize(o));const d=this.getTileOrStrip(n,A,g,s,l);I.push(d),d.then((s=>{const n=s.data,o=new DataView(n),l=this.getBlockHeight(s.y),g=s.y*c,d=s.x*h,p=g+l,y=(s.x+1)*h,A=S[a],I=Math.min(l,l-(p-t[3]),u-g),v=Math.min(h,h-(y-t[2]),f-d);for(let c=Math.max(0,t[1]-g);c<I;++c)for(let s=Math.max(0,t[0]-d);s<v;++s){const n=(c*h+s)*m,l=A.call(o,n+b[a],D);let f;r?(f=(c+g-t[1])*w*e.length+(s+d-t[0])*e.length+a,i[f]=l):(f=(c+g-t[1])*w+s+d-t[0],i[a][f]=l)}}))}if(await Promise.all(I),n&&t[2]-t[0]!==n||o&&t[3]-t[1]!==o){let s;return s=r?v(i,t[2]-t[0],t[3]-t[1],n,o,e.length,a):A(i,t[2]-t[0],t[3]-t[1],n,o,a),s.width=n,s.height=o,s}return i.width=n||t[2]-t[0],i.height=o||t[3]-t[1],i}async readRasters({window:t,samples:e=[],interleave:i,pool:r=null,width:s,height:n,resampleMethod:o,fillValue:a,signal:l}={}){const h=t||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const c=h[2]-h[0],f=h[3]-h[1],u=c*f,g=this.getSamplesPerPixel();if(e&&e.length){for(let y=0;y<e.length;++y)if(e[y]>=g)return Promise.reject(new RangeError(`Invalid sample index '${e[y]}'.`))}else for(let y=0;y<g;++y)e.push(y);let d;if(i){const t=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,i=Math.max.apply(null,this.fileDirectory.BitsPerSample);d=E(t,i,u*e.length),a&&d.fill(a)}else{d=[];for(let t=0;t<e.length;++t){const i=this.getArrayForSample(e[t],u);Array.isArray(a)&&t<a.length?i.fill(a[t]):a&&!Array.isArray(a)&&i.fill(a),d.push(i)}}const p=r||await(0,y.X)(this.fileDirectory),w=await this._readRaster(h,e,d,i,p,s,n,o,l);return w}async readRGB({window:t,interleave:e=!0,pool:i=null,width:r,height:s,resampleMethod:n,enableAlpha:u=!1,signal:g}={}){const d=t||[0,0,this.getWidth(),this.getHeight()];if(d[0]>d[2]||d[1]>d[3])throw new Error("Invalid subsets");const y=this.fileDirectory.PhotometricInterpretation;if(y===o.Ie.RGB){let a=[0,1,2];if(this.fileDirectory.ExtraSamples!==o.pd.Unspecified&&u){a=[];for(let t=0;t<this.fileDirectory.BitsPerSample.length;t+=1)a.push(t)}return this.readRasters({window:t,interleave:e,samples:a,pool:i,width:r,height:s,resampleMethod:n,signal:g})}let w;switch(y){case o.Ie.WhiteIsZero:case o.Ie.BlackIsZero:case o.Ie.Palette:w=[0];break;case o.Ie.CMYK:w=[0,1,2,3];break;case o.Ie.YCbCr:case o.Ie.CIELab:w=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const m={window:d,interleave:!0,samples:w,pool:i,width:r,height:s,resampleMethod:n,signal:g},{fileDirectory:b}=this,S=await this.readRasters(m),A=2**this.fileDirectory.BitsPerSample[0];let I;switch(y){case o.Ie.WhiteIsZero:I=a(S,A);break;case o.Ie.BlackIsZero:I=l(S,A);break;case o.Ie.Palette:I=h(S,b.ColorMap);break;case o.Ie.CMYK:I=c(S);break;case o.Ie.YCbCr:I=f(S);break;case o.Ie.CIELab:I=p(S);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const t=new Uint8Array(I.length/3),e=new Uint8Array(I.length/3),i=new Uint8Array(I.length/3);for(let r=0,s=0;r<I.length;r+=3,++s)t[s]=I[r],e[s]=I[r+1],i[s]=I[r+2];I=[t,e,i]}return I.width=S.width,I.height=S.height,I}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let r=n(i,"Item");r=null===t?r.filter((t=>void 0===s(t,"sample"))):r.filter((e=>Number(s(e,"sample"))===t));for(let n=0;n<r.length;++n){const t=r[n];e[s(t,"name")]=t.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(i)return[i[0],i[5],i[10]];if(t){const[e,i,r]=t.getResolution();return[e*t.getWidth()/this.getWidth(),i*t.getHeight()/this.getHeight(),r*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const t=this.getOrigin(),e=this.getResolution(),i=t[0],r=t[1],s=i+e[0]*this.getWidth(),n=r+e[1]*this.getHeight();return[Math.min(i,s),Math.min(r,n),Math.max(i,s),Math.max(r,n)]}}const M=F},82499:(t,e,i)=>{i.d(e,{Ie:()=>l,It:()=>n,L:()=>r,L5:()=>c,P1:()=>u,Qb:()=>f,pd:()=>h,sf:()=>a});const r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},s={};for(const d in r)r.hasOwnProperty(d)&&(s[r[d]]=parseInt(d,10));const n=[s.BitsPerSample,s.ExtraSamples,s.SampleFormat,s.StripByteCounts,s.StripOffsets,s.StripRowCounts,s.TileByteCounts,s.TileOffsets,s.SubIFDs],o={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},a={};for(const d in o)o.hasOwnProperty(d)&&(a[o[d]]=parseInt(d,10));const l={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},h={Unspecified:0,Assocalpha:1,Unassalpha:2},c={Version:0,AddCompression:1},f={None:0,Deflate:1},u={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},g={};for(const d in u)u.hasOwnProperty(d)&&(g[u[d]]=parseInt(d,10))}}]);
//# sourceMappingURL=8193.7026c9ed.js.map